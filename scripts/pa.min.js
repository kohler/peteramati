!function(){"use strict";let t=function(){return!1};try{window.localStorage&&window.JSON&&(t=function(t,e,n){try{var i=t?window.sessionStorage:window.localStorage;return void 0===e?!!i:void 0===n?i.getItem(e):null===n?i.removeItem(e):"object"==typeof n?i.setItem(e,JSON.stringify(n)):i.setItem(e,n)}catch(t){return!1}})}catch(t){}function e(t){var e,n,i,a,s,r,o=t.split(/(%(?:%|-?(?:\d*|\*?)(?:\.\d*)?[sdefgroxX]))/),l="";for(e=0,a=1;e!=o.length;++e)if("%"!=(n=o[e]).charAt(0))l+=n;else if("%"==n.charAt(1))l+="%";else{if(i=arguments[a],++a,"*"==(s=n.match(/^%(-?)(\d*|\*?)(?:|[.](\d*))(\w)/))[2]&&(s[2]=i.toString(),i=arguments[a],++a),s[4]>="e"&&s[4]<="g"&&null==s[3]&&(s[3]=6),"g"===s[4]?i=(i=Number(i).toPrecision(s[3]).toString()).replace(/\.(\d*[1-9])?0+(|e.*)$/,(function(t,e,n){return(null==e?"":"."+e)+n})):"f"===s[4]?i=Number(i).toFixed(s[3]):"e"===s[4]?i=Number(i).toExponential(s[3]):"r"===s[4]?(i=Number(i).toFixed(+(s[3]||0)),+(s[3]||0)&&(i=i.replace(/\.?0*$/,""))):"d"===s[4]?i=Math.floor(i):"o"===s[4]?i=Math.floor(i).toString(8):"x"===s[4]?i=Math.floor(i).toString(16):"X"===s[4]&&(i=Math.floor(i).toString(16).toUpperCase()),i=i.toString(),""!==s[2]&&"0"!==s[2])for(r="0"===s[2].charAt(0)?"0":" ";i.length<parseInt(s[2],10);)i=s[1]?i+r:r+i;l+=i}return l}function n(t,e,n){return(e+=t.toString()).length<=n?e:e.substring(e.length-n)}function i(t,e,n){return n&&e&&!t.getSeconds()?s("%H:%M",t):n?s("%H:%M:%S",t):e&&t.getSeconds()?s("%#l:%M:%S%P",t):e&&t.getMinutes()?s("%#l:%M%P",t):s(e?"%#l%P":"%I:%M:%S %p",t)}t.json=function(e,n){var i=t(e,n);return!!i&&JSON.parse(i)},t.site=function(e,n,i){return"/"!==siteinfo.base&&(n=siteinfo.base+n),t(e,n,i)},t.site_json=function(e,n){return"/"!==siteinfo.base&&(n=siteinfo.base+n),t.json(e,n)};const a={a:function(t){return["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][t.getDay()]},A:function(t){return["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][t.getDay()]},d:function(t){return n(t.getDate(),"0",2)},e:function(t,e){return n(t.getDate(),e?"":" ",2)},u:function(t){return t.getDay()||7},w:function(t){return t.getDay()},b:function(t){return["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][t.getMonth()]},B:function(t){return["January","February","March","April","May","June","July","August","September","October","November","December"][t.getMonth()]},h:function(t){return a.b(t)},m:function(t){return n(t.getMonth()+1,"0",2)},y:function(t){return t.getFullYear()%100},Y:function(t){return t.getFullYear()},H:function(t){return n(t.getHours(),"0",2)},k:function(t,e){return n(t.getHours(),e?"":" ",2)},I:function(t){return n(t.getHours()%12||12,"0",2)},l:function(t,e){return n(t.getHours()%12||12,e?"":" ",2)},M:function(t){return n(t.getMinutes(),"0",2)},X:function(t){return s("%#e %b %Y %#q",t)},p:function(t){return t.getHours()<12?"AM":"PM"},P:function(t){return t.getHours()<12?"am":"pm"},q:function(t,e){return i(t,e,s.is24)},r:function(t,e){return i(t,e,!1)},R:function(t,e){return i(t,e,!0)},S:function(t){return n(t.getSeconds(),"0",2)},T:function(t){return s("%H:%M:%S",t)},D:function(t){return s("%m/%d/%y",t)},F:function(t){return s("%Y-%m-%d",t)},s:function(t){return Math.floor(t.getTime()/1e3)},n:function(){return"\n"},t:function(){return"\t"},"%":function(){return"%"}};function s(t,e){var n,i,s,r,o=t.split(/(%#?\S)/),l="";for(null==e?e=new Date:"number"==typeof e&&(e=new Date(1e3*e)),n=0;n!=o.length;++n)s="#"==(i=o[n]).charAt(1),"%"==i.charAt(0)&&(r=a[i.charAt(1+s)])?l+=r(e,s):l+=i;return l}function r(t){return t>=3600&&t%900==0?t/3600+"h":t>=3600?e("%dh%dm",(t=Math.round(t/60))/60,t%60):t>360?e("%dm",Math.round(t/60)):e("%dm%ds",(t=Math.round(t))/60,t%60)}window.JSON&&window.JSON.parse||(window.JSON={parse:$.parseJSON}),Element.prototype.closest||(Element.prototype.closest=function(t){return $(this).closest(t)[0]}),Element.prototype.replaceChildren||(Element.prototype.replaceChildren=function(){for(;this.lastChild;)this.removeChild(this.lastChild);for(let t=0;t!==arguments.length;++t)this.append(arguments[t])}),String.prototype.startsWith||(String.prototype.startsWith=function(t,e){return e=!e||e<0?0:+e,this.substring(e,e+t.length)===t}),String.prototype.endsWith||(String.prototype.endsWith=function(t,e){return(void 0===e||e>this.length)&&(e=this.length),this.substring(e-t.length,e)===t}),String.prototype.trimStart||(String.prototype.trimStart=function(){return this.replace(/^[\s\uFEFF\xA0]+/,"")});class o{constructor(t){this.value=t}then(t){try{const e=t(this.value);return e instanceof Promise||e instanceof o?e:new o(e)}catch(t){return Promise.reject(t)}}catch(){return this}finally(t){try{t()}catch(t){}return this}}function l(t,e){return t===e||(t=(null==t?"":t).replace(/\r\n?/g,"\n"))===(e=(null==e?"":e).replace(/\r\n?/g,"\n"))}let u,c,d,h,p;"classList"in document.createElement("span")&&!/MSIE|rv:11\.0/.test(navigator.userAgent||"")?(u=function(t,e){let n=t.classList;return n&&n.contains(e)},c=function(t,e){t.classList.add(e)},d=function(t,e){t.classList.remove(e)},h=function(t,e,n){t.classList.toggle(e,n)},p=function(t){return t.classList}):(u=function(t,e){return $(t).hasClass(e)},c=function(t,e){$(t).addClass(e)},d=function(t,e){$(t).removeClass(e)},h=function(t,e,n){$(t).toggleClass(e,n)},p=function(t){let e=$.trim(t.className);return""===e?[]:e.split(/\s+/)});const f={};function g(t,e,n){for(let i=0;i!==e.length;i+=3)if(!e[i]||e[i]===n){let n=t.length;for(;0!==n&&e[i+1]>t[n-2];)n-=2;t.splice(n,0,e[i+1],e[i+2])}}function m(t,e,n){for(let i=0;i!==t.length&&!n.isImmediatePropagationStopped();i+=2)t[i+1].call(e,n)}function b(t){let e=t.target;(e&&(u(e,"ui")||u(e,"uin"))||"A"===this.tagName&&u(this,"ui"))&&t.preventDefault();let n=p(this),i=null;for(let e=0;e<n.length;++e){let a=f[n[e]];a&&(i=i||[],g(i,a,t.type))}i&&i.length&&m(i,this,t)}b.on=function(t,e,n){let i=t.indexOf("."),a=null;i>=0&&(a=t.substring(0,i),t=t.substring(i+1)),f[t]=f[t]||[],f[t].push(a,n||0,e)},b.trigger=function(t,e){let n=f[t];if(n){"string"==typeof e&&(e=$.Event(e));let t=[];g(t,n,e.type),t.length&&m(t,this,e)}},$(document).on("click",".ui, .uic",b),$(document).on("change",".uich",b),$(document).on("error",".ui-error",b),$(document).on("input",".uii",b),$(document).on("keydown",".uikd",b),$(document).on("load",".ui-load",b),$(document).on("mouseup mousedown",".uim",b),$(document).on("unfold",".ui-unfold",b);let _=!1;function v(t,e,n){return null!=n&&(n=!n),h(t,"hidden",n),e&&$(e).find("span.foldarrow").html(u(t,"hidden")?"&#x25B6;":"&#x25BC;"),!1}$(document).on("keydown keyup",(function(t){"Tab"!==t.key||t.metaKey||(_="keydown"===t.type)})),$(document).on("focus","textarea.ta1",(function(){if(_){let t=this;setTimeout((function(){t.setSelectionRange(0,t.value.length)}),0)}}));const x={Spacebar:" ",Esc:"Escape"},y={9:"Tab",13:"Enter",27:"Escape"},w={9:"Tab",13:"Enter",16:"ShiftLeft",17:"ControlLeft",18:"AltLeft",20:"CapsLock",27:"Escape",33:"PageUp",34:"PageDown",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",91:"OSLeft",92:"OSRight",93:"OSRight",224:"OSLeft",225:"AltRight"},k={Alt:2,AltLeft:2,AltRight:2,CapsLock:2,Control:2,ControlLeft:2,ControlRight:2,Meta:2,OSLeft:2,OSRight:2,Shift:2,ShiftLeft:2,ShiftRight:2,ArrowLeft:1,ArrowRight:1,ArrowUp:1,ArrowDown:1,Backspace:1,Enter:1,Escape:1,PageUp:1,PageDown:1,Tab:1};function A(t){let e;return"string"==typeof t?t:null!=(e=t.key)?x[e]||e:(e=t.charCode)?y[e]||String.fromCharCode(e):(e=t.keyCode)?w[e]?w[e]:e>=48&&e<=57||e>=65&&e<=90?String.fromCharCode(e):void 0:""}function C(t){return(t.shiftKey?1:0)+(t.ctrlKey?2:0)+(t.altKey?4:0)+(t.metaKey?8:0)}A.printable=function(t){return!(k[A(t)]||"string"!=typeof t&&(t.ctrlKey||t.metaKey))},A.is_modifier=function(t){return k[A(t)]>1},A.is_default_a=function(t,e){return!(t.shiftKey||t.metaKey||t.ctrlKey||0!=t.button||e&&u("ui",e))},C.SHIFT=1,C.CTRL=2,C.ALT=4,C.META=8;let E,S={};function D(t,e){const n=window.getComputedStyle(t);let i="font-size:".concat(n.fontSize,";font-family:",n.fontFamily,";font-weight:",n.fontWeight,";font-style:",n.fontStyle,";line-height:",n.lineHeight,"px;position:absolute;top:-10000px;left:-10000px;resize:none;word-wrap:break-word;white-space:pre-wrap;");if("TEXTAREA"!==t.tagName){const a=parseFloat(n.paddingLeft),s=parseFloat(n.paddingRight),r=parseFloat(n.borderLeftWidth),o=parseFloat(n.borderRightWidth);i=i.concat("width:auto;display:table-cell;padding-left:",a,"px;padding-right:",a+s+r+o,"px;"),"0px"===n.minWidth&&e&&(t.style.minWidth=e+"px"),"none"!==n.maxWidth||t.classList.contains("wide")||(t.style.maxWidth="640px")}let a=S[i];return a||(a=S[i]={signature:i,elt:document.createElement("div"),refcount:0},a.elt.setAttribute("style",i),document.body.appendChild(a.elt)),++a.refcount,a}function M(){for(let t of E)t[1]()}function F(t,e){$(t).removeData("autogrower"),e&&(e instanceof Element?e.remove():0==--e.refcount&&(e.elt.remove(),delete S[e.signature])),E&&E.delete(t)}function T(t,e,n){if(!1!==t.first&&t.v.length){for(var i=0;i<t.v.length;++i){var a=e.exec(t.v[i]);if(a)return t.pt+=n+a[1]+"/",t.v.splice(i,1),void(t.first=a[1])}t.first=!1}}function N(t,e){if(!1!==t.last&&t.v.length){for(var n=0;n<t.v.length;++n){var i=e.exec(t.v[n]);if(i)return t.t+="/"+i[1],t.v.splice(n,1),void(t.last=i[1])}t.last=!1}}function j(t,e,n){const i=t.closest(".pa-psetinfo");let a,s;if((a=i.getAttribute("data-pa-user")||siteinfo.uservalue)&&n.push("u="+encodeURIComponent(a)),(a=i.getAttribute("data-pa-pset"))&&n.push("pset="+encodeURIComponent(a)),(a=i.getAttribute("data-pa-commit"))&&n.push("commit="+encodeURIComponent(a)),("api/grade"===e||"=api/grade"===e)&&(s=$(i).data("pa-gradeinfo"))){const t=[];for(let e in s.entries)t.push(e);n.push("knowngrades="+encodeURIComponent(t.join(" ")))}}function L(t,e){let n,i,a,s,r,o="";if(null!=siteinfo.site_relative&&null!=siteinfo.suffix||(siteinfo.site_relative=siteinfo.suffix=""),"string"==typeof e)(a=e.match(/^(.*?)(#.*)$/))&&(e=a[1],o=a[2]),r=e.split(/&/);else for(n in r=[],e)i=e[n],null==i||("anchor"===n?o="#"+i:"psetinfo"===n&&i instanceof Element?j(i,t,r):r.push(encodeURIComponent(n).concat("=",encodeURIComponent(i).replace(/%20/g,"+"))));return t.startsWith("=")&&(r.push("post="+siteinfo.postvalue),t=t.substring(1)),s={pt:"",v:r,t:t+siteinfo.suffix},"help"===t?N(s,/^t=(\w+)$/):"api"===t.substr(0,3)?(t.length>3&&(s.t="api"+siteinfo.suffix,r.push("fn="+t.substr(4))),T(s,/^u=([^?&#]+)$/,"~"),N(s,/^fn=(\w+)$/),N(s,/^pset=([^?&#]+)$/),N(s,/^commit=([0-9A-Fa-f]+)$/)):"index"===t?T(s,/^u=([^?&#]+)$/,"~"):"pset"!==t&&"run"!==t||(T(s,/^u=([^?&#]+)$/,"~"),N(s,/^pset=([^?&#]+)$/),N(s,/^commit=([0-9A-Fa-f]+)$/)),siteinfo.defaults&&r.push(function(t){if("string"==typeof t)return t;if(t){var e,n,i=[""];for(e in t)null!=(n=t[e])&&i.push(encodeURIComponent(e),"=",encodeURIComponent(n).replace(/%20/g,"+"),"&");return i[i.length-1]="",i.join("")}return""}(siteinfo.defaults)),r.length&&(s.t+="?"+r.join("&")),siteinfo.site_relative+s.pt+s.t+o}function z(t,e){var n,i="";if(e=e||window.location.href,!/^\w+:\/\//.test(t)&&(n=e.match(/^(\w+:)/))&&(i=n[1]),i&&!/^\/\//.test(t)&&(n=e.match(/^\w+:(\/\/[^\/]+)/))&&(i+=n[1]),i&&!/^\//.test(t)&&(n=e.match(/^\w+:\/\/[^\/]+(\/[^?#]*)/)))for(i=(i+n[1]).replace(/\/[^\/]+$/,"/");"../"===t.substring(0,3);)i=i.replace(/\/[^\/]*\/$/,"/"),t=t.substring(3);return i+t}$.fn.autogrow=function(){return this.each((function(){var t,e,n,i,a=$(this),s=a.data("autogrower");!s&&this.classList.contains("need-autogrow")&&(this.classList.remove("need-autogrow"),"TEXTAREA"===this.tagName?(t=this,s=function(a){if(!1===a)return F(t,e);var s=t.clientWidth;if(!(s<=0)){e||(e=D(t),n=t.clientHeight,e.elt.innerText="!",i=e.elt.clientHeight);var r=t.value;a&&"keydown"==a.type&&13===a.keyCode&&(r+="\n"),e.elt.style.width=s+"px",e.elt.innerText=r+"...";var o=Math.max($(window).height()-4*i,4*i);$(t).height(Math.min(o,Math.max(e.elt.clientHeight,n)))}}):"INPUT"===this.tagName&&"text"===this.type&&(s=function(t){var e,n,i;return function(a){if(!1===a)return F(t,e);var s=0;try{s=t.offsetWidth}catch(t){}if(s<=0)return;if(!e){e=D(t,s);let a=window.getComputedStyle(t);n=parseFloat(a.minWidth),i=parseFloat(a.maxWidth)}e.elt.innerText=t.value+"  ";let r=Math.min(e.elt.offsetWidth,$(window).width());i==i&&(r=Math.min(r,i)),$(t).outerWidth(Math.max(r,n))}}(this)),s&&(a.data("autogrower",s).on("change input",s),E||(E=new Map,$(window).resize(M)),E.set(this,s))),s&&""!==a.val()&&s()})),this},$.fn.unautogrow=function(){return this.each((function(){var t=$(this).data("autogrower");t&&t(!1)})),this},$((function(){$(".need-autogrow").autogrow()})),b.on("js-range-click",(function(t){if("change"!==t.type){var e=$(this).closest("form"),n=e[0].jsRangeClick||{},i=this.getAttribute("data-range-type")||this.name;e[0].jsRangeClick=n;var a=!1;if("keydown"!==t.type||C(t)||(a=A(t)),!(n.__clicking__||"updaterange"===t.type&&n["__update__"+i]||"keydown"===t.type&&"ArrowDown"!==a&&"ArrowUp"!==a)){var s=[],r=[];e.find("input.js-range-click").each((function(){var t=this.getAttribute("data-range-type")||this.name;i===t&&(s.push(this),u(this,"is-range-group")&&r.push(this))}));var o,l,c,d=n[i];for(c=0;c!==s.length;++c)s[c]===this&&(o=c),s[c]===d&&(l=c);if(a)return 0!==o&&"ArrowUp"===a?--o:o<s.length-1&&"ArrowDown"===a&&++o,$(s[o]).focus().scrollIntoView(),void t.preventDefault();var h,p=!1,f=!1;if("click"===t.type){for(n.__clicking__=!0,u(this,"is-range-group")?(c=0,h=s.length-1,p=this.getAttribute("data-range-group")):(n[i]=this,t.shiftKey&&d?l<=o?(c=l,h=o-1):(c=o+1,h=l):(c=1,h=0,f=this.getAttribute("data-range-group")));c<=h;)s[c].checked===this.checked||u(s[c],"is-range-group")||p&&s[c].getAttribute("data-range-group")!==p||$(s[c]).trigger("click"),++c;delete n.__clicking__}else"updaterange"===t.type&&(n["__updated__"+i]=!0);for(h=0;h!==r.length;++h)if(p=r[h].getAttribute("data-range-group"),!f||p===f){var g=null;for(c=0;c!==s.length;++c)if(s[c].getAttribute("data-range-group")===p&&!u(s[c],"is-range-group"))if(null===g)g=s[c].checked;else if(g!==s[c].checked){g=2;break}2===g?(r[h].indeterminate=!0,r[h].checked=!0):(r[h].indeterminate=!1,r[h].checked=g)}}}}),-1),$((function(){$(".is-range-group").each((function(){b.trigger.call(this,"js-range-click","updaterange")}))}));let O=0,B=[];function I(t){if(void 0===t)return O>0;O>0?B.push(t):t()}$.ajaxPrefilter((function(t){if(!1!==t.global){var e=t.success;t.error?$.isArray(t.error)?t.error.push(n):t.error=[t.error,n]:t.error=n,null==t.timeout&&(t.timeout=1e4),null==t.dataType&&(t.dataType="json"),t.trackOutstanding&&++O}function n(t,n,i){if(e){var a;if(/application\/json/.test(t.getResponseHeader("Content-Type")||"")&&t.responseText)try{a=JSON.parse(t.responseText)}catch(t){}a&&"object"==typeof a&&!1===a.ok||(a={ok:!1}),a.error||(a.error=function(t,e,n){return"parsererror"===e?"Internal error: bad response from server.":n?n.toString():"timeout"===e?"Connection timed out.":e?"Failed ["+e+"].":"Failed."}(0,n,i)),e(a,t,n)}}})),$(document).ajaxComplete((function(t,e,n){if(n.trackOutstanding&&0==--O)for(;B.length;)B.shift()()}));let P,R=0,H=[];function W(t,e,n){return"string"==typeof n&&(n={method:n}),new Promise((function(i){function a(){++R,$.ajax(t,Object.assign({data:e,method:"POST",cache:!1,dataType:"json",success:function(t){i(t),--R,H.length&&H.shift()()}},n||{}))}R<5?a():H.push(a)}))}function q(e){for(var n="string"==typeof e?1:0,i=t.site_json(!1,"list_digests")||[],a=-1,s=(new Date).getTime(),r=0;r<i.length;++r){var o=i[r];o[n]===e?a=r:o[2]<s-3e4?(i.splice(r,1),--r):s<=o[0]&&(s=o[0]+1)}return a>=0?i[a][2]=s:n&&(i.push([s,e,s]),a=i.length-1),t.site(!1,"list_digests",i),a>=0&&i[a][1-n]}function U(t){var e,n;return(n=/^list(\d+)(?=\s|$)/.exec(t))&&(e=q(+n[1]))?e:t}function Z(t,e){var n=function(t){var e=q(t);return e?"list"+e:t}(t=U(t));e&&/(?:^|\/)pset(?:|\.php)\//.test(e)&&(n+=function(t,e){var n,i,a=/(?:^|\/)(~[^\/]+)\/pset(?:|\.php)\/([^\/]+)((?:\/[0-9a-f]+)?)(?=[\/?#]|$)/.exec(e);if(a){if((t=JSON.parse(t)).pset){if(t.pset!==a[2])return"";n=i=a[1]}else n=(i=a[1]+"/pset/"+a[2])+a[3];var s=t.items.indexOf(n);if(s<0&&i!==n&&(s=t.items.indexOf(i)),s>=0)return" "+JSON.stringify({cur:a[1]+"/pset/"+a[2],prev:0===s?null:t.items[s-1],next:s===t.items.length-1?null:t.items[s+1]})}return""}(t,e)),P=(new Date).getTime();var i,a="; Max-Age=20";siteinfo.site_relative&&(i=/^[a-z]+:\/\/[^\/]*(\/.*)/.exec((siteinfo.absolute_base||(siteinfo.absolute_base=z(siteinfo.base)),siteinfo.absolute_base)))&&(a+="; Path="+i[1]),document.cookie="hotlist-info-"+P+"="+encodeURIComponent(n)+siteinfo.cookie_params+a}function K(t,e){var n,i;if(e&&e.startsWith(siteinfo.site_relative)&&function(t){return/(?:^|\/)pset(?:|\.php)(?:$|\/)/.test(t)}(i=e.substring(siteinfo.site_relative.length))&&(n=t.closest(".has-hotlist"))){var a=n.getAttribute("data-hotlist");if(!a){var s=jQuery.Event("pa-hotlist");$(n).trigger(s),(a=s.hotlist)&&"string"!=typeof a&&(a=JSON.stringify(a))}a&&Z(a,i)}}function J(){var t,e=location.href;return location.hash&&(e=e.substring(0,e.length-location.hash.length)),this.href.substring(0,e.length+1)===e+"#"||!!I()&&(I((t=this,function(){window.location=t.href})),!0)}$(document).on("click","a",(function(t){u(this,"ui")||A.is_default_a(t)&&!this.target&&J.call(this,t)||K(this,this.getAttribute("href"))})),$(document).on("submit","form",(function(t){u(this,"ui-submit")?(t.preventDefault(),b.call(this,t)):K(this,this.getAttribute("action"))})),$(window).on("beforeunload",(function(){var t=document.body.getAttribute("data-hotlist");t&&(!P||P+3<(new Date).getTime())&&Z(t,location.href)})),$((function(){$(".has-hotlist").each((function(){var t=this.getAttribute("data-hotlist");t&&t.startsWith("list")&&(t=U(t))&&this.setAttribute("data-hotlist",t)}))}));const Y=/[&<>\"']/g,G={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function V(t){return null!==t&&"number"!=typeof t?t.replace(Y,(function(t){return G[t]})):t}const X=/&.*?;/g,Q={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&apos;":"'","&#039;":"'"};function tt(t){return encodeURIComponent(t).replace(/[^-A-Za-z0-9_.%]|%../g,(function(t){return 1===t.length?"@"+t.charCodeAt(0).toString(16):"%2F"===t?"/":"@"+t.substring(1)}))}function et(t){return decodeURIComponent(t.replace(/@/g,"%"))}const nt=["Top","Right","Bottom","Left"],it=["top","right","bottom","left"],at=["height","width"];function st(t,e){return"border"+nt[t]+e}function rt(t){return st(t,"Color")}let ot=Math.round;var lt;function ut(t){var e,n,i=function(t){return $('<div class="bubble hidden'+t+'"><div class="bubtail bubtail0'+t+'"></div></div>').appendTo(document.body)}(t),a=i.children(),s=[a.width(),a.height()];for(e=0;e<4;++e)s[it[e]]=0,(n=i.css("margin"+nt[e]))&&(n=parseFloat(n))&&(s[it[e]]=n);return i.remove(),s}function ct(t,e){!e&&t&&"object"==typeof t?t=(e=t).content:e?"string"==typeof e&&(e={color:e}):e={};var n=null,i=e.dir,a=null,s=e.color?" "+e.color:"",r=$('<div class="bubble'+s+'" style="margin:0"><div class="bubtail bubtail0'+s+'" style="width:0;height:0"></div><div class="bubcontent"></div><div class="bubtail bubtail1'+s+'" style="width:0;height:0"></div></div>')[0];document.body.appendChild(r),e["pointer-events"]&&$(r).css({"pointer-events":e["pointer-events"]});var o=r.childNodes,l=null,u=null;function c(){var t=[0,0,0,0],e=l[1],n=l[0]/2;(u=parseFloat($(r).css(st(a,"Width"))))!=u&&(u=0),t[1^a]=t[3^a]=n+"px",t[2^a]=e+"px",o[0].style.borderWidth=t.join(" "),t[1^a]=t[3^a]=n+"px",t[2^a]=e+"px",o[2].style.borderWidth=t.join(" ");for(var i=1;i<=3;++i)o[0].style[it[a^i]]=o[2].style[it[a^i]]="";o[0].style[it[a]]=-e-u+"px";var s=u/n*Math.sqrt(e*e+n*n);for(o[2].style[it[a]]=-e-u+s+"px",i=0;i<3;i+=2)o[i].style.borderLeftColor=o[i].style.borderRightColor=o[i].style.borderTopColor=o[i].style.borderBottomColor="transparent";var c,d,h=(c=$(r).css("backgroundColor"),d=c.match(/^rgb\((.*)\)$/),d?"rgba("+d[1]+", 1)":c).replace(/([\d.]+)\)/,(function(t,e){return.75*e+.25+")"}));o[0].style[rt(2^a)]=$(r).css(rt(a)),o[2].style[rt(2^a)]=h}function d(t,e,n,i){var a=t[it[n]],s=t[it[2^n]],r=(1-i)*a+i*s;return r=Math.max(r,Math.min(s,e[it[n]]+8)),Math.min(r,Math.max(a,e[it[2^n]]-8))}function h(t,e,n,i,a,s){var r=e[it[i]],o=e[it[2^i]],u=n[at[1&i]],c=t-a*u;return!s&&c<r+8?c=Math.min(t-l[0],r+8):!s&&c+u>o-8&&(c=Math.max(t+l[0]-u,o-8-u)),c}function p(t,e){var i=Math.max(3===e?0:n.left-t.left,1===e?0:t.right-n.right);return("h"===e||1===e||3===e)&&i>100?Math.min(t.width,i)-24:t.width-24}function f(t,e){var i=$(r);i.css("maxWidth","");var a=i.geometry(!0),s=p(t,e);s<a.width&&(i.css("maxWidth",s),a=i.geometry(!0));var o=[n.top-l.bottom-a.height-l[0],n.right+l.left+a.width+l[0],n.bottom+l.top+a.height+l[0],n.left-l.right-a.width-l[0]];return o.width=a.width,o.height=a.height,o.wconstraint=s,o}function g(t,e,n){var i=p(e,n);return(i<t.wconstraint&&i<t.width||i>t.wconstraint&&t.width>=t.wconstraint)&&(t=f(e,n)),t}function m(t,e){var n;return t.length>e&&(n="0123trblnesw".indexOf(t.charAt(e)))>=0?n%4:-1}function b(t,e){var n,i=$(r).css("border"+t+"Radius");return i?((n=i.indexOf(" "))>-1&&(i=e?i.substring(n+1):i.substring(0,n)),parseFloat(i)):0}function _(t,e,n){var i,a;return 1&n?(i=b(nt[0]+nt[n],1),a=b(nt[2]+nt[n],1)):(i=b(nt[n]+nt[3],1),a=b(nt[n]+nt[1],1)),Math.min(Math.max(t,i),e[at[1&n^1]]-a-l[0])}function v(){l||(l=ut(s)),null==i&&(i="r");var t=/!/.test(i),e=/\*/.test(i),u=i.replace(/[^a0-3neswtrblhv]/,""),p=m(u,0),b=m(u,1);b=p>=0&&b>=0&&(1&b)!=(1&p)?1===b||2===b?1:0:.5,p<0&&(p=/^[ahv]$/.test(u)?u:"a");var v=$(window).geometry(),x=f(v,u);"a"===p&&(x.height+l[0]>Math.max(n.top-v.top,v.bottom-n.bottom)?x=g(x,v,p="h"):p="v");var y,w,k,A,C,E=[v.top+24,v.right-24,v.bottom-24,v.left+24];("v"===p||0===p||2===p)&&!t&&b<0&&x[2]>E[2]&&x[0]<E[0]&&(x[3]>=E[3]||x[1]<=E[1])&&(x=g(x,v,p="h")),x=g(x,v,p="v"===p&&x[2]>E[2]&&x[0]>E[0]||0===p&&!t&&x[2]>v.bottom&&v.top-x[0]<x[2]-v.bottom||2===p&&(t||x[0]>=v.top+8)?2:"v"===p||0===p||2===p?0:"h"===p&&x[3]-v.left<v.right-x[1]||1===p&&!t&&x[3]<v.left||3===p&&(t||x[1]<=v.right-8)?3:1),p!==a&&(a=p,c());var S=parseFloat($(r).css(st(1&p?0:3,"Width")));1&p?(w=h(A=d(n,v,0,b),v,x,0,b,e),C=_(ot(A-w-l[0]/2-S),x,p),o[0].style.top=o[2].style.top=C+"px",y=1==p?n.left-l.right-x.width-l[1]-1:n.right+l.left+l[1]):(y=h(k=d(n,v,3,b),v,x,3,b,e),C=_(ot(k-y-l[0]/2-S),x,p),o[0].style.left=o[2].style.left=C+"px",w=0==p?n.bottom+l.top+l[1]:n.top-l.bottom-x.height-l[1]-1),r.style.left=ot(y)+"px",r.style.top=ot(w)+"px",r.style.visibility="visible"}function x(){r&&r.parentElement.removeChild(r),r=null}var y={near:function(t,e){("string"==typeof t||t.tagName||t.jquery)&&(t=$(t),null==i&&t[0]&&(i=t[0].getAttribute("data-tooltip-dir")),t=t.geometry(!0));for(let e=0;e<4;++e)!(it[e]in t)&&it[2^e]in t&&(t[it[e]]=t[it[2^e]]);var a,s;return e&&(e=$(e))&&e.length&&e[0]!=window&&(a=t,s=e.geometry(),(a=$.extend({},a)).top+=s.top,a.right+=s.left,a.bottom+=s.top,a.left+=s.left,t=a),n=t,v(),y},at:function(t,e,n){return y.near({top:e,left:t},n)},dir:function(t){return i=t,y},remove:x,color:function(t){return s!==(t=t?" "+t:"")&&(s=t,r.className="bubble"+s,o[0].className="bubtail bubtail0"+s,o[2].className="bubtail bubtail1"+s,a=l=null,n&&v()),y},html:function(t){var e=o[1];if(void 0===t)return e.innerHTML;if("string"==typeof t&&t===e.innerHTML&&"visible"===r.style.visibility)return y;if(n&&$(r).css({maxWidth:"",left:"",top:""}),"string"==typeof t)e.innerHTML=t;else{for(;e.childNodes.length;)e.removeChild(e.childNodes[0]);t&&t.jquery?t.appendTo(e):e.appendChild(t)}return n&&v(),y},text:function(t){return void 0===t?$(o[1]).text():y.html(t?function(t){var e=document.createElement("div");return e.appendChild(document.createTextNode(t)),e.innerHTML}(t):t)},content_node:function(){return o[1].firstChild},hover:function(t,e){return $(r).hover(t,e),y},removeOn:function(t,e){return arguments.length>1?$(t).on(e,x):r&&$(r).on(t,x),y},self:function(){return r?$(r):null},outerHTML:function(){return r?r.outerHTML:null}};return t&&y.html(t),y}window.devicePixelRatio&&window.devicePixelRatio>1&&(lt=window.devicePixelRatio,ot=function(t){return Math.round(t*lt)/lt});let dt={};function ht(t){if(window.disable_tooltip)return null;var e=$(this);(t=function(t,e){var n=t.getAttribute("data-tooltip-info");return n&&("string"==typeof n&&"{"===n.charAt(0)?n=JSON.parse(n):"string"==typeof n&&(n={builder:n}),e=$.extend(n,e)),e.builder&&dt[e.builder]&&(e=dt[e.builder].call(t,e)||e),(null==e.dir||t.hasAttribute("data-tooltip-dir"))&&(e.dir=t.getAttribute("data-tooltip-dir")||"v"),(null==e.type||t.hasAttribute("data-tooltip-type"))&&(e.type=t.getAttribute("data-tooltip-type")),(null==e.className||t.hasAttribute("data-tooltip-class"))&&(e.className=t.getAttribute("data-tooltip-class")||"dark"),t.hasAttribute("data-tooltip")?e.content=t.getAttribute("data-tooltip"):null==e.content&&t.hasAttribute("aria-label")?e.content=t.getAttribute("aria-label"):null==e.content&&t.hasAttribute("title")&&(e.content=t.getAttribute("title")),e}(e[0],$.extend({},t||{}))).element=this;var n,i=null,a=null,s=null,r=0,o=t.content;function l(){a=clearTimeout(a),i&&i.remove(),e.removeData("tooltipState"),window.global_tooltip===n&&(window.global_tooltip=null)}function u(){o&&!i?(i=ct(o,{color:"tooltip "+t.className,dir:t.dir}),s=t.near||t.element,i.near(s).hover(n.enter,n.exit)):o?i.html(o):i&&(i&&i.remove(),i=s=null)}return n={enter:function(){return a=clearTimeout(a),++r,n},exit:function(){var e="focus"===t.type?0:200;return a=clearTimeout(a),0==--r&&"sticky"!==t.type&&(a=setTimeout(l,e)),n},erase:l,_element:e[0],html:function(t){return void 0===t?o:(o=t,u(),n)},text:function(t){return n.html(V(t))},near:function(){return s}},function i(a){if(a instanceof Promise)a.then(i);else{var s=window.global_tooltip;o=a,s&&s._element===t.element&&s.html()===o&&!t.done?n=s:(s&&s.erase(),e.data("tooltipState",n),u(),window.global_tooltip=n)}}(o),t.done=!0,n}function pt(){var t=$(this).data("tooltipState")||ht.call(this);t&&t.enter()}function ft(){var t=$(this).data("tooltipState");t&&t.exit()}function gt(){d(this,"need-tooltip"),"focus"===this.getAttribute("data-tooltip-type")?$(this).on("focus",pt).on("blur",ft):$(this).hover(pt,ft)}gt.erase=function(){var t=this===gt?window.global_tooltip:$(this).data("tooltipState");t&&t.erase()},gt.add_builder=function(t,e){dt[t]=e},$((function(){$(".need-tooltip").each(gt)})),b.on("js-repo-copy",(function(){var t=document.createTextNode(this.getAttribute("data-pa-repo")),e=ct(t,{color:"tooltip",dir:"t"});e.near(this);var n=document.createRange();n.selectNode(t),window.getSelection().removeAllRanges(),window.getSelection().addRange(n);try{document.execCommand("copy")}catch(t){}window.getSelection().removeAllRanges(),e.remove(),window.global_tooltip&&window.global_tooltip.elt==this&&window.global_tooltip.text(this.getAttribute("data-pa-repo"))})),b.on("js-repo-list",(function(t){var e=this;$.ajax(L("=api/repositories",{u:this.getAttribute("data-pa-user")}),{method:"POST",cache:!1,success:function(t){var n="Error loading repositories";if(t.repositories&&t.repositories.length){n="Repositories: ";for(var i=0;i<t.repositories.length;++i){var a=t.repositories[i];i&&(n+=", "),n+='<a href="'+V(a.url)+'">'+V(a.name)+"</a>"}}else t.repositories&&(n="No repositories");$('<div style="font-size:medium;font-weight:normal"></div>').html(n).insertAfter(e)}}),t.preventDefault()})),b.on("js-pset-viewoptions",(function(){v(this.nextSibling,this.parentNode)})),b.on("js-pset-setgrader",(function(){var t=$(this.closest("form"));$.ajax(t[0].getAttribute("action"),{data:t.serializeWith({}),type:"POST",cache:!1,dataType:"json",success:function(e){var n;t.find(".ajaxsave61").html(e.ok?"Saved":"<span class='error'>Error: "+e.error+"</span>"),e.ok&&(n=t.find("a.actas")).length&&n.attr("href",n.attr("href").replace(/actas=[^&;]+/,"actas="+encodeURIComponent(e.grader_email)))},error:function(){t.find(".ajaxsave61").html("<span class='error'>Failed</span>")}})})),b.on("js-pset-setcommit",(function(){this.closest("form").submit()})),b.on("js-pset-flag",(function(){let t=this,e=t.closest("form");"flag"!==this.name||e.elements.flagreason?"flag"===this.name?$.post(L("=api/flag",{psetinfo:this,flagid:"new"}),{reason:e.elements.flagreason.value},(function(n){n&&n.ok?($(e).find(".flagreason").remove(),$(t).replaceWith("<strong>Flagged</strong>")):$(e).find(".ajaxsave61").html('<span class="error">Failed</span>')})):"resolveflag"==this.name&&$.post(L("=api/flag",{psetinfo:this,flagid:this.getAttribute("data-flagid"),resolve:1}),{},(function(n){n&&n.ok?$(t).replaceWith("<strong>Resolved</strong>"):$(e).find(".ajaxsave61").html('<span class="error">Failed</span>')})):($(t).before('<span class="flagreason">Why do you want to flag this commit? &nbsp;<input type="text" name="flagreason" value="" placeholder="Optional reason" class="need-autogrow"> &nbsp;</span>'),$(e.elements.flagreason).on("keypress",(function(e){C(e)||"Enter"!==A(e)||(e.preventDefault(),e.stopImmediatePropagation(),$(t).click())})).autogrow()[0].focus(),$(t).html("OK"))}));const mt=[];class bt{constructor(t){if(t.nodeType!==Node.ELEMENT_NODE||!u(t,"pa-filediff"))throw new Error;this.element=t}static closest(t){const e=t.closest(".pa-filediff");return e?new bt(e):null}static referenced(t){const e=t.closest(".pa-fileref");let n;return"A"===e.firstChild.tagName&&(n=bt.by_hash(e.firstChild.hash)),n||bt.closest(t)}static by_file(t){const e=document.getElementById("F"+tt(t));return e?new bt(e):null}static by_hash(t){let e;return(t.startsWith("#F")||t.startsWith("#U"))&&(e=document.getElementById(t.substring(1))),e?new bt(e):null}static add_decorator(t){mt.push(t)}load(){if(u(this.element,"need-load")){const t=this.element.closest(".pa-psetinfo"),e=u(this.element,"pa-wdiff");return d(this.element,"need-load"),new Promise((n=>{$.ajax(L("api/filediff",{psetinfo:t,wdiff:e?1:null}),{type:"GET",cache:!1,dataType:"json",data:{file:this.file,base_commit:t.getAttribute("data-pa-base-commit"),commit:t.getAttribute("data-pa-commit")},success:t=>{if(t.ok&&t.content_html){const e=$(t.content_html);$(this.element).html(e.children()),this.decorate()}n(this)}})}))}return new o(this)}decorate(){for(let t of mt)t(this)}static decorate_page(){$(".pa-filediff.need-decorate").each((function(){d(this,"need-decorate"),u(this,"need-load")||new bt(this).decorate()}))}toggle(t){null==t&&(t=u(this.element,"hidden"));const e=this.element.previousSibling,n=e&&u(e,"pa-fileref")?bt.referenced(e):null,i=n&&n.element===this.element;v(this.element,i?e:null,t)}toggle_show_left(t){null==t&&(t=u(this.element,"pa-hide-left")),h(this.element,"pa-hide-left",!t),$(this.element.previousSibling).find(".pa-diff-toggle-hide-left").toggleClass("btn-primary",t)}get file(){const t=this.element.id;if("U"===t.charAt(0)){const e=t.indexOf("/F");return et(t.substring(e+2))}return et(t.substring(1))}lineid_anchor(t){return"L".concat(t,this.element.id)}lines(){return _t.all(this.element.firstChild)}line(t,e,n){return null==e&&(e=+t.substring(1),t="b"===t.charAt(0)),this.load().then((()=>{for(let i of _t.all(n||this.element.firstChild)){if(i.base_contains(t,e))return i;if(i.expansion_contains(t,e))return i.expand().then((n=>this.line(t,e,n)))}throw null}))}get psetinfo(){return void 0===this._psetinfo&&(this._psetinfo=this.element.closest(".pa-psetinfo")),this._psetinfo}get pset(){return this.psetinfo.getAttribute("data-pa-pset")}get repourl(){return this.psetinfo.getAttribute("data-pa-repourl")}static define_method(t,e){Object.prototype.hasOwnProperty.call(bt.prototype,t)||Object.defineProperty(bt.prototype,t,{value:e,enumerable:!1,configurable:!0,writable:!0})}}class _t{constructor(t){if(t.nodeType!==Node.ELEMENT_NODE||!u(t,"pa-dl"))throw new Error;this.element=t}static closest(t){const e=t.closest(".pa-dl");return e?new _t(e):null}get filediff(){return void 0===this._filediff&&(this._filediff=bt.closest(this.element)),this._filediff}get file(){return this.filediff.file}get note_lineid(){const t=this.element;let e,n,i;return t.hasAttribute("data-landmark")?t.getAttribute("data-landmark"):u(t,"pa-dlr")&&(e=t.lastChild.firstChild)&&(n=e.getAttribute("data-landmark"))&&(i=n.indexOf("-"))>=0?(u(t,"pa-gd")?"a":"b").concat(n.substring(i+1)):u(t,"pa-gd")?"a".concat(t.firstChild.getAttribute("data-landmark")):"b".concat(t.firstChild.nextSibling.getAttribute("data-landmark"))}get linea(){const t=this.element;return u(t,"pa-gc")||u(t,"pa-gd")&&!u(t,"pa-dlr")?+t.firstChild.getAttribute("data-landmark"):this.linea_within(1/0)}get lineb(){const t=this.note_lineid;return t.startsWith("b")?+t.substring(1):null}linea_within(t){let e=this.element;for(;e&&t>=0;){if(u(e,"pa-gc"))return+e.firstChild.getAttribute("data-landmark");e=e.previousSibling,--t}return 0}get psetinfo(){return this.filediff.psetinfo}get pset(){return this.filediff.pset}get repourl(){return this.filediff.repourl}get hash(){const t=this.element,e=this.filediff.element.id;return t.hasAttribute("data-landmark")?"#L".concat(t.getAttribute("data-landmark"),e):u(t,"pa-gd")?"#La".concat(t.firstChild.getAttribute("data-landmark"),e):u(t,"pa-gi")||u(t,"pa-gc")?"#Lb".concat(t.firstChild.nextSibling.getAttribute("data-landmark"),e):null}is_visible(){return!!this.element.offsetParent}visible_predecessor(){if(!this.element.offsetParent)for(let t=this.element.previousSibling;t;t=t.previousSibling)if(u(t,"pa-dlr"))return new _t(t);return this}visible_source(){for(let t of _t.all(this,1))if(t.is_visible()&&t.is_source())return t;return null}is_base(){return/^pa-dl pa-g[idc]/.test(this.element.className)}base_contains(t,e){const n=this.element;return/^pa-dl pa-g[idc]/.test(n.className)&&(t?n.firstChild.nextSibling:n.firstChild).getAttribute("data-landmark")==e}is_source(){return/ pa-g[idc]/.test(this.element.className)}is_expandable(){return this.element.hasAttribute("data-expandmark")}expansion_contains(t,e){const n=this.element.getAttribute("data-expandmark"),i=n?n.match(/^a(\d+)b(\d+)\+(\d*)$/):null;if(i){const n=i[t?2:1]-e;return n>=0&&(!i[3]||n<i[3])}return!1}expand(){const t=this.element,e=t.getAttribute("data-expandmark"),n=e?e.match(/^a(\d+)b(\d+)\+(\d*)$/):null;if(!n||"0"===n[3])return new o(this);t.removeAttribute("data-expandmark");const i=+n[1],a=+n[2],s={psetinfo:this.element,file:this.file,fromline:a};return""!==n[3]&&(s.linecount=+n[3]),new Promise((e=>{$.ajax(L("api/blob",s),{success:function(n){if(n.ok&&n.data){const s=n.data.replace(/\n$/,"").split("\n");for(let e=s.length-1;e>=0;--e){const n='<div class="pa-dl pa-gc"><div class="pa-da" data-landmark="'.concat(i+e,'"></div><div class="pa-db" data-landmark="',a+e,'"></div><div class="pa-dd"></div></div>');$(n).insertAfter(t).find(".pa-dd").text(s[e])}const r=t.nextSibling;$(t).remove();const o=bt.closest(r);u(o.element,"pa-highlight")&&o.highlight(),e(new _t(r))}}})}))}is_annotation(){return u(this.element,"pa-gn")}is_note(){return u(this.element,"pa-gw")}upper_bound(t,e){null==e&&(e=+t.substring(1),t="b"===t.charAt(0));let n=!1;for(let i of _t.all(this)){const a=i.element;if(n&&(u(a,"pa-gx")||u(a,"pa-dlr")))return i;if(i.is_source()){const s=+(t?a.firstChild.nextSibling:a.firstChild).getAttribute("data-landmark");if(!s&&n||e<s)return i;e===s&&i.is_base()&&(n=!0)}else if(a.hasAttribute("data-landmark")){const n=a.getAttribute("data-landmark");if(n.charAt(0)===(t?"b":"a")&&e<+n.substring(1))return i}}return null}static get BACKWARD(){return 1}static get ANYFILE(){return 2}static*all(t,e){t instanceof _t&&(t=t.element),e=e||0;let n=t.parentElement;const i=1&e?"previousSibling":"nextSibling";for(;;){for(;!t&&n;){if(!(2&e)&&u(n,"pa-filediff"))return;t=n[i],n=n.parentElement}if(!t)break;t.nodeType!==Node.ELEMENT_NODE?t=t[i]:u(t,"pa-dg")?(n=t,t=n[1&e?"lastChild":"firstChild"]):(u(t,"pa-dl")&&(yield new _t(t)),t=t[i])}}static*range(t,e,n,i){let a=-1,s=-1;for(let r of _t.all(t)){const t=r.element;if(!u(t,"pa-dlr")){const o=t.firstChild;if(u(o,"pa-da"))o.hasAttribute("data-landmark")&&(a=+o.getAttribute("data-landmark")),o.nextSibling.hasAttribute("data-landmark")&&(s=+o.getAttribute("data-landmark"));else if(t.hasAttribute("data-landmark")){const e=t.getAttribute("data-landmark");"a"===e.charAt(0)?a=+e.substring(1):s=+e.substring(1)}if(a>n)break;a>=e&&(!i||t.matches(i))&&(r.linea=a,r.lineb=s,yield r)}}}}function vt(t){let e,n,i;(e=t.match(/^[^#]*(#(?:U[-A-Za-z0-9_.@]+\/|)F[-A-Za-z0-9_.@\/]+)$/))?i=bt.by_hash(e[1]):(e=t.match(/^[^#]*#L([ab]\d+)((?:U[-A-Za-z0-9_.@]+\/|)F[-A-Za-z0-9_.@\/]+)$/))&&(i=bt.by_hash("#"+e[2]),n=e[1]),i&&n?i.line(n).then((t=>{i.toggle(!0);const e=t.visible_predecessor().element;u(e,"pa-gd")&&i.toggle_show_left(!0),c(e,"pa-line-highlight"),window.scrollTo(0,Math.max($(e).geometry().top-Math.max(.1*window.innerHeight,24),0))})).catch(null):i&&(i.toggle(!0),window.scrollTo(0,Math.max($(i.element).geometry().top-Math.max(.1*window.innerHeight,24),0)))}function xt(t,e,n){let i;for(;e!==n&&(32===(i=t.charCodeAt(e))||9===i);)++e;return e}function yt(t,e,n,i){for(;e!==n;){const n=t.charCodeAt(e),a=32|n;if(a>=97&&a<=122);else if(i!==e||45!==n&&(n<48||n>57))break;++e}return e}function wt(t,e,n){let i;const a={tag:null,ok:!1,open:null,close:null,attr:{},pos:e};if(60!==t.charCodeAt(e))return a;(e=xt(t,e+1,n))!==n&&47===t.charCodeAt(e)&&(a.open=!1,a.close=!0,e=xt(t,e+1,n));const s=e;if((e=yt(t,e,n,e))===s)return a;for(null===a.open&&(a.open=!0),a.tag=t.substring(s,e).toLowerCase();;){if(i=(e=xt(t,e,n))!==n?t.charCodeAt(e):-1,62===i)return a.pos=e+1,a.ok=!0,a;if(47===i)a.close=!0,++e;else{if(a.close)return a;if(!((32|i)>=97&&(32|i)<=122))return a;{const s=e,r=yt(t,e,n,e),o=t.substring(s,r).toLowerCase();if((e=xt(t,r,n))!==n&&61===t.charCodeAt(e))if(i=(e=xt(t,e+1,n))!==n?t.charCodeAt(e):-1,34===i||39===i){const n=t.indexOf(t.charAt(e),e+1),i=t.indexOf("\n",e+1);if(-1===n||i>0&&n>i)return a;a.attr[o]=t.substring(e+1,n),e=n+1}else{if(!(45===i||i>=48&&i<=57||(32|i)>=97&&(32|i)<=122))return a;{const i=e;e=yt(t,e+1,n,e),a.attr[o]=t.substring(i,e)}}else a.attr[o]=!0}}}}function kt(t,e){let n=t.src,i=t.pos,a=t.posMax;if(60!==n.charCodeAt(i)||i+2>=a)return!1;let s=32|n.charCodeAt(i+1);if(47!==s&&98!==s&&105!==s&&115!==s)return!1;const r=wt(n,i,a);if(!r.ok)return!1;if("br"===r.tag){if(r.open){const t=wt(n,xt(n,r.pos,a),a);t.ok&&"br"===t.tag&&!t.open&&(r.pos=t.pos)}e||t.push("hardbreak","br",0)}else if("sub"!==r.tag&&"sup"!==r.tag||r.close){if("img"!==r.tag||!r.attr.src)return!1;{let e=t.push("image","img",0);e.attrs=[["src",r.attr.src],["alt",""]],r.attr.title&&e.attrs.push(["title",r.attr.title]),e.children=[],e.content=r.attr.alt||"",""!==e.content&&t.md.inline.parse(e.content,t.md,t.env,e.children)}}else{const i=n.indexOf("<",r.pos),s=n.indexOf("\n",r.pos);let o=i>=r.pos&&(s<0||s>i)?wt(n,i,a):null;if(!o||!o.ok||o.open||o.tag!==r.tag)return!1;if(!e){t.push(r.tag+"_open",r.tag,1),t.push("text","",0).content=n.substring(r.pos,i),t.push(r.tag+"_close",r.tag,-1)}r.pos=o.pos}return t.pos=r.pos,!0}function At(t){t.inline.ruler.after("autolink","minihtml_inline",kt)}let Ct,$t;function Et(t,e,n){try{const i=hljs.highlight(t,e,!0,n),a=i.value;return e.endsWith("\r\n")&&a.endsWith("\n\n")&&(i.value=a.substring(0,a.length-1)),i}catch(t){return null}}function St(t){return t[0]+1===t[1]?String(t[1]):t[0]+1+"-"+t[1]}function Dt(t,e,n,i,a){var s=t[e];return s.map&&0===s.level&&s.attrSet("data-landmark",St(s.map)),a.renderToken(t,e,n,i)}function Mt(t,e,n,i,a){var s=t[e];return s.map&&s.level<=1&&s.attrSet("data-landmark",St(s.map)),a.renderToken(t,e,n,i)}function Ft(t,e){if(e.map&&0===e.level){var n=' data-landmark="'+St(e.map)+'"',i=t.indexOf(" "),a=t.indexOf(">");i>0&&i<a&&(a=i),t=t.substring(0,a)+n+t.substring(a)}return t}function Tt(t){return t?function(e,n,i,a,s){var r=e[n];return Ft(t(e,n,i,a,s),r)}:Dt}function Nt(){if(!Ct){for(var t of(Ct=markdownit({linkify:!0}).use(markdownit_katex).use(At),["paragraph_open","heading_open","ordered_list_open","bullet_list_open","table_open","blockquote_open","hr"]))Ct.renderer.rules[t]=Tt(Ct.renderer.rules[t]);Ct.renderer.rules.fence=Ct.renderer.rules.code_block=function(t){return function(e,n,i,a,s){const r=e[n];let o,l=r.info?t.utils.unescapeAll(r.info):"";l&&l.indexOf(" ")>=0&&((o=l.match(/^ *([-a-z+]+) *$/))?l=o[1]:(r.content=l+"\n"+r.content,r.map&&(r.map[0]-=1),l=""));let u=l?l.trim().split(/\s+/g)[0]:"";u&&hljs.getLanguage(u)||(u=null);let c=r;if(u){let t=r.attrIndex("class");c={attrs:r.attrs?r.attrs.slice():[]},t<0?c.attrs.push(["class",i.langPrefix+u]):c.attrs[t][1]+=" "+i.langPrefix+u}let d="><code".concat(s.renderAttrs(c),">");if(r.map&&0===r.level){const t=r.content.split(/\n/),e=[];""===t[t.length-1]&&t.pop();const n=t.length;let i=0,a=r.map[0]+2,s=null;for(;u&&i!==n;){const r=Et(u,t[i]+"\n",s);if(!r)break;e.push('<pre data-landmark="',a+i,i+1!==n?'" class="partial"':'"',d,r.value,"</code></pre>"),s=r.top,++i}for(;i!==n;)e.push('<pre data-landmark="',a+i,i+1!==n?'" class="partial"':'"',d,t[i],"\n</code></pre>"),++i;return e.join("")}return"<pre".concat(d,t.utils.escapeHtml(r.content),"</code></pre>")}}(Ct),Ct.renderer.rules.image=function(t){function e(t,e){return siteinfo.site_relative+"~"+encodeURIComponent(siteinfo.uservalue)+"/raw/"+t.getAttribute("data-pa-pset")+"/"+t.getAttribute("data-pa-commit")+"/"+e}return function(n,i,a,s,r){var o,l,u,c=n[i],d=c.attrIndex("src"),h=c.attrs[d][1];if(siteinfo.uservalue&&$t&&(o=$t.closest(".pa-psetinfo"))){if(!/\/\//.test(h)){for(var p=bt.closest($t),f=p?p.file.replace(/^(.*)\/[^\/]*$/,"$1"):"";;)if(h.startsWith("./"))h=h.substring(2).replace(/^\/+/,"");else if(h.startsWith("../")&&""!==f)h=h.substring(3).replace(/^\/+/,""),f=f.replace(/(?:^|\/)[^\/]+\/*$/,"");else{if(h.startsWith("../")||h.startsWith("/")){h=null;break}if(!(l=h.match(/(^|\/+)[^\/]+\/\.\.(?:\/+|$)(.*)$/)))break;h=l[1]+l[2]}c.attrs[d][1]=h?e(o,f?f+"/"+h:h):"data:image/jpg,"}(l=h.match(/^https:\/\/github\.com\/([^\/]+\/[^\/]+)\/(?:blob|raw)\/([^\/]+)\/(.*)$/))&&(u=(o.getAttribute("data-pa-repourl")||"").match(/^(?:https:\/\/github\.com\/|git@github\.com:)(.*?)\/?$/))&&u[1]==l[1]&&o.getAttribute("data-pa-branch")==l[2]&&(c.attrs[d][1]=e(o,l[3]))}return Ft(t(n,i,a,s,r),c)}}(Ct.renderer.rules.image),Ct.renderer.rules.list_item_open=Mt}return Ct}function jt(t){for(var e;(e=t.firstChild)&&1!==e.nodeType;)t.removeChild(e);if(e&&e.hasAttribute("data-landmark")){for(;e.nextSibling&&1!==e.nextSibling.nodeType;)t.removeChild(e.nextSibling);if(e.nextSibling){"OL"===t.tagName&&(e.hasAttribute("value")||(e.value=t.start),t.start=e.value+1);var n=document.createElement(t.tagName);n.appendChild(t.removeChild(e)),t=n}t.setAttribute("data-landmark",e.getAttribute("data-landmark"))}return t}function Lt(t,e){return t?t.replace(/(?:^|\s)(?:need-format|format\d+)(?=$|\s)/g,"").concat(" format",e).trimStart():"format"+e}function zt(t,e,n){const i=t.render(e);return null==n?i:n instanceof Element?(n.className=Lt(n.className,t.format),void(n.innerHTML=i)):'<div class="'.concat(Lt(n,t.format),'">',i,"</div>")}function Ot(t){let e=0,n=0;for(;;){const i=t.charCodeAt(n);if(0===n?60!==i:62!==i&&(i<48||i>57))return[0,t];if(0!==n&&i>=48&&i<=57)e=10*e+i-48;else if(62===i)return 1===n?[0,t]:[e,t.substring(n+1)];++n}}b.on("pa-diff-unfold",(function(t){const e=t.metaKey?$(".pa-diff-unfold"):$(this),n=bt.by_hash(this.hash),i=u(n.element,"hidden"),a=!!t.metaKey||i;e.each((function(){bt.by_hash(this.hash).load().then((t=>t.toggle(a)))})),t.metaKey||$.post(L("=api/diffconfig",{psetinfo:n.element,file:n.file,collapse:i?0:1}))})),b.on("pa-diff-toggle-hide-left",(function(t){const e=t.metaKey?$(".pa-diff-toggle-hide-left"):$(this),n=u(bt.referenced(this).element,"pa-hide-left");e.each((function(){bt.referenced(this).toggle_show_left(n)}))})),u(document.body,"want-grgraph-hash")||($(window).on("popstate",(function(t){const e=(t.originalEvent||t).state;e&&e.href&&vt(e.href)})).on("hashchange",(function(){vt(location.href)})),$((function(){vt(location.href)}))),b.on("pa-gx",(function(t){new _t(t.currentTarget).expand()})),$(bt.decorate_page),bt.define_method("markdown",(function(){const t=this.element;if(u(t,"pa-markdown")||u(t,"pa-highlight"))return;const e=u(t,"pa-hide-landmarks"),n=e?"pa-da hidden":"pa-da",i=e?"pa-db hidden":"pa-db",a=e?"pa-dr pa-dhlm":"pa-dr";let s=t.firstChild,r=[],o=1;for(;s;){let e=s.nextSibling;if(u(s,"pa-dlr"))t.removeChild(s);else if(u(s,"pa-gi")||u(s,"pa-gc")){const t=+s.firstChild.nextSibling.getAttribute("data-landmark");for(;o<t;)r.push("\n"),++o;r.push(s.lastChild.textContent),++o,c(s,"hidden")}s=e}let l,h,p=document.createElement("div");for($t=t,p.innerHTML=Nt().render(r.join("")),$t=null,s=t.firstChild;l=p.firstChild;){if(1!==l.nodeType){p.removeChild(l);continue}"OL"===l.tagName||"UL"===l.tagName?l=jt(l):"P"===l.tagName&&1===l.firstChild.nodeType&&"IMG"===l.firstChild.tagName&&l.firstChild===l.lastChild&&c(l,"image-container");const e=document.createElement("div");e.className="pa-dl pa-dlr";const r=document.createElement("div");r.className=n;const o=document.createElement("div");o.className=i;const d=l.getAttribute("data-landmark");if(d){let t=parseInt(d),n=d.indexOf("-"),i=n>=0?parseInt(d.substring(n+1)):t;for(;s&&!((u(s,"pa-gi")||u(s,"pa-gc"))&&+s.firstChild.nextSibling.getAttribute("data-landmark")>=t);)s=s.nextSibling;o.setAttribute("data-landmark",t);let a=0,r=s;for(;r;){if(u(r,"pa-gi")||u(r,"pa-gc")){if(+r.firstChild.nextSibling.getAttribute("data-landmark")>=i)break;a|=u(r,"pa-gi")?1:2}r=r.nextSibling}e.className+=2===a?" pa-gc":" pa-gi"}for(h=document.createElement("div"),h.className=a,l===p.firstChild&&p.removeChild(l),h.appendChild(l);p.firstChild&&1!==p.firstChild.nodeType;)h.appendChild(p.removeChild(p.firstChild));e.appendChild(r),e.appendChild(o),e.appendChild(h),t.insertBefore(e,s)}h&&c(h,"pa-dr-last"),c(t,"pa-markdown"),d(t,"need-markdown")})),bt.define_method("unmarkdown",(function(){const t=this.element;let e=t.firstChild;for(;e;){var n=e.nextSibling;u(e,"pa-dlr")?t.removeChild(e):(u(e,"pa-gi")||u(e,"pa-gc"))&&d(e,"hidden"),e=n}d(t,"pa-markdown")})),bt.define_method("highlight",(function(){const t=this.element;let e;if(!(e=t.getAttribute("data-language"))){let n=this.file;/\.(?:cc|cpp|hh|hpp|c\+\+|h\+\+|C|H)$/.test(n)?e="c++":/\.(?:c|h)$/.test(n)&&(e="c"),e&&t.setAttribute("data-language",e)}if(!e||!hljs.getLanguage(e)||u(t,"pa-markdown"))return;const n="language-"+e;let i=t.firstChild,a=null,s=null;for(;i;){const t=u(i,"pa-gi")?2:u(i,"pa-gc")?3:u(i,"pa-gd")?1:0;if(0!==t){const r=i.lastChild,o=u(r,n),l=o?r.getAttribute("data-pa-text"):r.textContent,d=Et(e,l,2&t?a:s);if(!d)break;1&t&&(s=d.top),2&t&&(a=d.top),o||(r.setAttribute("data-pa-text",l),r.innerHTML=d.value,c(r,n))}i=i.nextSibling}c(t,"pa-highlight"),d(t,"need-highlight")})),bt.define_method("unhighlight",(function(){const t=this.element,e=t.getAttribute("data-language"),n=e?"language-"+e:"";let i,a=t.firstChild;for(;a;)(i=a.lastChild)&&i.hasAttribute("data-pa-text")&&(!n||u(i,n))&&(i.innerText=i.getAttribute("data-pa-text"),i.removeAttribute("data-pa-text"),n&&d(i,n)),a=a.nextSibling;d(t,"pa-highlight")})),bt.add_decorator((function(t){u(t.element,"need-markdown")?t.markdown():u(t.element,"need-highlight")&&t.highlight()})),b.on("pa-diff-toggle-markdown",(function(t){const e=t.metaKey?$(".pa-diff-toggle-markdown"):$(this),n=bt.referenced(this),i=!u(n.element,"pa-markdown");e.each((function(){const t=bt.referenced(this),e=u(t.element,"pa-markdown");i&&!e?t.markdown():!i&&e&&t.unmarkdown(),h(this,"btn-primary",i)})),t.metaKey||$.post(L("=api/diffconfig",{psetinfo:n.element}),{file:n.file,markdown:i?1:0})}));const Bt={};function It(t,e,n){return zt(Bt[t]||Bt[0],e,n)}let Pt,Rt;function Ht(t,e){if(e&&hljs.getLanguage(e))try{return hljs.highlight(e,t,!0).value}catch(t){}return""}function Wt(t,e){const n=Ot(t);return zt(Bt[n[0]]||Bt[0],n[1],e)}It.add_format=function(t){if(null==t.format||""===t.format||Bt[t.format])throw new Error("bad or reused format");Bt[t.format]=t},It.on_page=function(){$(".need-format").each((function(){let t=this.getAttribute("data-format"),e=this.getAttribute("data-content");if(null==e&&(e=this.textContent),null==t){const n=Ot(e);t=n[0],e=n[1]}It(t,e,this)}))},It.add_format({format:0,render:function(t){return V(t).replace(/((?:https?|ftp):\/\/(?:[^\s<>\"&]|&amp;)*[^\s<>\"().,:;&])([\"().,:;]*)(?=[\s<>&]|$)/g,(function(t,e,n){return'<a href="'+e+'" rel="noreferrer">'+e+"</a>"+n}))}}),It.add_format({format:1,render:function(t){return Pt||(Pt=window.markdownit({highlight:Ht,linkify:!0}).use(markdownit_katex).use(At)),Pt.render(t)}}),It.add_format({format:3,render:function(t){return Rt||(Rt=window.markdownit({highlight:Ht,linkify:!0,html:!0}).use(markdownit_katex)),Rt.render(t)}}),It.add_format({format:5,render:function(t){return t}});const qt={parse:Ot,unparse:function(t,e){return t||e.startsWith("<")?"<".concat(t||0,">",e):e},render:Wt};$(It.on_page);class Ut{constructor(){this.iscomment=!1,this.ftext="",this.format=null}empty(){return""===this.ftext}get file(){return bt.closest(this.element||this.source).file}get lineid(){return this.element?this.element.getAttribute("data-landmark"):new _t(this.source).note_lineid}get linea(){return new _t(this.element||this.source).linea}linea_within(t){return new _t(this.element||this.source).linea_within(t)}get editable_text(){return qt.parse(this.ftext)[1]}static parse(t){const e=new Ut;return"string"==typeof t&&""!==t&&(t=JSON.parse(t)),e.assign(t),e}assign(t){let e=[null,""];"number"==typeof t?(this.iscomment=!1,this.ftext="",this.users=null,this.version=t):Array.isArray(t)&&(this.iscomment=t[0],this.ftext=t[1],e=qt.parse(t[1]),this.users=t[2]||null,this.version=t[3]&&"number"==typeof t[3]?t[3]:null),this.format=e[0];const n=this.element;if(n)if(""===this.ftext&&null==this.version)n.removeAttribute("data-pa-note");else if(""===this.ftext&&null==this.users)n.setAttribute("data-pa-note",""+this.version);else{const t=[this.iscomment,this.ftext];null==this.users&&null==this.version||t.push(this.users,this.version),n.setAttribute("data-pa-note",JSON.stringify(t))}}static at(t){const e=Ut.parse(t.getAttribute("data-pa-note"));return e.element=t,e}static closest(t){const e=t.closest(".pa-dl");return e?Ut.at(e):null}static near(t){t instanceof _t&&(t=t.element);let e=t;for(;e;)if(1!==e.nodeType)e=e.nextSibling;else{if(u(e,"pa-gw"))return Ut.at(e);if(!(e===t||u(e,"pa-gn")||u(e,"pa-gx")||u(e,"hidden")))break;e=e.nextSibling}const n=new Ut;return n.source=t,n}force_element(){if(!this.element){const t=new _t(this.source),e=t.note_lineid,n=t.upper_bound(e);this.element=document.createElement("div"),this.element.className="pa-dl pa-gw",this.element.setAttribute("data-landmark",e),(this.version||""!==this.ftext)&&this.element.setAttribute("data-pa-note",JSON.stringify([this.iscomment,this.ftext,this.users,this.version]));let i=document.createElement("div");i.className="pa-notebox",this.element.appendChild(i),this.source.parentElement.insertBefore(this.element,n?n.element:null)}return this.element}cancel_edit(){return this.element&&u(this.element,"editing")&&$(this.element).find("textarea").val(this.editable_text),this}render(t){if(this.force_element(),u(this.element,"editing")){const t=$(this.element).find("textarea");if(t.length&&!l(this.editable_text,t.val().replace(/\s+$/,"")))return!1;d(this.element,"editing"),$(this.element).find(":focus").blur()}var e=$(this.element).find(".pa-notebox"),n=e.children();if(t?n.slideUp(80).queue((function(){n.remove()})):n.remove(),""===this.ftext)return Kt(this.element),t?$(this.element).children().slideUp(80):c(this.element,"hidden"),!0;let i='<div class="pa-notecontent clearfix">';if(this.users){const t=$.isArray(this.users)?this.users:[this.users],e=[];for(let n in t){const i=siteinfo.pc?siteinfo.pc[t[n]]:null;i&&(i.nick?e.push(i.nick):i.nicklen||i.lastpos?e.push(i.name.substr(0,i.nicklen||i.lastpos-1)):e.push(i.name))}e.length&&(i+='<div class="pa-note-author">['+e.join(", ")+"]</div>")}return i=i.concat('<div class="pa-dr pa-note pa-',this.iscomment?"comment":"grade",'note"></div></div>'),e.append(i),qt.render(this.ftext,e.find(".pa-note")[0]),Kt(this.element),t?e.find(".pa-notecontent").hide().slideDown(80):(e.show(),d(this.element,"hidden")),!0}save_ftext(t,e){if(this.element){if(u(this.element,"pa-outstanding"))return Promise.reject(new Error("Outstanding request"));c(this.element,"pa-outstanding")}const n=this.element&&u(this.element,"editing"),i=this,a=this.element||this.source,s=a.closest(".pa-filediff").closest(".pa-psetinfo"),r=a.closest(".pa-grade-range-block"),o={ftext:t},l=this.linea_within(1e3);return e&&(o.iscomment=1),l&&(o.linea=l),r&&r.setAttribute("data-pa-notes-outstanding",+r.getAttribute("data-pa-notes-outstanding")+1),new Promise((function(t,e){W(L("=api/linenote",{psetinfo:s,file:i.file,line:i.lineid,oldversion:i.version||0}),o).then((function(a){if(i.element&&d(i.element,"pa-outstanding"),a&&a.ok){i.force_element(),d(i.element,"pa-save-failed");const e=a.linenotes[i.file];i.assign(e&&e[i.lineid]),i.render(n),t(i)}else i.element&&c(i.element,"pa-save-failed"),n&&$(i.element).find(".pa-save-message").html('<strong class="err">'+V(a.error||"Failed")+"</strong>"),e(new Error(a.error||"Save failed"));r&&function(t){var e=+t.getAttribute("data-pa-notes-outstanding")-1;e?t.setAttribute("data-pa-notes-outstanding",e):(t.removeAttribute("data-pa-notes-outstanding"),$(t).find(".pa-grade").each((function(){$pa.gradeentry_closest(this).save_landmark_grade(t)})))}(r)}))}))}save_text(t,e){let n=this.format;return null==n&&(n=+document.body.getAttribute("data-default-format"),isNaN(n)&&(n=0)),this.save_ftext(qt.unparse(n,t),e)}}function Zt(t,e){let n,i=$(t).find(".pa-note-links a");i.length||(i=$("<a></a>"),$('<div class="pa-note-links"></div>').append(i).prependTo($(t).find(".pa-notecontent"))),e?(i.attr("href",new _t(e).hash),n="NEXT >"):(i.attr("href",""),n="TOP"),i.text()!==n&&i.text(n)}function Kt(t){const e=$(".pa-gw");let n=0;for(;n<e.length&&e[n]!==t;)++n;if(n<e.length){let i=n-1;for(;i>=0&&Ut.at(e[i]).empty();)--i;let a=n+1;for(;a<e.length&&Ut.at(e[a]).empty();)++a;i>=0&&Zt(e[i],Ut.at(t).empty()?e[a]:t),Zt(t,e[a])}}let Jt={};const Yt={red:"cR",orange:"cO",yellow:"cY",green:"cG",blue:"cB",purple:"cP",gray:"cA",grey:"cA"},Gt={basic_text:t=>null==t?"":""+t,basic_mount_edit:function(t,e,n){let i;return i=n&&n.max_text?n.max_text:this.max?"of "+this.max:"",window.$pa.long_page?'<textarea class="ta1 uich pa-gradevalue pa-gradewidth" name="'.concat(this.key,'" id="',e,'" rows="1" wrap="none" cols="10000"></textarea> <span class="pa-gradedesc">',i,"</span>"):'<input type="text" class="uich pa-gradevalue pa-gradewidth" name="'.concat(this.key,'" id="',e,'"> <span class="pa-gradedesc">',i,"</span>")},basic_mount_show:function(t,e){t.id=e;const n=[document.createElement("span")];n[0].className="pa-gradevalue pa-gradewidth",this.max&&"letter"!==this.type&&(n.push(" ",document.createElement("span")),n[2].className="pa-gradedesc",n[2].append("of "+this.max)),t.replaceChildren(...n)},basic_update_edit:function(t,e,n){const i=t.querySelector(".pa-gradevalue"),a=this.simple_text(e);$(i).val()===a||!n.reset&&$(i).is(":focus")||$(i).val(a),null!=n.mixed&&(n.mixed?i.setAttribute("placeholder","Mixed"):i.removeAttribute("placeholder"))},basic_configure_column:function(t,e){t.ge=this,t.gabbr=this.abbr(),t.justify=this.gc.justify||"right",t.sort_forward="forward"===this.gc.sort;const n=this.gc.justify||"right";return t.className=(t.gkey===e.total_key?"gt-total":"gt-grade")+("left"===n?" l":" r"),this.table_color&&Yt[this.table_color]&&(t.className+=" "+Yt[this.table_color]),t.make_compare=e=>this.gc.make_compare.call(this,t,e),t},basic_make_compare:function(t){const e=t.gidx,n="forward"===this.gc.sort?1:-1;return function(t,i){const a=t.grades&&t.grades[e],s=i.grades&&i.grades[e];if(""===a||null==a||""===s||null==s){if(""!==a&&null!=a)return-n;if(""!==s&&null!=s)return n}else{if(a<s)return-1;if(a>s)return 1}return n*t._sort_user.localeCompare(i._sort_user)}},basic_tcell_width:function(){return 3},add:(t,e)=>{e.type=t,e.type_tabular=null==e.type_tabular||e.type_tabular,e.text=e.text||Gt.basic_text,e.simple_text=e.simple_text||e.text,e.configure_column=e.configure_column||Gt.basic_configure_column,e.tcell_width=e.tcell_width||Gt.basic_tcell_width,e.tcell=e.tcell||e.text,e.make_compare=e.make_compare||Gt.basic_make_compare,e.mount_show=e.mount_show||Gt.basic_mount_show,e.mount_edit=e.mount_edit||Gt.basic_mount_edit,e.update_edit=e.update_edit||Gt.basic_update_edit,Jt[t]=e},find:t=>Jt[t]||Jt.numeric};Gt.add("numeric",{mount_edit:Gt.basic_mount_edit}),Gt.add("formula",{text:function(t){if(null==t||!1===t)return"";if(!0===t)return"";{const e=t.toFixed(1);return e.endsWith(".0")?e.substring(0,e.length-2):e}}}),Gt.add("time",{text:function(t){return null==t||0===t?"":s("%Y-%m-%d %H:%M",t)}}),Gt.add("duration",{text:function(t){return null==t?"":r(t)}}),Gt.add("text",{mount_show:function(t,e){t.id=e,c(t,"pa-textv"),c(t,"pa-gradevalue")},mount_edit:function(t,e){return c(t,"pa-textv"),'<textarea class="uich pa-gradevalue need-autogrow" name="'.concat(this.key,'" id="',e,'"></textarea>')},justify:"left",sort:"forward",type_tabular:!1}),Gt.add("shorttext",{mount_show:function(t,e){t.id=e,c(t,"pa-gradevalue")},mount_edit:function(t,e){return'<textarea class="uich pa-gradevalue need-autogrow" rows="1" name="'.concat(this.key,'" id="',e,'"></textarea>')},justify:"left",sort:"forward",type_tabular:!1}),Gt.add("section",{text:()=>"",mount_show:function(t,e){t.id=e,c(t.closest(".pa-p"),"pa-p-section")},mount_edit:function(t){c(t.closest(".pa-p"),"pa-p-section")},update_show:function(){return!1},type_tabular:!1}),b.on("keydown.pa-sidebar-tab",(function(t){if("Tab"===A(t)&&!t.ctrlKey&&!t.altKey&&!t.metaKey){const e=function(t,e){let n,i,a=t.closest(".pa-sidebar"),s=a.querySelectorAll(".pa-sidebar-tab"),r=Array.prototype.indexOf.call(s,t);if(r<0)return null;for(;;)if(r+=e?-1:1,r<0||r>=s.length){if(null==n&&(n=document.querySelectorAll(".pa-sidebar"),i=Array.prototype.indexOf.call(n,a),i<0))return null;if(i+=e?-1:1,!(i>=0&&i<n.length))return null;a=n[i],s=a.querySelectorAll(".pa-sidebar-tab"),r=e?s.length:-1}else if(s[r].offsetParent)return s[r]}(this,t.shiftKey);e&&(e.focus(),e.setSelectionRange&&e.setSelectionRange(0,e.value.length),t.preventDefault())}}));let Vt,Xt=0;const Qt={pset:!0,uid:!0,user:!0,commit:!0,base_commit:!0,base_handout:!0,late_hours:!0,auto_late_hours:!0,student_timestamp:!0,version:!0,history:!0,total:!0,total_noextra:!0,grading_hash:!0,answer_version:!0,user_scores_visible:!0,scores_editable:!0,answers_editable:!0,linenotes:!0};class te{constructor(t){Object.assign(this,t),this.type=this.type||"numeric",this.gc=Gt.find(this.type),this.normal=!0,this._abbr=null,this._all=null}get type_tabular(){return this.gc.type_tabular}get title_html(){let t,e,n=this.title;return n?"<"===n.charAt(0)&&(t=n.charAt(1))>="0"&&t<="9"?(n=Wt(n).trim(),n.startsWith("<p>")&&n.endsWith("</p>")&&(e=n.substring(3,n.length-4)).indexOf("</p>")<0&&(n=e),n):V(n):this.key}get title_text(){let t,e,n=this.title;return n?"<"===n.charAt(0)&&(t=n.charAt(1))>="0"&&t<="9"?(n=Wt(n).trim(),n.startsWith("<p>")&&n.endsWith("</p>")&&(e=n.substring(3,n.length-4)).indexOf("</p>")<0&&(n=e),null!==(i=n)&&"number"!=typeof i?i.replace(X,(function(t){return Q[t]})):i):n:this.key;var i}abbr(){return this._abbr||this.compute_abbr(),this._abbr}compute_abbr(){const t=this._all?this._all.order:[this.key],e=this._all?this._all.value_order:[this.key],n=this._all?this._all.entries:{[this.key]:this};let i={};for(let e=0;e!==t.length;++e)n[t[e]]._abbr=":"+e;for(let t=0;t!==e.length;++t){const a=n[e[t]],s=a.title_text;let r=s.match(/^(p)(?:art[\s\d]|(?=\d))([-.a-z\d]+)(?:[\s:]+|$)/i)||s.match(/^(q)(?:uestion[\s\d]|(?=\d))([-.a-z\d]+)(?:[\s:]+|$)/i)||s.match(/^[\s:]*()(\S{1,3}[\d.]*)[^\s\d]*[\s:]*/);if(r){let e,n=r[1]+r[2],o=s.substring(r[0].length);for(;e=i[n];){if(!0!==e&&(r=e[1].match(/^(\S{1,3}[\d.]*)\S*[\s:]*(.*)$/))&&(e[0]._abbr+=r[1],i[e[0]._abbr]=[e[0],r[2]],i[n]=e=!0),!(r=o.match(/^(\S{1,3}[\d.]*)[^\s\d]*[\s:]*(.*)$/))){!0!==e&&(n+=":"+t);break}n+=r[1],o=r[2]}a._abbr=n,i[n]=[a,o]}}}render(t,e){null==e&&(e=!this.readonly&&(this.answer?t.answers_editable:t.scores_editable)?2:0);const n="pe-ge"+ ++Xt,i=document.createElement("div"),a=document.createElement("label"),s=document.createElement(2===e?"form":"div");let r="pa-grade pa-p".concat(e?" e":"",this.answer?" pa-ans":"");if((null==this.visible&&!this.answer&&!1===t.user_scores_visible||!1===this.visible||"none"===this.visible)&&(r+=" pa-p-hidden"),i.className=r,i.setAttribute("data-pa-grade",this.key),a.className="pa-pt",a.htmlFor=n,a.innerHTML=this.title_html,i.appendChild(a),this.description){const t=document.createElement("div");t.className="pa-pdesc pa-dr",t.innerHTML=Wt(this.description),i.appendChild(t)}return s.className=2===e?"ui-submit pa-pv":"pa-pv",i.appendChild(s),this.mount_at(s,n,e),i}mount_at(t,e,n){let i;i=n?this.gc.mount_edit.call(this,t,e):this.gc.mount_show.call(this,t,e),"string"==typeof i&&(t.innerHTML=i),n&&$(t).find(".need-autogrow").autogrow()}update_edit(t,e,n){const i=$(t);if(this.max){const n=t.nextSibling&&t.nextSibling.classList.contains("pa-gradeabovemax");if(!e||e<=this.max)n&&t.parentElement.removeChild(t.nextSibling);else if(!n){const e=document.createElement("div");e.classList="pa-pvnote pa-gradeabovemax",e.textContent="Grade is above max",t.parentElement.insertBefore(e,t.nextSibling)}}if(null==n.autograde||e===n.autograde)i.find(".pa-gradediffers").remove();else{const t=("late_hours"===this.key?"auto-late hours":"autograde")+" is "+this.text(n.autograde);i.find(".pa-gradediffers").length||i.append('<span class="pa-gradediffers"></span>');const e=i.find(".pa-gradediffers");e.text()!==t&&e.text(t)}if(this.gc.update_edit.call(this,t,e,n),n.reset||n.sidebar){const i=t.querySelector(".pa-gradevalue");i&&n.reset&&(a=i,s=this.simple_text(e),function(t){return"checkbox"===t.type||"radio"===t.type}(a)?(a.removeAttribute("data-default-checked"),a.defaultChecked=null!=s&&""!=s):(a.removeAttribute("data-default-value"),a.value=a.value,a.defaultValue=s)),i&&n.sidebar&&(i.tabIndex=-1,i.classList.add("uikd","pa-sidebar-tab"))}var a,s;this.landmark&&this.update_landmark(t),$(t).find("input, textarea").autogrow()}update_show(t,e,n){const i=t.classList.contains("pa-gradevalue")?t:t.querySelector(".pa-gradevalue");let a;if(this.gc.update_show)a=this.gc.update_show.call(this,i,e,n);else{const t=this.text(e);i.innerText!==t&&(i.innerText=t),a=""===t&&(!this.max||this.required)&&!this.answer}null!=a&&h(t.closest(".pa-grade"),"hidden",a),this.landmark&&this.update_landmark(t)}update_at(t,e,n){let i=t.firstChild;for(;!u(i,"pa-pv");)i=i.nextSibling;u(t,"e")?this.update_edit(i,e,n):this.update_show(i,e,n)}update_landmark(t){let e=t.closest(".pa-gradelist");if(e&&u(e,"want-landmark-links")){let e="";const n=/^(.*):(\d+)$/.exec(this.landmark);if(n&&bt.by_file(n[1])){const i=t.closest(".pa-psetinfo").getAttribute("data-pa-directory")||"",a=n[1].startsWith(i)?n[1].substring(i.length):n[1];e='@<a href="#La'.concat(n[2],"F",tt(n[1]),'">',V(a),":",n[2],"</a>")}const i=$(t).find(".pa-gradeboxref");""===e?i.remove():i.length&&i.html()===e||(i.remove(),$(t).append('<span class="pa-gradeboxref">'+e+"</span>"))}}text(t){return this.gc.text.call(this,t)}simple_text(t){return this.gc.simple_text.call(this,t)}configure_column(t,e){return this.gc.configure_column.call(this,t,e)}tcell_width(){const t=this.gc.tcell_width||3;return"function"==typeof t?t.call(this):t}tcell(t){return this.gc.tcell.call(this,t)}landmark_lines(t,e){const n=this.landmark_range?/:(\d+):(\d+)$/.exec(this.landmark_range):null;if(!n)throw new Error("bad landmark_lines");const i=+n[1];let a,s=t instanceof _t?t.element:t;for(;!u(s,"pa-filediff")&&(!(a=s.getAttribute("data-pa-landmark"))||"a"!==a.charAt(0)||parseInt(a.substring(1))>i);)s=s.parentElement;return _t.range(s,+n[1],+n[2],e)}landmark_grade(t){let e=null;for(let n of this.landmark_lines(t,".pa-gw")){const t=Ut.at(n.element);let i,a;t.text&&((i=/^[\s]*(\+)(\d+(?:\.\d+)?|\.\d+)((?![.,]\w|[\w%$*])\S*?)[.,;:]?(?:\s|$)/.exec(t.text))||(i=/^[\s]*()(\d+(?:\.\d+)?|\.\d+)(\/[\d.]+(?![.,]\w|[\w%$*\/])\S*?)[.,;:]?(?:\s|$)/.exec(t.text)))&&(null===e&&(e=0),e+=parseFloat(i[2]),a=V(this.title_text).concat(": ",V(i[1]),"<b>",V(i[2]),"</b>",V(i[3])));let s=$(n.element).find(".pa-note-gradecontrib");!s.length&&a&&(s=$('<div class="pa-note-gradecontrib"></div>').insertBefore($(n.element).find(".pa-note"))),a?s.html(a):s.remove()}this.round&&null!=e&&(e="up"===this.round?Math.ceil(e):"down"===this.round?Math.floor(e):Math.round(e));const n=t.closest(".pa-grade")||t.closest(".pa-grade-range-block");let i=$(n).find(".pa-notes-grade");if(null===e)i.remove();else{if(!i.length){(u(n,"pa-grade")?$(n):$(n).find(".pa-grade")).each((function(){let t=this.firstChild;for(;t&&!u(t,"pa-pv");)t=t.nextSibling;for(t=t.firstChild;t&&(1!==t.nodeType||u(t,"pa-gradewidth")||u(t,"pa-gradedesc"));)t=t.nextSibling;this.lastChild.insertBefore($('<a class="uic uikd pa-notes-grade" href=""></a>')[0],t)})),i=$(n).find(".pa-notes-grade")}i.text("Notes grade "+e)}return e}save_landmark_grade(t){const e=this.landmark_grade(t),n=$(t).find(".pa-gradevalue")[0];if(n){const t=null===e?"":""+e,i=$(n).val();i==n.getAttribute("data-pa-notes-grade")&&t!=i&&$(n).val(t).change(),n.setAttribute("data-pa-notes-grade",t)}return e}value_in(t){const e=t.grades?t.gpos[this.key]:null;return null!=e?t.grades[e]:null}autovalue_in(t){const e=t.autogrades?t.gpos[this.key]:null;return null!=e?t.autogrades[e]:null}gversion_in(t){const e=t.gpos[this.key];return null!=e?t.gversion[e]:null}has_newer_value_in(t){return this.answer&&t.student_grade_updates&&this.key in t.student_grade_updates&&this.value_in(t)!==t.student_grade_updates[this.key]}static closest(t){const e=t.closest(".pa-grade");return ne.closest(e).entries[e.getAttribute("data-pa-grade")]}static late_hours(){return Vt=Vt||new ee,Vt}}class ee extends te{constructor(){super({key:"late_hours",title:"late hours"}),this.normal=!1}value_in(t){return t.late_hours}autovalue_in(t){return t.auto_late_hours}}class ne{constructor(t){this.entries={},this.gversion=[],t&&this.extend(t)}extend(t,e){const n=this.value_order;let i=!1;if(t.entries)for(let e in t.entries)this.entries[e]=new te(t.entries[e]),this.entries[e]._all=this;if(!t.value_order||this.explicit_value_order&&!e||(this.value_order=t.value_order,this.explicit_value_order=!0,i=!0),!t.order||this.order&&!e||(this.order=t.order,this.explicit_value_order||(this.value_order=t.order,i=!0)),i){for(;this.gversion.length<this.value_order.length;)this.gversion.push(0);this.gpos={};for(let t=0;t<this.value_order.length;++t)this.gpos[this.value_order[t]]=t,++this.gversion[t];n&&(this.grades=this.autogrades=this.maxtotal=null)}for(t.grades&&(this.grades=this.merge_grades(this.grades,t.grades,t)),t.autogrades&&(this.autogrades=this.merge_grades(this.autogrades,t.autogrades,t)),t.student_grade_updates&&(this.student_grade_updates=t.student_grade_updates);this.grades&&this.gversion.length<this.grades.length;)this.gversion.push(0);for(let e in t)Qt[e]&&(this[e]=t[e])}merge_grades(t,e,n){let i=n.value_order||n.order||this.value_order;if(t||i!==this.value_order){t=t||[];for(let n in i){const a=this.gpos[i[n]];if(null!=a){for(;t.length<=a;)t.push(null);t[a]!=e[n]&&(t[a]=e[n],++this.gversion[a])}}return t}return e}xentry(t){const e=this.entries[t];return e||("late_hours"===t?te.late_hours():null)}remount_at(t,e){const n=this.xentry(t.getAttribute("data-pa-grade"));if(n){let i,a=t.firstChild;for(;!u(a,"pa-pv");)"LABEL"===a.tagName&&(i=a.htmlFor),a=a.nextSibling;for(;a.nextSibling;)t.removeChild(a.nextSibling);"boolean"==typeof e&&(e=e?2:0);const s=document.createElement(2===e?"form":"div");s.className=2===e?"ui-submit pa-pv":"pa-pv",h(t,"e",0!==e),t.replaceChild(s,a),2===e&&d(t,"hidden"),n.mount_at(s,i,0!==e),t.removeAttribute("data-pa-gv"),$(a).find("input, textarea").unautogrow()}}update_at(t,e){const n=this.xentry(t.getAttribute("data-pa-grade"));let i;if(n&&(null===(i=n.gversion_in(this))||t.getAttribute("data-pa-gv")!=i)){const a={gradesheet:this,autograde:n.autovalue_in(this)};let s=n.value_in(this);if(e&&Object.assign(a,e),n.has_newer_value_in(this)){const e=t.firstChild;e.classList.contains("pa-is-grade-update")?s=this.student_grade_updates[n.key]:e.classList.contains("uic")||(e.classList.add("pa-has-grade-update","uic","need-tooltip"),e.setAttribute("aria-label","Toggle latest version"))}null!==i&&t.setAttribute("data-pa-gv",i),n.update_at(t,s,a)}}grade_total(t){let e=0;for(let n=0;n!==this.value_order.length;++n){const i=this.entries[this.value_order[n]];!i||!i.in_total||t&&i.is_extra||(e+=this.grades&&this.grades[n]||0)}return Math.round(1e3*e)/1e3}get grade_maxtotal(){if(null==this.maxtotal){let t=0;for(let e=0;e!==this.value_order.length;++e){const n=this.entries[this.value_order[e]];n&&n.in_total&&!n.is_extra&&n.max&&(!n.required||this.scores_editable||this.grades&&null!==this.grades[e])&&(t+=n.max)}this.maxtotal=Math.round(1e3*t)/1e3}return this.maxtotal}file_anchor(t){return u(document.body,"pa-multiuser")?"U".concat(tt(this.user),"/F",tt(t)):"F"+tt(t)}get has_sections(){for(let t=0;t!==this.order.length;++t){if("section"===this.entries[this.order[t]].type)return!0}return!1}has(t){for(let e=0;e!==this.value_order.length;++e){if(t(this.entries[this.value_order[e]],this))return!0}return!1}section_has(t,e){let n=this.gpos[t.key];for(;null!=n&&n<this.value_order.length;){const i=this.entries[this.value_order[n]];if(i!==t&&"section"===i.type)break;if(e(i,this))return!0;++n}return!1}section_wants_sidebar(t){let e=0;return this.scores_editable&&this.section_has(t,(t=>(e|=t.answer?1:2,3===e)))}static parse_json(t){return new ne(JSON.parse(t))}static store(t,e){let n=$(t).data("pa-gradeinfo");n||(n=new ne,n.element=t,$(t).data("pa-gradeinfo",n)),n.extend(e,!t.classList.contains("pa-psetinfo-partial")),window.$pa.loadgrades.call(t)}static closest(t){let e=t.closest(".pa-psetinfo"),n=null;for(;e;){let t=$(e).data("pa-gradeinfo");if(t)if(n)n.extend(t);else{if(t instanceof ne){n=t;break}n=new ne(t),n.element=e,$(e).data("pa-gradeinfo",n)}if(n&&!u(e,"pa-psetinfo-partial"))break;e=e.parentElement.closest(".pa-psetinfo")}return n}}let ie,ae,se,re,oe;function le(t,e,n){t.removeClass("hidden").addClass("editing");var i=t.find(".pa-notebox");if(n){t.css("display","").children().css("display","");var a=i.children();a.slideUp(80).queue((function(){a.remove()}))}let s=ne.closest(ie.element),r=e?e.format:null;null==r&&(r=document.body.getAttribute("data-default-format"));let o='<form method="post" action="'.concat(V(L("=api/linenote",{psetinfo:s.element,file:ie.file,line:ie.note_lineid,oldversion:e&&e.version||0,format:r})),'" enctype="multipart/form-data" accept-charset="UTF-8" class="ui-submit pa-noteform">','<textarea class="pa-note-entry need-autogrow" name="note"></textarea>','<div class="aab aabr pa-note-aa justify-content-between">','<div class="aabutr order-100"><button class="btn-primary" type="submit">Save comment</button></div>','<div class="aabutr order-99"><button type="button" name="cancel">Cancel</button></div>','<div class="aabut"><button type="button" class="btn ui pa-load-note-suggestions"></button></div>');s.user_scores_visible||(o+='<div class="aabut"><label class="checki"><input type="checkbox" name="iscomment" value="1" class="checkc">Show immediately</label></div>'),o+='<div class="aabut flex-grow-1"></div>';var l=$(o+"</div></form>").appendTo(i),c=l.find("textarea");if(e&&null!==e.ftext){const t=e.editable_text;c.text(t),c[0].setSelectionRange&&c[0].setSelectionRange(t.length,t.length)}c.autogrow().keydown(ge),l.find("input[name=iscomment]").prop("checked",!(!e||!e.iscomment)),l.find("button[name=cancel]").click(fe),l.on("submit",(function(){!function(t){if(!u(t,"pa-gw"))throw new Error("bad `elt` in pa_save_my_note");if(!u(t,"pa-outstanding")){const e=$(t).find("form")[0],n=e.elements.note.value,i=e.elements.iscomment&&e.elements.iscomment.checked;$(e).find(".pa-save-message").remove(),$(e).find(".aab").append('<div class="aabut pa-save-message">Saving</div>'),Ut.at(t).save_text(n,i).then((()=>{const t=ie?ie.visible_source():null;t&&de(t.element,!0)}))}}(this.closest(".pa-dl"))})),n&&(c.focus(),l.hide().slideDown(100))}function ue(t){t&&null!=t.screenX&&(oe=t.timeStamp,se=t.screenX,re=t.screenY)}function ce(t){let e,n;if("mousemove"===t.type&&oe&&(Math.abs(t.screenX-se)<=1&&Math.abs(t.screenY-re)<=1||t.timeStamp-oe<=500)||("keydown"===t.type||"keyup"===t.type)&&A.is_modifier(t))return;if("keydown"!==t.type||"ArrowUp"!==(e=A(t))&&"ArrowDown"!==e&&"Enter"!==e||(n=C(t))&&(n!==C.META||"Enter"!==e)||!ie)return he();let i=ie.visible_source();if(i&&("ArrowDown"===e||"ArrowUp"===e)){d(i.element,"live");let t=i;const n=_t.ANYFILE+("ArrowDown"===e?0:_t.BACKWARD);i=null;for(let e of _t.all(t,n))if(e.element!==t.element&&e.is_visible()&&e.is_source()){i=e;break}}if(i){if(ie=i,t.preventDefault(),ue(t),"Enter"===e)be();else{const t=i.element.closest(".pa-with-fixed");$(i.element).addClass("live").scrollIntoView(t?{marginTop:t.firstChild.offsetHeight}:null)}return!0}return he()}function de(t,e){u(t,"pa-gw")||c(t,"live"),$(".pa-filediff").removeClass("live"),$(document).off(".pa-linenote"),$(document).on((e?"keydown.pa-linenote ":"")+"mousemove.pa-linenote mousedown.pa-linenote",ce)}function he(){$(".pa-dl.live").removeClass("live"),$(".pa-filediff").addClass("live"),$(document).off(".pa-linenote")}function pe(t){const e=t.render(!0),n=ie&&ie.visible_source();return n&&de(n.element,!0),e}function fe(){return pe(Ut.closest(this).cancel_edit()),!0}function ge(t){return!("Escape"===A(t)&&!C(t)&&pe(Ut.closest(this)))&&("Enter"!==A(t)||C(t)!==C.META||($(this).closest("form").submit(),!1))}function me(t,e){return t*t+e*e<144}function be(t){const e=Ut.near(ie),n=e.force_element();if(ue(t),u(n,"editing")){if(pe(e))return t&&t.stopPropagation(),!0;var i=$(n).find("textarea").focus();return i[0].setSelectionRange&&i[0].setSelectionRange(0,i.val().length),!1}return le($(n),e,!0),de(ie.element,!1),!1}function _e(t){const e=siteinfo.user.cid;return t.like&&t.like.indexOf(e)>=0?1:t.dislike&&t.dislike.indexOf(e)>=0?-1:0}function ve(t,e){let n=$(t).data("paNoteSuggestionIndex")||0;!function(t,e){let n=$(t).find(".pa-note-suggestions");if(!n.length){const e=document.createElement("div"),i=document.createElement("input");e.className="pa-note-suggestions mt-4",i.type="search",i.className="uikd uii pa-search-suggestions mb-3",i.placeholder="Search",e.append(i),$(e).insertBefore($(t).find(".pa-note-aa")),n=$(e)}for(const t of e){const e=_e(t),i=document.createElement("div"),a=(t.like||[]).length-(t.dislike||[]).length;i.className="pa-note-suggestion".concat(e<0||0===e&&a<0?" dim":""),i.setAttribute("data-content",t.ftext),n[0].appendChild(i);const s=document.createElement("div"),r=document.createElement("button"),o=document.createElement("button"),l=document.createElement("div");s.className="btnbox small",s.append(r,o),l.className="flex-grow-1",i.append(s,l),r.type=o.type="button",r.className="ui pa-use-suggestion like".concat(e>0?" taken":""),r.setAttribute("aria-label","Use"),r.textContent="",o.className="ui pa-use-suggestion dislike".concat(e<0?" taken":""),o.setAttribute("aria-label","Downrank"),o.textContent="",qt.render(t.ftext,l),gt.call(r),gt.call(o)}}(t,e.slice(n,e.length)),$(t).data("paNoteSuggestionIndex",e.length).find(".pa-load-note-suggestions").prop("disabled",!0)}function xe(t,e){const n=_t.closest(t);$.ajax(L("=api/linenotemark",{file:n.file,linea:n.linea,mark:e,pset:n.pset}),{data:{ftext:t.getAttribute("data-content")},method:"POST"})}b.on("pa-editablenotes",(function(t){var e=t.target.closest(".pa-dl");if(0===t.button&&e&&!u(e,"pa-gx")&&!t.target.matches("button, a, textarea")&&!t.target.closest(".pa-note-suggestions")){var n=function(t){for(;t&&"TEXTAREA"!==t.tagName&&"A"!==t.tagName;){if(u(t,"pa-dl")){for(let e of _t.all(t)){if(e.is_note())return e;if(e.element!==t&&e.is_visible()&&!e.is_annotation())break}return new _t(t)}t=t.parentElement}return null}(t.target),i=(new Date).getTime();"mousedown"===t.type&&n?ie&&ie.element===n.element&&ae&&me(ae[0]-t.clientX,ae[1]-t.clientY)&&i-ae[2]<=500||(ie=n,ae=[t.clientX,t.clientY,i,!1]):"mouseup"===t.type&&n?ie&&ie.element===n.element&&ae&&me(ae[0]-t.clientX,ae[1]-t.clientY)&&!ae[3]&&(ie=n,ae[3]=!0,be(t)):"click"===t.type&&n?(ie=n,be(t)):ie=ae=null}})),b.on("pa-load-note-suggestions",(function(){const t=this.closest("form");let e=$(t).data("paNoteSuggestions");if(e)ve(t,e);else{const n=_t.closest(this),i={file:n.file,pset:n.pset},a=ne.closest(this);if(a&&a.base_commit&&!a.base_handout){if(a.user&&a.commit){let t=n.lineb;null!==t&&(i.u=a.user,i.line="b"+t,i.commit=a.commit)}}else i.linea=n.linea;this.disabled=!0,$.ajax(L("api/linenotesuggest",i),{success:function(n){if(n.ok){e=n.notelist||[];for(const t of e){const e=_e(t),n=(t.like||[]).length-(t.dislike||[]).length;t.status=e>0&&n>1?3:e>0?2:0===e&&n>0?1:0===e&&0===n?0:-1===e&&n>=0?-1:-2}e.sort((n.linea,function(t,e){if(t.status!==e.status)return t.status>e.status?-1:1;if(t.ftext.substring(0,3)===e.ftext.substring(0,3))return t.ftext.localeCompare(e.ftext);{const n=qt.parse(t.ftext),i=qt.parse(e.ftext);return n.localeString(i)}})),$(t).data("paNoteSuggestions",e),ve(t,e)}}})}})),b.on("pa-use-suggestion",(function(){const t=this.closest(".pa-note-suggestion"),e=t.closest("form");this.classList.contains("like")?(xe(t,"like"),e.elements.note.value=qt.parse(t.getAttribute("data-content"))[1]):(xe(t,"dislike"),t.remove())})),b.on("pa-search-suggestions",(function(t){if("input"===t.type){const t=this.closest(".pa-note-suggestions");let e="";for(const t of this.value.split(/\s+/))""!==t&&(e=e.concat("(?=.*",String(t).replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g,"\\$1").replace(/\x08/g,"\\x08"),")"));const n=e?new RegExp(e,"i"):null;for(let e=t.firstChild;e;e=e.nextSibling)if(e.classList.contains("pa-note-suggestion")){const t=n&&!n.test(e.getAttribute("data-content"));e.classList.toggle("hidden",t)}}else"keydown"!==t.type||C(t)&(C.SHIFT|C.ALT)||"Enter"!==A(t)||t.preventDefault()}));const ye={0:!1,1:{b:!0},2:{f:!0},3:{i:!0},4:{u:!0},5:{bl:!0},7:{rv:!0},8:{x:!0},9:{s:!0},21:{du:!0},22:{b:!1,f:!1},23:{i:!1},24:{u:!1},25:{bl:!1},27:{rv:!1},28:{x:!1},29:{s:!1},30:{fg:0},31:{fg:1},32:{fg:2},33:{fg:3},34:{fg:4},35:{fg:5},36:{fg:6},37:{fg:7},38:"fg",39:{fg:!1},40:{bg:0},41:{bg:1},42:{bg:2},43:{bg:3},44:{bg:4},45:{bg:5},46:{bg:6},47:{bg:7},48:"bg",49:{bg:!1},90:{fg:8},91:{fg:9},92:{fg:10},93:{fg:11},94:{fg:12},95:{fg:13},96:{fg:14},97:{fg:15},100:{bg:8},101:{bg:9},102:{bg:10},103:{bg:11},104:{bg:12},105:{bg:13},106:{bg:14},107:{bg:15}},we={b:1,f:2,i:3,u:4,bl:5,rv:7,x:8,s:9,du:21};function ke(t,e){if(1===arguments.length&&(e=t,t=null),!e||"[m"===e||"[0m"===e)return null;let n;n=""===e.charAt(0)?e.substring(2,e.length-1).split(";"):e.split(";");for(let e=0;e<n.length;++e){const i=ye[parseInt(n[e])];if(!1===i)t=null;else if(i){if("object"==typeof i)for(let e in i)!1!==i[e]?(t=t||{})[e]=i[e]:t&&delete t[e];else if("fg"===i||"bg"===i){let a,s,r;if(t=t||{},e+4<n.length&&2===parseInt(n[e+1]))a=parseInt(n[e+2]),s=parseInt(n[e+3]),r=parseInt(n[e+4]),a<=255&&s<=255&&r<=255&&(t[i]=[a,s,r]);else if(e+2<n.length&&5===parseInt(n[e+1])){const o=parseInt(n[e+1]);o<=15?t[i]=o:o<=231?(r=(o-16)%6,s=(o-16-r)/6%6,a=(o-16-r-6*s)/36,t[i]=[51*a,51*s,51*r]):o<=255&&(r=Math.round(255*(o-232)/23),t[i]=[r,r,r])}}}else;}return t&&$.isEmptyObject(t)?null:t}function Ae(t,e){return/^\x1b\[[\d;]*m$/.test(e)?function(t){if(!t)return"[m";const e=[];for(let n in we)t[n]&&e.push(we[n]);return t.fg&&("number"==typeof t.fg?e.push(t.fg<8?30+t.fg:90+t.fg-8):e.push(38,2,t.fg[0],t.fg[1],t.fg[2])),t.bg&&("number"==typeof t.bg?e.push(t.bg<8?40+t.bg:100+t.bg-8):e.push(48,2,t.bg[0],t.bg[1],t.bg[2])),"["+e.join(";")+"m"}(ke(ke(null,t),e)):t}function Ce(t,n,i){var a=!1;if("string"==typeof t&&(i=n,n=t,t=document.createElement("div"),a=!0),i&&i.clear)for(t.removeAttribute("data-pa-terminal-style"),t.removeAttribute("data-pa-outputpart");t.firstChild;)t.removeChild(t.firstChild);var s,r,o=t.getAttribute("data-pa-terminal-style"),l=null;function c(t,n){t.appendChild(function(t,n){if("string"==typeof t?t=document.createTextNode(t):t instanceof jQuery&&(t=t[0]),!n||"[m"===n||"string"==typeof n&&!(n=ke(n)))return t;const i=document.createElement("span"),a=[];for(let t in we)n[t]&&a.push("ansi"+t);return n.fg&&("number"==typeof n.fg?a.push("ansifg"+n.fg):i.styles.foregroundColor=e("#%02x%02x%02x",n.fg[0],n.fg[1],n.fg[2])),n.bg&&("number"==typeof n.bg?a.push("ansibg"+n.bg):i.styles.backgroundColor=e("#%02x%02x%02x",n.bg[0],n.bg[1],n.bg[2])),a.length&&(i.className=a.join(" ")),i.appendChild(t),i}(n,o))}function d(t){l||(l=document.createDocumentFragment()),l.appendChild(t)}function h(t,e){var n,a,s=!e,r=0;for(s&&(e=document.createElement("span")),/\r/.test(t)&&(t=function(t){var e=/\n$/.test(t);if(e&&t.indexOf("\r")===t.length-1)return t.substring(0,t.length-2)+"\n";var n=o||"[m",i=(e?t.substr(0,t.length-1):t).split(/\r/),a=[];for(let t=0;t<i.length;++t){for(var s=[],r=0,l=null,u=i[t].split(/(\x1b\[[\d;]*m|\x1b\[0?K)/),c=0;c<u.length;c+=2)""!==u[c]&&(s.push(n,u[c]),r+=u[c].length),c+1<u.length&&(u[c+1].endsWith("K")?l=r:n=Ae(n,u[c+1]));for(var d=0;d<a.length&&r>=a[d+1].length;)r-=a[d+1].length,d+=2;for(;d<a.length&&r<a[d+1].length&&null===l;)s.push(a[d],a[d+1].substr(r)),r=0,d+=2;a=s}return a.push(n),e&&a.push("\n"),a.join("")}(t));n=t.match(/^(\x1b\[[\d;]*m|\x1b\[\d*K)([^]*)$/);)o=Ae(o,n[1]),t=n[2];for(((n=t.match(/^([ \t]*)([^:\s]+):(\d+)(?=:)/))||(n=t.match(/^([ \t]*)file \"(.*?)\", line (\d+)/i)))&&function(t,e,n,a,s){let r;for(;r=n.match(/^(\x1b\[[\d;]*m|\x1b\[\d*K)([^]*)$/);)o=Ae(o,r[1]),n=r[2];let l=bt.by_file(n);if(!l&&i&&i.directory&&(n=i.directory+n,l=bt.by_file(n)),l){e.length&&c(t,e);var u=l.lineid_anchor("b"+a),d=$('<a href="#'.concat(u,'" class="u pa-goto"></a>'));return d.text(s.substring(e.length).replace(/(?:\x1b\[[\d;]*m|\x1b\[\d*K)/g,"")),c(t,d),!0}return!1}(e,n[1],n[2],n[3],n[0])&&(r=n[0].length,t=t.substr(r));""!==t;){if(a=t,n=t.match(/^(.*?)(\x1b\[[\d;]*m|\x1b\[\d*K)([^]*)$/)){if(""===n[1]){o=Ae(o,n[2]),t=n[3];continue}a=n[1]}r+a.length>133||r+a.length==133&&"\n"!==a.charAt(132)?(c(e,a=a.substr(0,132-r)),e.className="pa-rl-continues",s&&d(e),e=document.createElement("span"),s=!0,r=0):(c(e,a),r+=a.length),t=t.substr(a.length)}s&&d(e)}"string"==typeof n?((s=n.split(/^/m)).length&&""===s[s.length-1]&&s.pop(),r=s.length&&s[s.length-1].endsWith("\n")):(s=[],r=!0,l=n);var p=t.lastChild,f=null;if(p&&p.lastChild&&u(p.lastChild,"pa-runcursor")&&(f=p.lastChild,p.removeChild(f)),p&&null!==(n=p.getAttribute("data-pa-outputpart"))&&""!==n&&s.length){for(;p.firstChild;)p.removeChild(p.firstChild);s[0]=n+s[0],p.removeAttribute("data-pa-outputpart")}else p&&(s.length||l)&&(p.appendChild(document.createTextNode("\n")),p.removeAttribute("data-pa-outputpart")),p=null;var g,m,b,_=o;for(g=0;g<s.length;g=m){for(_=o,b=s[g],m=g+1;!b.endsWith("\n")&&m<s.length;++m)b+=s[m];m==s.length&&r&&(b=b.substring(0,b.length-1)),h(b,g?null:p)}i&&i.cursor&&!t.lastChild&&!l&&d(""),l&&t.appendChild(l);var v=t.childNodes.length;if(v>=4e3){for(g=t.firstChild;"DIV"===g.tagName&&"pa-rl-group"===g.className;)g=g.nextSibling,--v;for(var x=null,y=0;g&&(m=g.nextSibling);)(!x||y>=4e3&&v>=2e3)&&((x=document.createElement("div")).className="pa-rl-group",t.insertBefore(x,g),y=0),t.removeChild(g),x.appendChild(g),g=m,++y,--v}if(i&&i.cursor&&(f||((f=document.createElement("span")).className="pa-runcursor"),t.lastChild.appendChild(f)),!r&&t.lastChild&&(o=_,t.lastChild.setAttribute("data-pa-outputpart",b)),null!=o?t.setAttribute("data-pa-terminal-style",o):t.removeAttribute("data-pa-terminal-style"),a)return t.innerHTML}function $e(){const t=this.closest(".pa-grade");t.removeAttribute("data-pa-gv"),this.classList.toggle("pa-has-grade-update"),this.classList.toggle("pa-is-grade-update"),ne.closest(this).update_at(t)}function Ee(n,i){const a=$(n).closest("form"),r=n.getAttribute("data-pa-run-category")||n.value,o=$(n).closest(".pa-psetinfo").attr("data-pa-directory"),l=document.getElementById("pa-run-"+r),h=l.closest(".pa-runout"),p=$(l).find("pre");let f,g,m,b=i.queueid||null;if(h&&d(h,"hidden"),v(l,h,!0),i.unfold&&l.dataset.paTimestamp?g=+l.dataset.paTimestamp:i.timestamp&&(g=i.timestamp),u(a[0],"pa-run-active"))return!0;if(a.find("button").prop("disabled",!0),delete l.dataset.paTimestamp,c(a[0],"pa-run-active"),g||i.noclear?l.lastChild&&$(l.lastChild).find("span.pa-runcursor").remove():(p.html(""),c(p[0].parentElement,"pa-run-short"),p[0].removeAttribute("data-pa-terminal-style"),$(l).children(".pa-runrange").remove()),l.dataset.paXtermJs&&"false"!==l.dataset.paXtermJs&&window.Terminal){d(p[0].parentElement,"pa-run-short"),c(p[0].parentElement,"pa-run-xterm-js");const t=+l.getAttribute("data-pa-columns"),e=+l.getAttribute("data-pa-rows"),n=+l.getAttribute("data-pa-font-size"),a={cols:!t||t<0||t!=t?function(t,e){const n=$('<span style="position:absolute">0</span>').appendTo(p),i=Math.trunc(p.width()/n.width()/1.33);return n.remove(),Math.max(t,Math.min(i,e))}(80,132):t,rows:!e||e<0||e!=e?25:e};n&&n>0&&n==n&&(a.fontSize=n),f=new Terminal(a),f.open(p[0]),f.attachCustomKeyEventHandler(function(t){return function(e){if("keydown"===e.type){let n=A(e),i=C(e);if(1===n.length)if(0==(14&i)&&A.printable(e));else if((14&i)===C.CTRL&&n>="a"&&n<="z")n=String.fromCharCode(n.charCodeAt(0)-96);else{if((14&i)===C.META&&"v"==n)return navigator.clipboard.readText().then((e=>t(e))),void e.preventDefault();n=""}else n="Enter"!==n||i?"Escape"!==n||i?"Backspace"!==n||i?"Tab"!==n||i?"ArrowUp"!==n||i?"ArrowDown"!==n||i?"ArrowRight"!==n||i?"ArrowLeft"!==n||i?"":"[D":"[C":"[B":"[A":"\t":"":"":"\r";""!==n&&(t(n),e.preventDefault())}return!1}}((function(t){B({write:t})}))),i.focus&&f.focus()}function _(){f||!u(l,"pa-run-short")&&!l.hasAttribute("data-pa-runbottom")||requestAnimationFrame((function(){l.scrollHeight>l.clientHeight&&d(l,"pa-run-short"),l.hasAttribute("data-pa-runbottom")&&(l.scrollTop=Math.max(l.scrollHeight-l.clientHeight,0))}))}l.hasAttribute("data-pa-opened")||(l.setAttribute("data-pa-opened","true"),f||(l.setAttribute("data-pa-runbottom","true"),l.addEventListener("scroll",(function(){requestAnimationFrame((function(){l.scrollTop+l.clientHeight>=l.scrollHeight-10?l.setAttribute("data-pa-runbottom","true"):l.removeAttribute("data-pa-runbottom")}))})),_()));let x="",y=-1,w=50,k=null;function E(){f?f.write("[?25l"):l.lastChild&&$(l.lastChild).find(".pa-runcursor").remove()}function S(t){var e;u(a[0],"pa-run-active")&&(d(a[0],"pa-run-active"),a.find("button").prop("disabled",!1)),!1!==t&&(E(),n.hasAttribute("data-pa-run-grade")&&W(L("api/grade",{psetinfo:e=n.closest(".pa-psetinfo")}),null,"GET").then((function(t){t&&t.ok&&ne.store(e,t)})),i.done_function&&i.done_function())}function D(t,e){f?f.write(t,e):(Ce(p[0],t,{cursor:!0,directory:o}),e&&Promise.resolve(!0).then(e))}function M(t){"string"==typeof t&&(t=$(t)[0]),f?window.console&&console.log("xterm.js cannot render "+t):Ce(p[0],t,{cursor:!0})}function F(t,e,n){if(null!==x){x+=t;var a=x.indexOf("\n\n");if(a<0)return;t=x.substr(a+2),x=null;var r="";e&&e.timestamp&&(r="...started "+s("%l:%M:%S%P %e %b %Y",new Date(1e3*e.timestamp))),f?(""!==r&&(r="[3;1;38;5;86m"+r+"[m\r\n"),i.noclear||(r="c"+r),t=r+t):(i.noclear||p.html(""),""!==r&&M('<span class="pa-runtime">'+r+"</span>"))}""!==t&&D(t,n)}function T(n,i){let a,s,o,h,p,f,g,m,b,v,y,w=0;if(!k){if(0!==n.offset)throw new Error("fuck");{const e=t.site_json(!1,"pa-runspeed-"+r);v=n.time_factor,e&&e[1]>=(new Date).getTime()-864e5?v=e[0]:e&&t.site_json(!1,"pa-runspeed-"+r,null),(v<.1||v>10)&&(v=1)}k=n.time_data,"string"==typeof k&&(k=function(t){let e=[0,0],n=0;for(;n<t.length;){const i=t.indexOf(",",n);if(i<0)break;let a=t.indexOf("\n",i+1);a<0&&(a=t.length),e.push(+t.substring(n,i),+t.substring(i+1,a)),n=a+1}return e}(k)),k.length>2&&(a=$('<div class="pa-runrange"><button type="button" class="pa-runrange-play"></button><input type="range" class="pa-runrange-range" min="0" max="'+k[k.length-2]+'"><span class="pa-runrange-time"></span><span class="pa-runrange-speed-slow" title="Slow"></span><input type="range" class="pa-runrange-speed" min="0.1" max="10" step="0.1"><span class="pa-runrange-speed-fast" title="Fast"></span></div>').prependTo(l),s=a[0].lastChild,o=a[0].firstChild,a=o.nextSibling,s=a.nextSibling,h=s.nextSibling.nextSibling,a.addEventListener("input",(function(){b=!1,c(o,"paused"),S(+this.value)}),!1),o.addEventListener("click",(function(){u(o,"paused")?(d(o,"paused"),b=!0,f=(new Date).getTime(),g<k[k.length-2]&&(f-=g/v),S(null)):(c(o,"paused"),b=!1)}),!1),h.addEventListener("input",(function(){v=+this.value,t.site(!1,"pa-runspeed-"+r,[v,(new Date).getTime()]),b&&(f=(new Date).getTime()-g/v,S(null))}),!1),h.value=v),n={data:n.data,end_offset:n.end_offset,size:n.size||n.end_offset,timestamp:n.timestamp},i?(p=k.length,g=k[p-2],b=!1,o&&c(o,"paused"),A()):(p=0,g=0,f=(new Date).getTime(),b=!0,k.length&&S(null))}function A(){a&&(a.value=g,s.innerHTML=e("%d:%02d.%03d",Math.trunc(g/6e4),Math.trunc(g/1e3)%60,Math.trunc(g)%1e3))}function C(){w||(w=!0,B({offset:n.end_offset},(function(t){t.ok&&t.offset===n.end_offset?(n.data+=t.data,n.end_offset=t.end_offset):t.ok||(n.size=n.end_offset),w=!1,y&&S(y)})))}function S(t){if(null===t){if(!b)return;t=((new Date).getTime()-f)*v}let e=p;if((e>=k.length||t<k[e])&&(e=0),e+2<k.length&&t>=k[e]){let n=k.length;for(;e<n;){const i=e+(n-e>>1&-2);t<=k[i]?n=i:e=i+2}}for(;e<k.length&&t>=k[e];)e+=2;e<p&&(x="",p=0);let i=p<k.length?k[p+1]:n.size;const a=8<<20;let s=e<k.length?k[e+1]:n.size;if(i+a<s){let t=p;for(;t<e;){const n=t+(e-t>>1&-2);i+a<k[n+1]?(e=n,s=k[n+1]):t=n+2}}if(n.end_offset<n.size){if(s>n.end_offset)return y=t,void C();s>n.end_offset-(1<<20)&&C()}if(g=e<k.length?Math.min(t,k[e]):t,y=t>g?t:null,y){const t=Math.min(i+(4<<20),s);F(n.data.substring(i,t),n,(()=>{S(y)})),i=t}F(n.data.substring(i,s),n),_(),A(),p=e,m&&(m=clearTimeout(m)),b&&!y&&(p<k.length?m=setTimeout(S,Math.min(100,(k[p]-(p?k[p-2]:0))/v),null):(o&&c(o,"paused"),E()))}}let N=0,j={};function z(t){var e,n;if(b&&p.find("span.pa-runqueue").remove(),t&&t.onqueue)return b=t.queueid,n="On queue, "+t.nahead+(1==t.nahead?" job":" jobs")+" ahead",t.headage&&(n+=", oldest began about "+(e=t.headage<10?t.headage:5*Math.round(t.headage/5+.5))+(1==e?" second":" seconds")+" ago"),p[0].insertBefore($("<span class='pa-runqueue'>"+n+"</span>")[0],p[0].lastChild),void setTimeout(B,1e4);if(function(t){const e=h?h.firstChild:null;if(e&&"H3"===e.tagName){const n=$(e).find(".pa-runstop");t&&!n.length?$('<button class="btn btn-danger pa-runstop" type="button">Stop</button>').click(I).appendTo(e):!t&&n.length&&n.remove()}}(t&&("working"===t.status||"workingconflict"===t.status)),!t||!t.ok)return e="Unknown error",t&&t.loggedout?e="You have been logged out (perhaps due to inactivity). Please reload this page.":t&&(t.error_text?e=t.error_text:t.error&&!0!==t.error?e=t.error:t.message&&(e=t.message),1001===t.errorcode&&t.conflict_timestamp&&(m=t.conflict_timestamp)),D("[1;3;31m"+e+"[m\r\n"),_(),S();for(t.done&&S(!1),g=g||t.timestamp;t.data&&t.offset<y;){let e=t.data.match(/^([\x00-\x7F]*)([\u0080-\u07FF]*)([\u0800-\uD7FF\uE000-\uFFFF]*)((?:[\uD800-\uDBFF][\uDC00-\uDFFF])*)/);if(!e)return void setTimeout(B,0);let n=0;if(e[1].length){const i=Math.min(y-t.offset,e[1].length);n+=i,t.offset+=i}if(e[2].length){const i=Math.min(y-t.offset,2*e[2].length);n+=i/2,t.offset+=i}if(e[3].length){const i=Math.min(y-t.offset,3*e[3].length);n+=i/3,t.offset+=i}if(e[4].length){const i=Math.min(y-t.offset,4*e[4].length);n+=i/2,t.offset+=i}t.data=t.data.substring(n)}if(t.data&&!t.partial&&t.done&&(e=t.data.match(/\x1b\[\?1049l(?:[\r\n]|\x1b\[\?1l|\x1b>)*$/))&&(t.data=t.data.substring(0,t.data.length-e[0].length)),null!=t.data){if(y=t.end_offset>t.offset&&t.end_offset>=t.offset+t.data.length?t.end_offset:t.offset+t.data.length,t.done&&null!=t.time_data&&""===x)return void T(t);F(t.data,t),w=100}t.result&&(null!==x&&F("\n\n",t),F(t.result,t)),t.data||t.result||(w=Math.min(2*w,500)),_(),"old"==t.status?setTimeout(B,2e3):!t.done||t.partial?setTimeout(B,w):(S(),t.timed&&!u(l.firstChild,"pa-runrange")&&B({offset:0},O))}function O(t){--N,t.data&&t.done&&null!=t.time_data&&T(t,!0)}function B(t,e){if(t&&t.stop&&(j.stop=1),t&&t.write&&(j.write=(j.write||"").concat(t.write)),j.write&&N>0)return;let n={};a[0].run||(n.run=r),n.offset=y,t&&null!=t.offset&&(n.offset=t.offset),g?n.check=g:t&&t.stop&&m&&(n.check=m),b&&(n.queueid=b),Object.assign(n,j),delete j.write,delete j.stop,++N,jQuery.ajax(a.attr("action"),{data:a.serializeWith(n),type:"POST",cache:!1,dataType:"json",timeout:3e4,success:function(t){--N,(e||z)(t),j.write&&B({})},error:function(){a.find(".ajaxsave61").html("Failed"),d(a[0],"pa-run-active")}})}function I(){B({stop:1})}return i.headline&&i.noclear&&!f&&p[0].firstChild&&D("\n\n"),i.headline&&i.headline instanceof Node?M(i.headline):i.headline&&D("[1;37m"+i.headline+"[m\n"),i.unfold&&l.getAttribute("data-pa-content")&&D(l.getAttribute("data-pa-content")),i.focus&&$(h).scrollIntoView(),l.removeAttribute("data-pa-content"),_(),B(),!1}function Se(t,e){for(var n=$("#pa-runsettings"),i=n.find(".n").length;n.find("[data-runsetting-num="+i+"]").length;)++i;var a=$('<div class="pa-p" data-runsetting-num="'+i+'"><div class="pa-pt"></div><div class="pa-pv"><input name="n'+i+'" class="uich pa-runconfig ignore-diff n" size="30" placeholder="Name"> &nbsp; <input name="v'+i+'" class="uich pa-runconfig ignore-diff v" size="40" placeholder="Value"></div></div>');t&&(a.find(".n").val(t),a.find(".v").val(e)),n.append(a),t||a.find(".n").focus()}function De(t,e,n){!e&&t instanceof Error?t={error:(e=t).toString()}:"string"==typeof t&&(t={error:t}),e&&e.fileName&&!t.url&&(t.url=e.fileName),e&&e.lineNumber&&!t.lineno&&(t.lineno=e.lineNumber),e&&e.columnNumber&&!t.colno&&(t.colno=e.columnNumber),e&&e.stack&&(t.stack=e.stack),$.ajax(L("=api/jserror"),{global:!1,method:"POST",cache:!1,data:t}),e&&!n&&"object"==typeof console&&console.error&&console.error(t.error)}It.add_format({format:2,render:function(t){return Ce(t)}}),b.on("pa-has-grade-update",$e),b.on("pa-is-grade-update",$e),b.on("pa-runner",(function(){Ee(this,{focus:!0})})),b.on("pa-run-show",(function(){const t=this.closest(".pa-runout").id.substring(4),e=document.getElementById("pa-run-"+t);if(e.dataset.paTimestamp&&!$(e).is(":visible")){Ee(jQuery(".pa-runner[value='"+t+"']")[0],{unfold:!0})}else v(e,jQuery("#run-"+t))})),b.on("pa-runconfig",(function(){"define"===this.name?Se():function(){var t,e,n,i=$("#pa-runsettings .pa-p"),a={};for(t=0;t!=i.length;++t)e=$.trim($(i[t]).find(".n").val()),n=$.trim($(i[t]).find(".v").val()),""!=e&&(a[e]=n);$.ajax(i.closest("form").attr("action"),{data:{runsettings:a},type:"POST",cache:!1,dataType:"json"})}()}));let Me=window.onerror,Fe=0;function Te(t){var e,n,i=0,a=this.getTotalLength();if(i!=a){for(;a-i>.5;)if(e=i+(a-i)/2,(n=this.getPointAtLength(e)).x>=t+.25)a=e;else{if(n.x>=t-.25)return n.y;i=e}if((n=this.getPointAtLength(a===e?i:a)).x>=t-.25&&n.x<=t+.25)return n.y}return null}window.onerror=function(t,e,n,i,a){if((e||!n)&&t.indexOf("ResizeObserver loop limit exceeded")<0&&++Fe<=10){var s={error:t,url:e,lineno:n};i&&(s.colno=i),De(s,a,!0)}return!!Me&&Me.apply(this,arguments)},$(document).ajaxError((function(t,e,n,i){if(4==e.readyState){var a;if(e.responseText&&"{"===e.responseText.charAt(0))try{a=JSON.parse(e.responseText)}catch(t){}if(!a||!a.user_error){var s=z(n.url)+" API failure: ";siteinfo.user&&siteinfo.user.email&&(s+="user "+siteinfo.user.email+", "),s+=e.status,i&&(s+=", "+i),e.responseText&&(s+=", "+e.responseText.substring(0,100)),De(s)}}}));const Ne={m:2,M:2,z:0,Z:0,l:2,L:2,h:1,H:1,v:1,V:1,c:6,C:6,s:4,S:4,q:4,Q:4,t:2,T:2,a:7,A:7,b:1,B:1};let je,Le={},ze=0,Oe=!1;function Be(t){if(t instanceof SVGPathElement&&(t=t.getAttribute("d")),Le[t])return Le[t];for(var e,n,i,a,s,r,o=[],l=0,u=0,c=0,d=0,h=!1,p=0,f=0,g=1,m=function(t){t instanceof SVGPathElement&&(t=t.getAttribute("d")),t=t.split(/([a-zA-Z]|[-+]?(?:\d+\.?\d*|\.\d+)(?:[Ee][-+]?\d+)?)/);var e,n=1,i=t.length;return function(){for(var a,s=null;n<i;){if((a=t[n])>="A"){if(s)break;s=[a],e=a,"m"!==a&&"M"!==a&&"z"!==a&&"Z"!==a||(e="m"===a||"z"===a?"l":"L")}else{if(!s&&e)s=[e];else if(!s||s.length===Ne[s[0]]+1)break;s.push(+a)}n+=2}return s}}(t);a=m();)if("b"!==(s=a[0])&&"B"!==s)if("z"!==s&&"Z"!==s){if(1==Ne[s]&&(1==a.length?a=["L"]:"h"===s?a=["l",a[1],0]:"H"===s?a=["L",a[1],u]:"v"===s?a=["l",0,a[1]]:"V"===s&&(a=["L",l,a[1]])),(s=a[0])>="a"&&!p)for(e="a"!==s?1:6;e<a.length;e+=2)a[e]+=l,a[e+1]+=u;else if(s>="a")for("a"===s&&(a[3]+=p),e="a"!==s?1:6;e<a.length;e+=2)n=a[e],i=a[e+1],a[e]=l+n*g+i*f,a[e+1]=u+n*f+i*g;for(s=a[0]=s.toUpperCase();a.length<Ne[s]+1;)a.push(c,d);"S"===s?(n=i=0,r&&"C"===r[0]&&(n=l-r[3],i=u-r[4]),a=["C",l+n,u+i,a[1],a[2],a[3],a[4]],s="C"):"T"===s&&(n=i=0,r&&"Q"===r[0]&&(n=l-r[1],i=u-r[2]),a=["Q",l+n,u+i,a[1],a[2]],s="Q"),h||"M"===s||(0!==o.length&&"Z"!==o[o.length-1][0]&&o.push(["M"]),h=!0),"M"===s?(c=a[1],d=a[2],h=!1):"L"===s?o.push(["L",l,u,a[1],a[2]]):"C"===s?o.push(["C",l,u,a[1],a[2],a[3],a[4],a[5],a[6]]):"Q"===s?o.push(["C",l,u,l+2*(a[1]-l)/3,u+2*(a[2]-u)/3,a[3]+2*(a[1]-a[3])/3,a[4]+2*(a[2]-a[4])/3,a[3],a[4]]):(1==++Oe&&De("bad normalize "+s),o.push(a)),r=a,l=a[a.length-2],u=a[a.length-1]}else r=o.length?o[o.length-1]:null,h&&(l==c&&u==d||o.push(["L",l,u,c,d]),o.push(["Z"]),h=!1),l=c,u=d;else p="b"===s?p+a[1]:a[1],g=Math.cos(p),f=Math.sin(p);return ze>=1e3&&(Le={},ze=0),Le[t]=o,++ze,o}function Ie(t,e,n){if(n&&!function(t,e,n){function i(t,i,a,s){return t-e[0]>=n||e[0]-a>=n||i-e[1]>=n||e[1]-s>=n}if("clientX"in e){var a=t.getBoundingClientRect(),s=e[0]-e.clientX,r=e[1]-e.clientY;if(a&&i(a.left+s,a.top+r,a.right+s,a.bottom+r))return!1}for(var o,l,u,c,d=Be(t),h=0;h!==d.length;++h){var p=d[h];if("L"===p[0])o=Math.min(p[1],p[3]),l=Math.min(p[2],p[4]),u=Math.max(p[1],p[3]),c=Math.max(p[2],p[4]);else{if("C"!==p[0]){if("Z"===p[0]||"M"===p[0])continue;return!0}o=Math.min(p[1],p[3],p[5],p[7]),l=Math.min(p[2],p[4],p[6],p[8]),u=Math.max(p[1],p[3],p[5],p[7]),c=Math.max(p[2],p[4],p[6],p[8])}if(!i(o,l,u,c))return!0}return!1}(t,e,n.distance))return n;var i,a,s,r,o=t.getTotalLength(),l=((r=t)instanceof SVGPathElement&&(r=r.getAttribute("d")),Le[r]?Le[r].length:r.replace(/[^A-DF-Za-df-z]+/g,"").length),u=Math.max(o/l/8,4),c=n?(n.distance+.01)*(n.distance+.01):1/0;function d(n){var s=t.getPointAtLength(n),r=e[0]-s.x,o=e[1]-s.y,l=r*r+o*o;return l<c&&(i=[s.x,s.y],a=n,c=l),s}if(l>20){var h,p,f=function(t,e){var n=Be(t);function i(t,n,i,a){var s=e[0]<t?t-e[0]:e[0]>i?e[0]-i:0,r=e[1]<n?n-e[1]:e[1]>a?e[1]-a:0;return Math.max(s,r)}var a,s,r=1/0,o=-1/0,l=24;for(a=0;a!==n.length;++a)"L"===(s=n[a])[0]?(r=Math.min(r,s[1],s[3]),o=Math.max(o,s[1],s[3])):"C"===s[0]&&(r=Math.min(r,s[1],s[3],s[5],s[7]),o=Math.max(o,s[1],s[3],s[5],s[7]));r-=l,o+=l;var u,c,d,h,p,f=Math.max(Math.ceil((o-r)/l),1),g=new Array(f+1);for(g.fill(1/0),a=0;a!==n.length;++a){if("L"===(s=n[a])[0])u=Math.min(s[1],s[3]),c=Math.min(s[2],s[4]),d=Math.max(s[1],s[3]),h=Math.max(s[2],s[4]);else{if("C"!==s[0])continue;u=Math.min(s[1],s[3],s[5],s[7]),c=Math.min(s[2],s[4],s[6],s[8]),d=Math.max(s[1],s[3],s[5],s[7]),h=Math.max(s[2],s[4],s[6],s[8])}for(p=i(u,c,d,h),u=Math.floor((u-r)/l),d=Math.ceil((d-r)/l);u<=d;)g[u]=Math.min(g[u],p),++u}for(a=0;a!==g.length;++a)g[a]<1/0&&(g[a]=g[a]*g[a]);return g.xmin=r,g.xmax=o,g.width=l,g.point=e,g}(t,e),g=f.xmin,m=f.width;for(s=0;s<o;)h=d(s),f[p=Math.floor((h.x-g)/m)]>c&&f[p-1]>c&&f[p+1]>c?s+=m:s+=u}else for(s=0;s<o;s+=u)d(s);d(o);do{(s=a-u/2)>0&&d(s),(s+=u)<o&&d(s),u/=2}while(u>.5);return i&&(i.distance=Math.sqrt(c),i.pathNode=t,i.pathLength=a),i&&(!n||i.distance<=n.distance+.01)?i:n}class Pe{constructor(){this.is=[]}lower(t){for(var e=this.is,n=0,i=e.length;n<i;){var a=n+2*(i-n>>2);if(e[a]>t)i=a;else{if(!(t>e[a+1]))return a;n=a+2}}return n}contains(t){var e=this.lower(t);return e<this.is.length&&t>=this.is[e]}overlaps(t,e){var n=this.lower(t);return n<this.is.length&&e>=this.is[n]}add(t,e){var n=this.is,i=this.lower(t);(i>=n.length||t<n[i])&&n.splice(i,0,t,t);for(var a=i;a+2<n.length&&e>=n[a+2];)a+=2;a!==i&&n.splice(i+1,a-i),n[i+1]=Math.max(n[i+1],e)}clear(){this.is=[]}}function Re(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}class He{constructor(t,e,n){const i=$(t);let a="all";n.indexOf("extension")>=0?a="extension":n.indexOf("noextra")>=0&&(a="noextra");const s=e.series[a]||e.series.all,r=s.min();let o=r<0?r-1:0;e.entry&&"letter"===e.entry.type&&(o=Math.min(65,r<0?r:Math.max(r-5,0))),this.min=o,this.max=s.max(),e.maxtotal&&(this.max=Math.max(this.max,e.maxtotal)),this.min==this.max&&(o=this.min=this.min-1,this.max+=1),this.total=e.maxtotal,this.cutoff=s.cutoff,this.svg=Re("svg"),this.gg=Re("g"),this.gx=Re("g"),this.gy=Re("g"),this.xl=this.xt=!0,this.yl=this.yt="pdf"!==n.substring(0,3),this.tw=i.width(),this.th=i.height(),this.svg.setAttribute("preserveAspectRatio","none"),this.svg.setAttribute("width",this.tw),this.svg.setAttribute("height",this.th),this.svg.setAttribute("overflow","visible"),this.svg.appendChild(this.gg),this.gx.setAttribute("class","pa-gg-axis pa-gg-xaxis"),this.svg.appendChild(this.gx),this.gy.setAttribute("class","pa-gg-axis pa-gg-yaxis"),this.svg.appendChild(this.gy),this.maxp=0,this.hoveranno=null,this.hoveron=!1,i.html(this.svg);const l=Re("text");l.appendChild(document.createTextNode("888")),this.gx.appendChild(l);var u=l.getBBox();if(this.xdw=u.width/3,this.xdh=u.height,this.gx.removeChild(l),this.xlw=this.xdw*(this.max>0?Math.floor(Math.log10(this.max))+1:1),this.mt=Math.ceil(Math.max(this.yl?this.xdh/2:0,2)),this.mr=Math.ceil(this.xl?this.xlw/2:0),this.mb=(this.xt?5:0)+(this.xl?this.xdh+3:0),this.yl){const t=this.th-this.mt-Math.max(this.mb,Math.ceil(this.xdh/2));if(t>this.xdh){var c=i.hasClass("pa-grgraph-min-yaxis");this.yfmt=c?"%.0r%%":"%.0r";const e=t/this.xdh;this.ymax=100,this.ylu=e>15?10:e>5?25:e>3?50:100,this.ml=5+(this.yt?5:0)+(c?4.2:3)*this.xdw,i.hasClass("pa-grgraph-min-yaxis")||(this.yltext=Re("text"),this.yltext.appendChild(document.createTextNode("% of grades")),this.gy.appendChild(this.yltext),(u=this.yltext.getBBox()).width<=.875*t?this.ml+=.5*this.xdw+this.xdh:(this.gy.removeText(this.yltext),this.yltext=null)),this.mb=Math.max(this.mb,Math.ceil(this.xdh/2))}else this.yl=!1,this.ml=0,this.mt=2}else this.ml=this.yt?5:0;this.xl&&(this.ml=Math.max(this.ml,Math.ceil(this.xdw/2))),this.gw=this.tw-this.ml-this.mr;var d=this.gh=this.th-this.mt-this.mb;const h=this.gw/Math.max(this.max-this.min,.001);if(this.xax=function(t){return(t-o)*h},this.yax=function(t){return d-t*d},this.unxax=function(t){return t/h+o},this.unyax=function(t){return-(t-d)/d},e.entry&&e.entry.type){const t=window.pa_grade_types[e.entry.type];t&&t.tics&&(this.xtics=t.tics.call(t))}this.max-this.min>900?this.xfmt="%.0r":this.max-this.min>10?this.xfmt="%.1r":this.xfmt="%.3r",this.gg.setAttribute("transform","translate("+this.ml+","+this.mt+")"),this.gx.setAttribute("transform","translate("+this.ml+","+(this.mt+this.gh+(this.xt?2:-5))+")"),this.gy.setAttribute("transform","translate("+(this.ml+(this.yt?-2:5))+","+this.mt+")")}numeric_xaxis(){const t=Math.floor(Math.log10(this.max))+1,e=this.xdw*(t+.5),n=this.gw/e,i=Math.pow(10,Math.max(0,t-2)),a=(this.max-this.min)/i;let s;s=n>4*a&&i>1?i/2:n>2*a?i:n>a*(i<=1?.75:1)?2*i:i>1&&n>.6*a?2.5*i:n>.3*a?5*i:10*i;const r=[];let o=Math.floor(this.min/s)*s,l=!1;for(;o<this.max+s;){let t=o,n=this.xl;if(this.total&&(t>this.total&&t-s<this.total&&!l&&(t=this.total,o-=s),t==this.total&&(l=!0)),o+=s,t<this.min)continue;t>this.max&&(t=this.max);const i=this.xax(t);if(r.push("M",i,",0v5"),(this.total&&t!=this.total&&Math.abs(i-this.xax(this.total))<e||t!=this.max&&t!=this.total&&Math.abs(i-this.xax(this.max))<e)&&(n=!1),n){const e=Re("text");e.appendChild(document.createTextNode(t)),e.setAttribute("x",i),e.setAttribute("y",this.xdh+3),this.gx.appendChild(e)}}if(this.xt){const t=Re("path");t.setAttribute("d",r.join("")),t.setAttribute("fill","none"),t.setAttribute("stroke","black"),this.gx.appendChild(t)}}xtics_xaxis(){let t=new Pe,e=new Pe,n=[];for(let i=0;i!==this.xtics.length;++i){let a=this.xtics[i];if(a.x<this.min||a.x>this.max)continue;let s=this.xax(a.x);if((a.notic||!e.contains(s))&&(a.notic||(n.push("M",s,",0v5"),e.add(s-3,s+3)),this.xl&&a.text)){let e=this.xdw*(a.label_space||a.text.length+.5)*.5;if(!t.overlaps(s-e,s+e)){const n=Re("text");n.appendChild(document.createTextNode(a.text)),n.setAttribute("x",s),n.setAttribute("y",this.xdh+3),this.gx.appendChild(n),e=this.xdw*(a.text.length+.5)*.5,t.add(s-e,s+e)}}}if(this.xt){const t=Re("path");t.setAttribute("d",n.join("")),t.setAttribute("fill","none"),t.setAttribute("stroke","black"),this.gx.appendChild(t)}}xaxis(){this.xtics?this.xtics_xaxis():this.numeric_xaxis()}yaxis(){const t=[];let n=0;for(;n<=this.ymax&&this.yl;){const i=Re("text");i.appendChild(document.createTextNode(e(this.yfmt,n))),i.setAttribute("x",-8),i.setAttribute("y",this.yax(n/this.ymax)+.25*this.xdh),this.gy.appendChild(i),t.push("M-5,",this.yax(n/this.ymax),"h5"),n+=this.ylu}if(this.yt){const e=Re("path");e.setAttribute("d",t.join("")),e.setAttribute("fill","none"),e.setAttribute("stroke","black"),this.gy.appendChild(e)}this.yltext&&(this.yltext.setAttribute("transform","translate("+(-this.ml+this.xdh)+","+this.yax(.5)+") rotate(-90)"),this.yltext.setAttribute("text-anchor","middle"))}container(){return this.svg.closest(".pa-grgraph")}append_cdf(t,e){const n=t.cdf,i=[],a=1/t.n,s=this.cutoff||0,r=this.min;let o=0;if(s)for(;o<n.length&&n[o+1]<s*t.n;)o+=2;for(;o<n.length;o+=2){if(0!==i.length){const t=Math.max(r,n[o]-Math.min(1,n[o]-n[o-2])/2);i.push("H",this.xax(t))}else i.push("M",this.xax(Math.max(r,n[o]-.5)),",",this.yax(s));i.push("V",this.yax(n[o+1]*a))}0!==i.length&&i.push("H",this.xax(Math.max(this.max,n[n.length-2])));const l=Re("path");return l.setAttribute("d",i.join("")),l.setAttribute("fill","none"),l.setAttribute("class",e),this.gg.appendChild(l),this.last_curve=l,this.last_curve_series=t,l}append_pdf(t,e){if(0===t.maxp)return null;const n=[],i=t.kde,a=.9/this.maxp,s=this.xax,r=this.yax,o=[0,0,0,0],l=[0,0,0,0],u=[0,0,0,0],c=[0,0,0,0],d=1e-6;function h(t){const e=(t+2)%4,i=(t+3)%4,a=(t+1)%4;let s=o[i],r=l[i],h=o[t],p=l[t];if(u[i]>d){let n=2*c[i]+3*u[i]*u[t]+c[t],a=3*u[i]*(u[i]+u[t]);s=(s*n-o[e]*c[t]+o[t]*c[i])/a,r=(r*n-l[e]*c[t]+l[t]*c[i])/a}if(u[a]>d){let e=2*c[a]+3*u[a]*u[t]+c[t],n=3*u[a]*(u[a]+u[t]);h=(h*e-o[a]*c[t]+o[i]*c[a])/n,p=(p*e-l[a]*c[t]+l[i]*c[a])/n}n.push("C",s,r,h,p,o[t],l[t])}for(let e=0;e!==i.length;++e){const d=s(this.min+e*t.binwidth),f=r(i[e]*a);if(0===e)n.push("M",d,f),o[3]=o[0]=d,l[3]=l[0]=f;else{const t=(e+3)%4,n=e%4;o[n]=d,l[n]=f;const a=o[t]-d,s=l[t]-f;if(c[n]=Math.sqrt(a*a+s*s),u[n]=Math.sqrt(c[n]),e>1&&h(t),e===i.length-1){var p=(e+1)%4;o[p]=d,l[p]=f,c[p]=0,u[p]=0,h(n)}}}const f=Re("path");return f.setAttribute("d",n.join(" ")),f.setAttribute("fill","none"),f.setAttribute("class",e),this.gg.appendChild(f),this.last_curve=f,this.last_curve_series=t.series,f}remove_if(t){let e=this.gg.firstChild;for(;e;){const n=e.nextSibling;t.call(e)&&this.gg.removeChild(e),e=n}}highlight_last_curve(t,e,n){if(!this.last_curve||!this.last_curve_series.cdfu)return null;var i,a,s,r,o,l,d,h=u(this.last_curve,"pa-gg-pdf"),p=this.last_curve_series.cdf,f=this.last_curve_series.cdfu,g=[];for(a=(i=h?.9/(this.maxp*t.n):1/t.n)*this.gh,s=r=0;s!==p.length;s+=2){for(d=0;r!==p[s+1];++r)e(f[r],t)&&++d;d&&(o=this.xax(p[s]),null!=(l=h?Te.call(this.last_curve,o):this.yax(p[s+1]*i))&&g.push("M",o,",",l,"v",d*a))}if(g.length){const t=Re("path");return t.setAttribute("d",g.join("")),t.setAttribute("fill","none"),t.setAttribute("class",n),this.gg.appendChild(t),c(this.gg,"pa-gg-has-hl"),t}return null}typed_annotation(t){const e=Re("circle");return e.setAttribute("class","pa-gg-mark hl-"+(t||"main")),e.setAttribute("r",t&&"main"!==t?3.5:5),e}star_annotation(t,e,n,i){null==e&&(e=Math.PI/2),null==n&&(n=5);var a=Re("path");a.setAttribute("class",i);for(var s=["M"],r=Math.cos,o=Math.sin,l=Math.PI/n,u=0;u<2*n;++u)s.push(t[1&u]*r(e)," ",t[1&u]*o(e),u?" ":"L"),e+=l;return s.push("z"),a.setAttribute("d",s.join("")),a}annotate_last_curve(t,e,n){if(this.last_curve){var i=this.xax(t),a=Te.call(this.last_curve,i);if(null===a&&this.cutoff&&(a=this.yax(this.cutoff)),null!==a)return(e=e||this.typed_annotation()).setAttribute("transform","translate("+i+","+a+")"),this.gg.insertBefore(e,n||null),!0}return!1}user_x(t){if(this.last_curve_series.cdfu){if(!this.last_curve_series.ucdf){var e,n,i=this.last_curve_series.cdf,a=this.last_curve_series.cdfu,s=this.last_curve_series.ucdf={};for(e=n=0;n!==a.length;++n){for(;n>=i[e+1];)e+=2;s[a[n]]=i[e]}}return this.last_curve_series.ucdf[t]}}highlight_users(){if(this.last_curve&&this.last_curve_series.cdfu){this.last_highlight=this.last_highlight||{};var t,e=this.container().attributes,n={};for(let t=0;t!==e.length;++t)if(e[t].name.startsWith("data-pa-highlight")){let i;i="data-pa-highlight"===e[t].name?"main":e[t].name.substring(18),n[i]=e[t].value,this.last_highlight[i]=this.last_highlight[i]||""}for(let e in this.last_highlight){var i=n[e]||"";if(this.last_highlight[e]!==i){var a={},s=i.split(/\s+/);for(let t=0;t!==s.length;++t)""!==s[t]&&(a[s[t]]=1);for(var r,o=this.gg.firstChild,l="pa-gg-mark hl-"+e;o&&(!u(o,"pa-gg-mark")||o.className.animVal<l);)o=o.nextSibling;for(;o&&o.className.animVal===l;){r=o.nextSibling;var c=+o.getAttribute("data-pa-uid");a[c]?a[c]=2:this.gg.removeChild(o),o=r}for(let n=0;n!==s.length;++n)if(1===a[s[n]]&&null!=(t=this.user_x(s[n]))){var d=this.typed_annotation(e);d.setAttribute("data-pa-uid",s[n]),this.annotate_last_curve(t,d,o)}this.last_highlight[e]=i}}}}hover(){const t=this;function n(t,e,n){let i=null;for(const a of t){const t=a.getAttribute("transform").match(/^translate\(([-+\d.]+),([-+\d.]+)\)$/);if(t){const s=+t[1]-e[0],r=+t[2]-e[1],o=s*s+r*r;o<n&&(i=[+t[1],+t[2]],i.pathNode=a,n=o)}}return i&&(i.distance=Math.sqrt(n)),i}function i(i){let a={distance:20},s=t.xfmt;if("mousemove"!==i.type&&(t.hoveron="mouseleave"!==i.type),t.hoveron){const e=function(t,e){var n,i=t.ownerSVGElement||t;if(i.createSVGPoint)(n=i.createSVGPoint()).x=e.clientX,n.y=e.clientY,n=n.matrixTransform(t.getScreenCTM().inverse());else{var a=t.getBoundingClientRect();n={x:e.clientX-a.left-t.clientLeft,y:e.clientY-a.top-t.clientTop}}var s=[n.x,n.y];return s.clientX=e.clientX,s.clientY=e.clientY,s}(t.svg,i),o=t.gg.querySelectorAll(".pa-gg-pdf, .pa-gg-cdf");for(var r of(e[0]-=t.ml,e[1]-=t.mt,o))a=Ie(r,e,a);if(a.pathNode){const e=n(t.gg.querySelectorAll(".pa-gg-mark.hl-main"),a,36)||n(t.gg.querySelectorAll(".pa-gg-mark:not(.hl-main)"),a,25);e&&(a=e,"%.0r"!==s&&"%.1f"!==s||(s="%.2r"))}}let o=t.hoveranno;if(a.pathNode){if(!o){o=t.hoveranno=[t.star_annotation([4,10],null,null,"pa-gg-hover-mark")],t.gg.appendChild(o[0]);var l=Re("path");l.setAttribute("d","M0,0v5"),l.setAttribute("fill","none"),l.setAttribute("stroke","black"),t.gx.appendChild(l),o.push(l),(l=Re("rect")).setAttribute("class","pa-gg-hover-box"),l.setAttribute("y",5),l.setAttribute("height",t.xdh+1.5),l.setAttribute("rx",3),t.gx.appendChild(l),o.push(l),(l=Re("text")).appendChild(document.createTextNode("")),l.setAttribute("class","pa-gg-hover-text"),l.setAttribute("y",t.xdh+3),t.gx.appendChild(l),o.push(l),(l=Re("text")).appendChild(document.createTextNode("")),l.setAttribute("class","pa-gg-anno-name"),l.setAttribute("text-anchor","end"),l.setAttribute("dx",-8),t.gg.appendChild(l),o.push(l),t.yl&&((l=Re("path")).setAttribute("d","M-5,0h5"),l.setAttribute("fill","none"),l.setAttribute("stroke","black"),t.gy.appendChild(l),o.push(l),(l=Re("rect")).setAttribute("class","pa-gg-hover-box"),l.setAttribute("height",t.xdh+1),l.setAttribute("rx",3),t.gy.appendChild(l),o.push(l),(l=Re("text")).appendChild(document.createTextNode("")),l.setAttribute("class","pa-gg-hover-text"),l.setAttribute("x",-8),t.gy.appendChild(l),o.push(l))}o[0].setAttribute("transform","translate("+a[0]+","+a[1]+")"),o[1].setAttribute("transform","translate("+a[0]+",0)"),o[3].setAttribute("x",a[0]),o[3].firstChild.data=e(s,t.unxax(a[0]));var u,c,d=o[3].getBBox();o[2].setAttribute("x",a[0]-d.width/2-2),o[2].setAttribute("width",d.width+4),a.pathNode.hasAttribute("data-pa-uid")&&(u=$(".gtable").data("paTable"))&&(c=u.name_text(a.pathNode.getAttribute("data-pa-uid")))?(o[4].firstChild.data=c,o[4].setAttribute("x",a[0]),o[4].setAttribute("y",a[1])):o[4].firstChild.data="",t.yl&&(o[5].setAttribute("transform","translate(0,"+a[1]+")"),o[7].setAttribute("y",a[1]+.25*t.xdh),o[7].firstChild.data=e(t.yfmt,t.unyax(a[1])*t.ymax),d=o[7].getBBox(),o[6].setAttribute("x",-d.width-10),o[6].setAttribute("y",a[1]-(t.xdh+2)/2),o[6].setAttribute("width",d.width+4))}else o&&(t.gg.removeChild(o[0]),t.gx.removeChild(o[1]),t.gx.removeChild(o[2]),t.gx.removeChild(o[3]),t.gg.removeChild(o[4]),t.yl&&(t.gy.removeChild(o[5]),t.gy.removeChild(o[6]),t.gy.removeChild(o[7])),t.hoveranno=null)}this.svg.addEventListener("mouseenter",i,!1),this.svg.addEventListener("mousemove",i,!1),this.svg.addEventListener("mouseleave",i,!1)}}class We{constructor(t){this.n=t.n,this.cdf=t.cdf,this.cdfu=t.cdfu||null,this.mean=t.mean||null,this.median=t.median||null,this.stddev=t.stddev||null,this.cutoff=t.cutoff||null}min(){return this.cdf.length?this.cdf[0]:0}max(){return this.cdf.length?this.cdf[this.cdf.length-2]:0}count_at(t){const e=this.cdf;let n=0,i=e.length;for(;n<i;){const a=n+2*(i-n>>2);e[a]>=t?i=a:n=a+2}return e[n+1]}}class qe{constructor(t,e,n,i){const a=e.max,s=e.min,r=(a-s)*n,o=1/r;function l(t){return t>=-r&&t<=r?.75*o*(1-(t*=o)*t):0}const u=[];for(let t=0;t!==i+1;++t)u.push(0);const c=t.cdf,d=(a-s)/i,h=1/d;for(let t=0;t<c.length;t+=2){const e=c[t+1]-(0===t?0:c[t-1]);let n=Math.floor((c[t]-s-r)*h);const a=Math.ceil((c[t]-s+r)*h);for(;n<a;){const a=Math.max(-1,Math.min(i+1,n));a>=0&&a<=i&&(u[a]+=l(n*d-c[t]+s)*e),++n}}let p=0;if(t.n){const e=1/t.n;for(let t=0;t!==i+1;++t)u[t]*=e,p=Math.max(p,u[t])}this.series=t,this.kde=u,this.maxp=p,this.binwidth=d}}class Ue{constructor(t){this.pset=t.pset,this.psetid=t.psetid,this.maxtotal=t.maxtotal||null,this.entry=t.entry||null,this.series={};for(let e in t.series)this.series[e]=new We(t.series[e])}}function Ze(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function Ke(){const e=this,n=$(e).data("paGradeData");if(!n)return c(e,"hidden"),void $(e).removeData("paGradeGraph").off("redrawgraph");const i=e.closest(".pa-psetinfo"),a=!i||i.hasAttribute("data-pa-user-extension"),s=[];n.series.extension&&i&&a&&s.push("cdf-extension","pdf-extension"),s.push("cdf","pdf"),n.series.extension&&!i&&s.push("cdf-extension","pdf-extension"),n.series.noextra&&s.push("cdf-noextra","pdf-noextra"),s.push("all"),e.setAttribute("data-pa-gg-types",s.join(" "));let r=e.getAttribute("data-pa-gg-type");if(r||(r=t(!0,"pa-gg-type")),!r){let e=t(!1,"pa-gg-type");if(e&&"{"===e[0])try{e=JSON.parse(e),"string"==typeof e.type&&"number"==typeof e.at&&e.at>=(new Date).getTime()-72e5&&(r=e.type)}catch(t){}}r&&"default"!==r||(r=s[0]),s.indexOf(r)<0&&(r="pdf"===r.substring(0,3)?s[1]:s[0]),e.setAttribute("data-pa-gg-type",r),$(e).removeClass("cdf pdf all cdf-extension pdf-extension all-extension cdf-noextra pdf-noextra all-noextra hidden").addClass(r);const o="all"===r.substring(0,3),l=r.indexOf("-extension")>=0||o&&a&&n.extension,u=r.indexOf("-noextra")>=0||o&&n.series.noextra&&!l;let h=$(e).find(".pa-plot");h.length||(h=$(e));const p=new He(h[0],n,r);if($(e).data("paGradeGraph",p),p.total&&p.total<p.max){let t=Ze("line");t.setAttribute("x1",p.xax(p.total)),t.setAttribute("y1",p.yax(0)),t.setAttribute("x2",p.xax(p.total)),t.setAttribute("y2",p.yax(1)),t.setAttribute("class","pa-gg-anno-total"),p.gg.appendChild(t)}const f=Math.ceil((p.max-p.min)/2),g=.08,m={};"pdf-extension"===r?m.extension=new qe(n.series.extension,p,g,f):"pdf-noextra"===r?m.noextra=new qe(n.series.noextra,p,g,f):"pdf"===r&&(m.main=new qe(n.series.all,p,g,f));for(let t in m)p.maxp=Math.max(p.maxp,m[t].maxp);if("pdf-noextra"===r?p.append_pdf(m.noextra,"pa-gg-pdf pa-gg-noextra"):"pdf"===r?p.append_pdf(m.main,"pa-gg-pdf"):"pdf-extension"===r?p.append_pdf(m.extension,"pa-gg-pdf pa-gg-extension"):("cdf-noextra"===r||"all"===r&&n.series.noextra)&&p.append_cdf(n.series.noextra,"pa-gg-cdf pa-gg-noextra"),"cdf"!==r&&"all"!==r||p.append_cdf(n.series.all,"pa-gg-cdf"),("cdf-extension"===r||"all"===r&&n.series.extension&&a)&&p.append_cdf(n.series.extension,"pa-gg-cdf pa-gg-extension"),p.cutoff&&"pdf"!==r.substring(0,3)){const t=Ze("rect");t.setAttribute("x",p.xax(0)),t.setAttribute("y",p.yax(p.cutoff)),t.setAttribute("width",p.xax(p.max)),t.setAttribute("height",p.yax(0)-p.yax(p.cutoff)),t.setAttribute("fill","rgba(255,0,0,0.1)"),p.gg.appendChild(t)}const b=$(i).data("pa-gradeinfo"),_=b?b.grade_total(u&&!o):null;null!=_&&p.annotate_last_curve(_),p.xaxis(),p.yaxis(),e.hasAttribute("data-pa-highlight")&&p.highlight_users(),p.hover(),$(e).find(".statistics").each((function(){const t=p.last_curve_series,e=[];t&&t.mean&&e.push("mean "+t.mean.toFixed(1)),t&&t.median&&e.push("median "+t.median.toFixed(1)),t&&t.stddev&&e.push("stddev "+t.stddev.toFixed(1));const n=[e.join(", ")];if(t&&null!=_){const e=t.count_at(_);t.cutoff&&e<t.cutoff*t.n?n.push(""+Math.round(100*t.cutoff)+" %ile"):n.push(Math.round(Math.min(Math.max(1,100*e/t.n),99))+" %ile")}n.length?(d(this,"hidden"),this.innerHTML=n.join("  ")):(c(this,"hidden"),this.innerHTML="")})),$(e).find(".pa-grgraph-type").each((function(){const t=[];r.startsWith("cdf")?t.push("CDF"):r.startsWith("pdf")&&t.push("PDF"),l&&!o&&t.push("extension"),u&&!o&&t.push("no extra credit");const e=t.length?" ("+t.join(", ")+")":"";this.innerHTML="grade statistics"+e})),p.highlight_users(),$(e).off("redrawgraph").on("redrawgraph",Ke)}function Je(t){t=t.replace(/^[^#]*/,"");let e,n=/([^#=\/]+)[=\/]?([^\/]*)/g,i={};for(;e=n.exec(t);)i[e[1]]=decodeURIComponent(e[2].replace(/\+/g," "));return i}function Ye(t){const e=Je(location.hash);for(let n in t)null===t[n]||void 0===t[n]?delete e[n]:e[n]=t[n];const n=function(t){const e=[];for(var n in t)null===t[n]||void 0===t[n]||""===t[n]?e.push(n):e.push(n+"="+encodeURIComponent(t[n]).replace(/%20/g,"+"));return e.sort(),e.length?"#"+e.join("/"):""}(e);n!==location.hash&&je(location.origin+location.pathname+location.search+n)}function Ge(){return u(document.body,"want-grgraph-hash")}function Ve(t,e,n){const i="data-pa-highlight"+("main"===e?"":"-"+e);n=n||"",$(t).find(".pa-grgraph").each((function(){const t=this.getAttribute(i)||"",a=this;t===n||"main"!==e&&"course"===this.getAttribute("data-pa-pset")||(n?this.setAttribute(i,n):this.removeAttribute(i),window.requestAnimationFrame((function(){const t=$(a).data("paGradeGraph");t&&t.highlight_users()})))}))}function Xe(t,e){const n={},i={};let a,s=!1;for(let e of t.match(/[-\d.]+/g)||[])n[e]=!0;if($(".js-grgraph-highlight-course").each((function(){const t=this.getAttribute("data-pa-highlight-range")||"90-100",e=this.getAttribute("data-pa-highlight-type")||"h00";if(i[e]=i[e]||[],this.checked=!!n[t]){let n=t.match(/^([-+]?(?:\d+\.?\d*|\.\d+))-([-+]?(?:\d+\.?\d*|\.\d))(\.?)$/);if(n)i[e].push(+n[1],+n[2]+(n[3]?1e-5:0)),s=!0;else{if(!(n=t.match(/^([-+]?(?:\d+\.?\d*|\.\d+))-$/)))throw new Error("bad range");i[e].push(+n[1],1/0),s=!0}}})),s)if(a=function(){let t=null;return $(".pa-grgraph[data-pa-pset=course]").each((function(){const e=$(this).data("paGradeData");if(e&&e.series.all&&e.series.all.cdfu)return t=e.series.all,!1})),t}())for(let t in i){const e=i[t],n=[];if(e.length){for(let t=0;t!==a.cdf.length;t+=2)for(let i=0;i!==e.length;i+=2)if(a.cdf[t]>=e[i]&&a.cdf[t]<e[i+1]){const e=t?a.cdf[t-1]:0;Array.prototype.push.apply(n,a.cdfu.slice(e,a.cdf[t+1]));break}n.sort()}Ve(document.body,t,n.join(" "))}else setTimeout((function(){Xe(Je(location.hash).hr||"",e+1)}),8<<Math.max(e,230));else for(let t in i)Ve(document.body,t,"")}function Qe(t){const e=Je(t);Ve(document.body,"main",e.hs||""),$("input[type=checkbox].js-grgraph-highlight").prop("checked",!1);for(let t of(e.hs||"").match(/\d+/g)||[])$("tr[data-pa-uid="+t+"] input[type=checkbox].js-grgraph-highlight").prop("checked",!0);Xe(e.hr||"",0),$(".js-grgraph-highlight-course").prop("checked",!1);for(let t of(e.hr||"").match(/[-\d.]+/g)||[])$('.js-grgraph-highlight-course[data-pa-highlight-range="'+t+'"]').prop("checked",!0)}b.on("js-grgraph-flip",(function(){const e=this.closest(".pa-grgraph"),n=(e.getAttribute("data-pa-gg-types")||"").split(/ /),i=e.getAttribute("data-pa-gg-type");let a=n.indexOf(i);a>=0&&(a=(a+(u(this,"prev")?n.length-1:1))%n.length,e.setAttribute("data-pa-gg-type",n[a]),t(!0,"pa-gg-type",n[a]),t(!1,"pa-gg-type",{type:n[a],at:(new Date).getTime()}),Ke.call(e))})),je="pushState"in window.history?function(t){var e;return history.state||(e={href:location.href},$(document).trigger("collectState",[e]),history.replaceState(e,document.title,e.href)),t&&(e={href:t},$(document).trigger("collectState",[e]),history.pushState(e,document.title,e.href)),!0}:function(){return!1},b.on("js-grgraph-highlight",(function(t){if("change"!==t.type)return;const e=this.getAttribute("data-range-type"),n=[];$(this).closest("form").find("input[type=checkbox]").each((function(){let t;this.getAttribute("data-range-type")===e&&this.checked&&(t=this.closest("tr"))&&t.hasAttribute("data-pa-uid")&&n.push(+t.getAttribute("data-pa-uid"))})),n.sort((function(t,e){return t-e})),Ge()?(Ye({hs:n.length?n.join(" "):null}),Ve(document.body,"main",n.join(" "))):Ve(this.closest("form"),"main",n.join(" "))})),b.on("js-grgraph-highlight-course",(function(){const t=[];$(".js-grgraph-highlight-course").each((function(){this.checked&&t.push(this.getAttribute("data-pa-highlight-range"))})),Ge()&&Ye({hr:t.length?t.join(" "):null}),Xe(t.join(" "),0)})),Ge()&&($(window).on("popstate",(function(t){const e=(t.originalEvent||t).state;e&&e.href&&Qe(e.href)})).on("hashchange",(function(){Qe(location.href)})),$((function(){Qe(location.href)}))),Gt.add("checkbox",{text:function(t){return null==t||0===t||!1===t?"":t===(this.max||1)||!0===t?"":""+t},simple_text:Gt.basic_text,tcell:function(t){return null==t||0===t||!1===t?"":t===(this.max||1)||!0===t?"":""+t},mount_edit:function(t,e){return'<span class="pa-gradewidth"><input type="checkbox" class="ui pa-gradevalue ml-0" name="'.concat(this.key,'" id="',e,'" value="',this.max,'"></span>',' <span class="pa-gradedesc">of ',this.max,' <a href="" class="x ui pa-grade-uncheckbox" tabindex="-1">#</a></span>')},update_edit:function(t,e,n){const i=null==e||""===e||0===e||this&&e===this.max,a=t.firstChild.firstChild;i||"checkbox"!==a.type?i&&"checkbox"!==a.type&&n.reset&&tn.recheckbox(a):tn.uncheckbox(a),"checkbox"===a.type?(a.checked=!!e,a.indeterminate=!!n.mixed):a.value===e||!n.reset&&$(a).is(":focus")||(a.value=""+e)},justify:"center"});class tn{static uncheckbox(t){const e=te.closest(t);"checkbox"===t.type&&(t.value=t.checked?e.max:""),t.type="text",t.className=(u(t,"ui")||u(t,"uich")?"uich ":"")+"pa-gradevalue pa-gradewidth";const n=t.closest(".pa-pv");$(n).find(".pa-grade-uncheckbox").remove(),$(n).find('input[name^="'+t.name+':"]').addClass("hidden")}static recheckbox(t){const e=t.value.trim(),n=te.closest(t);t.type="checkbox",t.checked=""!==e&&"0"!==e,t.value=n.max,t.className=(u(t,"uich")?"ui ":"")+"pa-gradevalue",$(t.closest(".pa-pv")).find(".pa-gradedesc").append(' <a href="" class="x ui pa-grade-uncheckbox" tabindex="-1">#</a>')}}b.on("pa-grade-uncheckbox",(function(){$(this.closest(".pa-pv")).find(".pa-gradevalue").each((function(){tn.uncheckbox(this),this.focus(),this.select()}))}));const en={98:"A+",95:"A",92:"A-",88:"B+",85:"B",82:"B-",78:"C+",75:"C",72:"C-",68:"D+",65:"D",62:"D-",50:"F"};function nn(t){return{text:function(e){return null==e||0===e?"":e>0&&Math.abs(e-Math.round(e))<.05?t.repeat(Math.round(e)):""+e},simple_text:Gt.basic_text,tcell:function(e){return null==e||0===e?"":e>0&&Math.abs(e-Math.round(e))<.05?t.repeat(Math.round(e)):""+e},mount_edit:function(t,e){let n='<span class="pa-gradewidth"><input type="hidden" class="uich pa-gradevalue" name="'.concat(this.key,'">');for(let t=0;t<this.max;++t)n=n.concat('<input type="checkbox" class="ui js-multicheckbox-grade ml-0" name="',this.key,":",t,'" value="1"'),t===this.max-1&&(n+=' id="'+e+'"'),n+=">";return n.concat('</span>  <span class="pa-gradedesc">of ',this.max,' <a href="" class="x ui pa-grade-uncheckbox" tabindex="-1">#</a></span>')},update_edit:function(t,e,n){const i=null==e||""===e||0===e||e>=0&&(!this||e<=this.max)&&Math.abs(e-Math.round(e))<.05,a=t.firstChild.firstChild;i||"hidden"!==a.type?i&&"hidden"!==a.type&&n.reset&&tn.recheckbox(a):tn.uncheckbox(a),a.value===e||!n.reset&&$(a).is(":focus")||(a.value=e);const s=a.name+":",r=Math.round(e||0);$(t).find("input[type=checkbox]").each((function(){if(this.name.startsWith(s)){const t=+this.name.substring(s.length);this.checked=t<r,this.indeterminate=!!n.mixed}}))},justify:"left"}}function an(t,e,n){t.line(e).then((t=>{n.source=t.element,n.render(!1)}))}Gt.add("letter",{text:t=>null==t?"":en[t]||""+t,mount_edit:function(t,e){return Gt.basic_mount_edit.call(this,t,e,{max_text:"letter grade"})},justify:"left",tics:()=>{const t=[];for(let e in en)1===en[e].length&&t.push({x:e,text:en[e]});for(let e in en)2===en[e].length&&t.push({x:e,text:en[e],label_space:5});for(let e in en)2===en[e].length&&t.push({x:e,text:en[e].substring(1),label_space:2,notic:!0});return t}}),Gt.add("checkboxes",nn("")),Gt.add("stars",nn("")),b.on("js-multicheckbox-grade",(function(){const t=this.name.indexOf(":"),e=this.name.substring(0,t),n=this.name.substring(t+1),i=this.closest("form").elements[e],a=this.checked?+n+1+"":n;i.value!==a&&(i.value=a,$(i).trigger("change"))})),Gt.add("select",{mount_edit:function(t,e){let n='<span class="select"><select class="uich pa-gradevalue" name="'.concat(this.key,'" id="',e,'"><option value="">None</option>');for(let t=0;t!==this.options.length;++t){const e=V(this.options[t]);n=n.concat('<option value="',e,'">',e,"</option>")}return n+"</select></span>"},update_edit:function(t,e,n){const i=this.simple_text(e),a=t.firstChild.firstChild;$(a).val()===i||!n.reset&&$(a).is(":focus")||$(a).val(i),n.reset&&n.mixed?(""!==a.options[0].value&&$(a).prepend('<option value="">Mixed</option>'),a.selectedIndex=0):""!==i&&a.remove(0)},configure_column:function(t,e){return(t=Gt.basic_configure_column.call(this,t,e)).className+=" gt-el",t},tcell_width:function(t){let e=0;for(let t of this.options)e=Math.max(e,t.length);return Math.max(Gt.basic_tcell_width.call(this,t),Math.floor(1.25*Math.min(e,10))/2)},justify:"left",sort:"forward"}),Gt.add("markdown",{text:function(t){return null==t?"":""+t},mount_show:function(t,e){t.id=e,c(t,"pa-textv"),c(t,"pa-gradevalue")},mount_edit:function(t,e){return c(t,"pa-textv"),'<p class="pa-preview-notice"><span>Markdown styling and LaTeX math supported  </span><a href="" class="ui js-toggle-gc-markdown-preview" tabindex="-1">Preview</a></p><textarea class="uich pa-gradevalue need-autogrow" name="'.concat(this.key,'" id="',e,'"></textarea>')},update_show:function(t,e,n){if(null==e||""===e)t.innerHTML="";else if(this.answer){const i=n.gradesheet;c(t,"bg-none"),c(t,"align-self-start");const a=document.createElement("div");a.className="pa-filediff pa-dg pa-hide-left pa-hide-landmarks uim"+(i.scores_editable?" pa-editablenotes live":"");let s="/g/"+this.key;a.id=i.file_anchor(s);let r=0,o=1;for(;r!==e.length;){let t=e.indexOf("\n",r);t=t<0?e.length:t+1;const n=document.createElement("div"),i=document.createElement("div"),s=document.createElement("div"),l=document.createElement("div");n.className="pa-dl pa-gi",i.className="pa-da hidden",s.className="pa-db hidden",s.setAttribute("data-landmark",o),l.className="pa-dd pa-dhlm",l.textContent=e.substring(r,t),n.appendChild(i),n.appendChild(s),n.appendChild(l),a.appendChild(n),++o,r=t}t.replaceChildren(a);const l=new bt(a);let d;if(u(t.parentElement,"pa-markdown")&&l.markdown(),i.linenotes&&(d=i.linenotes[s]))for(let t in d)an(l,t,Ut.parse(d[t]))}else u(t.parentElement,"pa-markdown")?It(1,e,t):It(0,e,t);return null===t.firstChild},justify:"left",sort:"forward",type_tabular:!1}),b.on("js-toggle-gc-markdown-preview",(function(){const t=this.closest(".pa-pv").querySelector("textarea");if(u(t,"hidden"))t.parentElement.removeChild(t.previousSibling),d(t,"hidden"),t.focus(),this.innerHTML="Preview",d(this.previousSibling,"hidden");else{const e=document.createElement("div"),n=document.createElement("hr"),i=document.createElement("hr"),a=document.createElement("div");e.className="pa-preview",n.className=i.className="pa-preview-border",a.className="pa-dr",e.append(n,a,i),t.parentElement.insertBefore(e,t),c(t,"hidden"),It(1,t.value,a),this.innerHTML="Edit",c(this.previousSibling,"hidden")}}));const sn="%Y-%m-%d %H:%M";function rn(t,e){let n,i;return t.timeout_entry&&e&&(n=e.entries[t.timeout_entry])&&null!=(i=n.value_in(e))?i:t.timeout}function on(t,e,n,i){const a=+document.body.getAttribute("data-time-skew"),o=n+i-(new Date).getTime()/1e3+a;let l=s(sn,n);o>360?l=l.concat(" (",r(o)," left)"):o>0&&(l=l.concat(' <strong class="overdue">(',r(o)," left)</strong>")),e.innerHTML=l}Gt.add("timermark",{text:function(t){return null==t||0===t?"":s(sn,t)},simple_text:Gt.basic_text,tcell:function(t){return null==t||0===t?"":s(sn,t)},tcell_width:10,make_compare:function(t){const e=t.gidx;return function(t,n){const i=t.grades&&t.grades[e],a=n.grades&&n.grades[e];if(""===i||null==i||0==i||""===a||null==a||0==a){if(""!==i&&null!=i&&0!=i)return-1;if(""!==a&&null!=a&&0!=a)return 1}else{if(i<a)return-1;if(i>a)return 1}return t._sort_user.localeCompare(n._sort_user)}},mount_show:function(t,e){t.id=e,c(t,"pa-gradevalue")},update_show:function(t,n,i){const a=i.gradesheet;if(null==n||0===n)t.innerText="";else{let i=s(sn,n);if(a&&(a.student_timestamp||0)>n){const t=s(sn,a.student_timestamp),r=a.student_timestamp-n,o=rn(this,a);i+=e(o&&r>o+120?'  %s <strong class="overdue">(%dh%dm later)</strong>':"  %s (%dh%dm later)",t,r/3600,r/60%60)}t.innerHTML=i}return!1},mount_edit:function(t){d(t,"pa-gradevalue");let e='<button class="ui js-timermark hidden mr-2" type="button" name="'.concat(this.key,':b" value="1">Press to start</button>');return siteinfo.user.is_pclike&&(e=e.concat('<button class="ui js-timermark hidden mr-2" type="button" name="',this.key,':r" value="0">Reset</button>')),e.concat('<span class="pa-timermark-result hidden"></span><input type="hidden" class="uich pa-gradevalue" name="',this.key,'">')},update_edit:function(t,n,i){const a=i.gradesheet;let o=rn(this,a);t.querySelectorAll(".js-timermark").forEach((function(t){t.classList.toggle("hidden",!n!=("1"===t.value))}));const l=t.querySelector(".pa-timermark-result");l.classList.toggle("hidden",!n&&!o);const u=t.querySelector(".pa-gradevalue"),c=$(u).data("pa-timermark-interval");if(c&&clearInterval(c),n&&o&&n+o>+document.body.getAttribute("data-now"))on(this,l,n,o),$(u).data("pa-timermark-interval",setInterval(on,15e3,this,l,n,o));else if(n){let t=s(sn,n);if(a&&(a.student_timestamp||0)>n){const i=a.student_timestamp-n;t+=e(" (updated %dh%dm later at %s)",i/3600,i/60%60,s(sn,a.student_timestamp))}l.innerHTML=t}else o&&(l.innerHTML="Time once started: "+r(o))},justify:"left",sort:"forward"}),b.on("js-timermark",(function(){const t=this.name.indexOf(":"),e=this.name.substring(0,t),n=this.closest("form").elements[e];n.value=this.value,$(n).trigger("change")}));var ln=/[\0-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,un=/[\0-\x1F\x7F-\x9F]/,cn=/[ \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000]/,dn=/[!-#%-\*,-\/:;\?@\[-\]_\{\}\xA1\xA7\xAB\xB6\xB7\xBB\xBF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061E\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u09FD\u0A76\u0AF0\u0C84\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166D\u166E\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205E\u207D\u207E\u208D\u208E\u2308-\u230B\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4E\u3001-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]|\uD800[\uDD00-\uDD02\uDF9F\uDFD0]|\uD801\uDD6F|\uD802[\uDC57\uDD1F\uDD3F\uDE50-\uDE58\uDE7F\uDEF0-\uDEF6\uDF39-\uDF3F\uDF99-\uDF9C]|\uD803[\uDF55-\uDF59]|\uD804[\uDC47-\uDC4D\uDCBB\uDCBC\uDCBE-\uDCC1\uDD40-\uDD43\uDD74\uDD75\uDDC5-\uDDC8\uDDCD\uDDDB\uDDDD-\uDDDF\uDE38-\uDE3D\uDEA9]|\uD805[\uDC4B-\uDC4F\uDC5B\uDC5D\uDCC6\uDDC1-\uDDD7\uDE41-\uDE43\uDE60-\uDE6C\uDF3C-\uDF3E]|\uD806[\uDC3B\uDE3F-\uDE46\uDE9A-\uDE9C\uDE9E-\uDEA2]|\uD807[\uDC41-\uDC45\uDC70\uDC71\uDEF7\uDEF8]|\uD809[\uDC70-\uDC74]|\uD81A[\uDE6E\uDE6F\uDEF5\uDF37-\uDF3B\uDF44]|\uD81B[\uDE97-\uDE9A]|\uD82F\uDC9F|\uD836[\uDE87-\uDE8B]|\uD83A[\uDD5E\uDD5F]/;function hn(t){var e=Array.prototype.slice.call(arguments,1);return e.forEach((function(e){e&&Object.keys(e).forEach((function(n){t[n]=e[n]}))})),t}function pn(t){return Object.prototype.toString.call(t)}function fn(t){return"[object Function]"===pn(t)}function gn(t){return t.replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}var mn={fuzzyLink:!0,fuzzyEmail:!0,fuzzyIP:!1};var bn={"http:":{validate:function(t,e,n){var i=t.slice(e);return n.re.http||(n.re.http=new RegExp("^\\/\\/"+n.re.src_auth+n.re.src_host_port_strict+n.re.src_path,"i")),n.re.http.test(i)?i.match(n.re.http)[0].length:0}},"https:":"http:","ftp:":"http:","//":{validate:function(t,e,n){var i=t.slice(e);return n.re.no_http||(n.re.no_http=new RegExp("^"+n.re.src_auth+"(?:localhost|(?:(?:"+n.re.src_domain+")\\.)+"+n.re.src_domain_root+")"+n.re.src_port+n.re.src_host_terminator+n.re.src_path,"i")),n.re.no_http.test(i)?e>=3&&":"===t[e-3]||e>=3&&"/"===t[e-3]?0:i.match(n.re.no_http)[0].length:0}},"mailto:":{validate:function(t,e,n){var i=t.slice(e);return n.re.mailto||(n.re.mailto=new RegExp("^"+n.re.src_email_name+"@"+n.re.src_host_strict,"i")),n.re.mailto.test(i)?i.match(n.re.mailto)[0].length:0}}},_n="biz|com|edu|gov|net|org|pro|web|xxx|aero|asia|coop|info|museum|name|shop|".split("|");function vn(t){var e=t.re=function(t){var e={};return e.src_Any=ln.source,e.src_Cc=un.source,e.src_Z=cn.source,e.src_P=dn.source,e.src_ZPCc=[e.src_Z,e.src_P,e.src_Cc].join("|"),e.src_ZCc=[e.src_Z,e.src_Cc].join("|"),e.src_pseudo_letter="(?:(?![><]|"+e.src_ZPCc+")"+e.src_Any+")",e.src_ip4="(?:(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)",e.src_auth="(?:(?:(?!"+e.src_ZCc+"|[@/\\[\\]()]).)+@)?",e.src_port="(?::(?:6(?:[0-4]\\d{3}|5(?:[0-4]\\d{2}|5(?:[0-2]\\d|3[0-5])))|[1-5]?\\d{1,4}))?",e.src_host_terminator="(?=$|[><]|"+e.src_ZPCc+")(?!-|_|:\\d|\\.-|\\.(?!$|"+e.src_ZPCc+"))",e.src_path="(?:[/?#](?:(?!"+e.src_ZCc+"|[><]|[()[\\]{}.,\"'?!\\-;]).|\\[(?:(?!"+e.src_ZCc+"|\\]).)*\\]|\\((?:(?!"+e.src_ZCc+"|[)]).)*\\)|\\{(?:(?!"+e.src_ZCc+'|[}]).)*\\}|\\"(?:(?!'+e.src_ZCc+'|["]).)+\\"|\\\'(?:(?!'+e.src_ZCc+"|[']).)+\\'|\\'(?="+e.src_pseudo_letter+"|[-]).|\\.{2,}[a-zA-Z0-9%/&]|\\.(?!"+e.src_ZCc+"|[.]).|"+(t&&t["---"]?"\\-(?!--(?:[^-]|$))(?:-*)|":"\\-+|")+",(?!"+e.src_ZCc+").|;(?!"+e.src_ZCc+").|\\!+(?!"+e.src_ZCc+"|[!]).|\\?(?!"+e.src_ZCc+"|[?]).)+|\\/)?",e.src_email_name='[\\-;:&=\\+\\$,\\.a-zA-Z0-9_][\\-;:&=\\+\\$,\\"\\.a-zA-Z0-9_]*',e.src_xn="xn--[a-z0-9\\-]{1,59}",e.src_domain_root="(?:"+e.src_xn+"|"+e.src_pseudo_letter+"{1,63})",e.src_domain="(?:"+e.src_xn+"|(?:"+e.src_pseudo_letter+")|(?:"+e.src_pseudo_letter+"(?:-|"+e.src_pseudo_letter+"){0,61}"+e.src_pseudo_letter+"))",e.src_host="(?:(?:(?:(?:"+e.src_domain+")\\.)*"+e.src_domain+"))",e.tpl_host_fuzzy="(?:"+e.src_ip4+"|(?:(?:(?:"+e.src_domain+")\\.)+(?:%TLDS%)))",e.tpl_host_no_ip_fuzzy="(?:(?:(?:"+e.src_domain+")\\.)+(?:%TLDS%))",e.src_host_strict=e.src_host+e.src_host_terminator,e.tpl_host_fuzzy_strict=e.tpl_host_fuzzy+e.src_host_terminator,e.src_host_port_strict=e.src_host+e.src_port+e.src_host_terminator,e.tpl_host_port_fuzzy_strict=e.tpl_host_fuzzy+e.src_port+e.src_host_terminator,e.tpl_host_port_no_ip_fuzzy_strict=e.tpl_host_no_ip_fuzzy+e.src_port+e.src_host_terminator,e.tpl_host_fuzzy_test="localhost|www\\.|\\.\\d{1,3}\\.|(?:\\.(?:%TLDS%)(?:"+e.src_ZPCc+"|>|$))",e.tpl_email_fuzzy='(^|[><]|"|\\(|'+e.src_ZCc+")("+e.src_email_name+"@"+e.tpl_host_fuzzy_strict+")",e.tpl_link_fuzzy="(^|(?![.:/\\-_@])(?:[$+<=>^`|]|"+e.src_ZPCc+"))((?![$+<=>^`|])"+e.tpl_host_port_fuzzy_strict+e.src_path+")",e.tpl_link_no_ip_fuzzy="(^|(?![.:/\\-_@])(?:[$+<=>^`|]|"+e.src_ZPCc+"))((?![$+<=>^`|])"+e.tpl_host_port_no_ip_fuzzy_strict+e.src_path+")",e}(t.__opts__),n=t.__tlds__.slice();function i(t){return t.replace("%TLDS%",e.src_tlds)}t.onCompile(),t.__tlds_replaced__||n.push("a[cdefgilmnoqrstuwxz]|b[abdefghijmnorstvwyz]|c[acdfghiklmnoruvwxyz]|d[ejkmoz]|e[cegrstu]|f[ijkmor]|g[abdefghilmnpqrstuwy]|h[kmnrtu]|i[delmnoqrst]|j[emop]|k[eghimnprwyz]|l[abcikrstuvy]|m[acdeghklmnopqrstuvwxyz]|n[acefgilopruz]|om|p[aefghklmnrstwy]|qa|r[eosuw]|s[abcdeghijklmnortuvxyz]|t[cdfghjklmnortvwz]|u[agksyz]|v[aceginu]|w[fs]|y[et]|z[amw]"),n.push(e.src_xn),e.src_tlds=n.join("|"),e.email_fuzzy=RegExp(i(e.tpl_email_fuzzy),"i"),e.link_fuzzy=RegExp(i(e.tpl_link_fuzzy),"i"),e.link_no_ip_fuzzy=RegExp(i(e.tpl_link_no_ip_fuzzy),"i"),e.host_fuzzy_test=RegExp(i(e.tpl_host_fuzzy_test),"i");var a=[];function s(t,e){throw new Error('(LinkifyIt) Invalid schema "'+t+'": '+e)}t.__compiled__={},Object.keys(t.__schemas__).forEach((function(e){var n=t.__schemas__[e];if(null!==n){var i={validate:null,link:null};if(t.__compiled__[e]=i,"[object Object]"===pn(n))return!function(t){return"[object RegExp]"===pn(t)}(n.validate)?fn(n.validate)?i.validate=n.validate:s(e,n):i.validate=function(t){return function(e,n){var i=e.slice(n);return t.test(i)?i.match(t)[0].length:0}}(n.validate),void(fn(n.normalize)?i.normalize=n.normalize:n.normalize?s(e,n):i.normalize=function(t,e){e.normalize(t)});!function(t){return"[object String]"===pn(t)}(n)?s(e,n):a.push(e)}})),a.forEach((function(e){t.__compiled__[t.__schemas__[e]]&&(t.__compiled__[e].validate=t.__compiled__[t.__schemas__[e]].validate,t.__compiled__[e].normalize=t.__compiled__[t.__schemas__[e]].normalize)})),t.__compiled__[""]={validate:null,normalize:function(t,e){e.normalize(t)}};var r=Object.keys(t.__compiled__).filter((function(e){return e.length>0&&t.__compiled__[e]})).map(gn).join("|");t.re.schema_test=RegExp("(^|(?!_)(?:[><]|"+e.src_ZPCc+"))("+r+")","i"),t.re.schema_search=RegExp("(^|(?!_)(?:[><]|"+e.src_ZPCc+"))("+r+")","ig"),t.re.pretest=RegExp("("+t.re.schema_test.source+")|("+t.re.host_fuzzy_test.source+")|@","i"),function(t){t.__index__=-1,t.__text_cache__=""}(t)}function xn(t,e){var n=t.__index__,i=t.__last_index__,a=t.__text_cache__.slice(n,i);this.schema=t.__schema__.toLowerCase(),this.index=n+e,this.lastIndex=i+e,this.raw=a,this.text=a,this.url=a}function yn(t,e){var n=new xn(t,e);return t.__compiled__[n.schema].normalize(n,t),n}function wn(t,e){if(!(this instanceof wn))return new wn(t,e);var n;e||(n=t,Object.keys(n||{}).reduce((function(t,e){return t||mn.hasOwnProperty(e)}),!1)&&(e=t,t={})),this.__opts__=hn({},mn,e),this.__index__=-1,this.__last_index__=-1,this.__schema__="",this.__text_cache__="",this.__schemas__=hn({},bn,t),this.__compiled__={},this.__tlds__=_n,this.__tlds_replaced__=!1,this.re={},vn(this)}wn.prototype.add=function(t,e){return this.__schemas__[t]=e,vn(this),this},wn.prototype.set=function(t){return this.__opts__=hn(this.__opts__,t),this},wn.prototype.test=function(t){if(this.__text_cache__=t,this.__index__=-1,!t.length)return!1;var e,n,i,a,s,r,o,l;if(this.re.schema_test.test(t))for((o=this.re.schema_search).lastIndex=0;null!==(e=o.exec(t));)if(a=this.testSchemaAt(t,e[2],o.lastIndex)){this.__schema__=e[2],this.__index__=e.index+e[1].length,this.__last_index__=e.index+e[0].length+a;break}return this.__opts__.fuzzyLink&&this.__compiled__["http:"]&&(l=t.search(this.re.host_fuzzy_test))>=0&&(this.__index__<0||l<this.__index__)&&null!==(n=t.match(this.__opts__.fuzzyIP?this.re.link_fuzzy:this.re.link_no_ip_fuzzy))&&(s=n.index+n[1].length,(this.__index__<0||s<this.__index__)&&(this.__schema__="",this.__index__=s,this.__last_index__=n.index+n[0].length)),this.__opts__.fuzzyEmail&&this.__compiled__["mailto:"]&&t.indexOf("@")>=0&&null!==(i=t.match(this.re.email_fuzzy))&&(s=i.index+i[1].length,r=i.index+i[0].length,(this.__index__<0||s<this.__index__||s===this.__index__&&r>this.__last_index__)&&(this.__schema__="mailto:",this.__index__=s,this.__last_index__=r)),this.__index__>=0},wn.prototype.pretest=function(t){return this.re.pretest.test(t)},wn.prototype.testSchemaAt=function(t,e,n){return this.__compiled__[e.toLowerCase()]?this.__compiled__[e.toLowerCase()].validate(t,n,this):0},wn.prototype.match=function(t){var e=0,n=[];this.__index__>=0&&this.__text_cache__===t&&(n.push(yn(this,e)),e=this.__last_index__);for(var i=e?t.slice(e):t;this.test(i);)n.push(yn(this,e)),i=i.slice(this.__last_index__),e+=this.__last_index__;return n.length?n:null},wn.prototype.tlds=function(t,e){return t=Array.isArray(t)?t:[t],e?(this.__tlds__=this.__tlds__.concat(t).sort().filter((function(t,e,n){return t!==n[e-1]})).reverse(),vn(this),this):(this.__tlds__=t.slice(),this.__tlds_replaced__=!0,vn(this),this)},wn.prototype.normalize=function(t){t.schema||(t.url="http://"+t.url),"mailto:"!==t.schema||/^mailto:/i.test(t.url)||(t.url="mailto:"+t.url)},wn.prototype.onCompile=function(){};var kn,An=wn;function Cn(t){return document.getElementById(t)}function $n(t,e){return"string"==typeof e&&(e=""===e?[]:[e]),0===e.length?"":(e=1===e.length?e[0]:"<p>"+e.join("</p><p>")+"</p>",0!==t&&1!==t&&2!==t||(t=["info","warning","error"][t]),'<div class="msg msg-'+t+'">'+e+"</div>")}function En(t){return"checkbox"===t.type||"radio"===t.type}function Sn(t){var e=function(t){return t.hasAttribute("data-default-value")?t.getAttribute("data-default-value"):En(t)?(t.hasAttribute("data-default-checked")?t.getAttribute("data-default-checked"):t.defaultChecked)?t.value:"":t.defaultValue}(t);return En(t)?t.checked?e!==t.value:""!==e:!l("SELECT"===t.tagName?$(t).val():t.value,e)}function Dn(){this.clear()}function Mn(t){var e=new Dn,n=null;function i(t){var e=n.find("form")[0],i=n.find(".popup-body"),a=$n(2,t.error);for(var s in n.find(".msg-error").remove(),i.length?i.prepend(a):n.find("h2").after(a),t.errf||{}){var r=e[s];if(r){var o=$(r).closest(".entryi, .f-i");(o.length?o:$(r)).addClass("has-error")}}return n}function a(){gt.erase(),n.find("textarea, input").unautogrow(),n.trigger("closedialog"),n.remove(),d(document.body,"modal-open")}return t=t||{},e.push('<div class="modal" role="dialog"><div class="modal-dialog'+(t.anchor&&t.anchor!==window?"":" modal-dialog-centered")+(t.style?'" style="'+V(t.style):"")+'" role="document"><div class="modal-content"><form enctype="multipart/form-data" accept-charset="UTF-8"'+(t.form_class?' class="'+t.form_class+'"':"")+">","</form></div></div></div>"),e.push_actions=function(t){return e.push('<div class="popup-actions">',"</div>"),t&&e.push(t.join("")).pop(),e},e.show=function(s){if(!n){for(var r in(n=$(e.render()).appendTo(document.body)).find(".need-tooltip").each(gt),n.on("click",(function(t){t.target===n[0]&&a()})),n.find("button[name=cancel]").on("click",a),t.action&&(t.action instanceof HTMLFormElement?n.find("form").attr({action:t.action.action,method:t.action.method}):n.find("form").attr({action:t.action,method:t.method||"post"})),{minWidth:1,maxWidth:1,width:1})null!=t[r]&&n.children().css(r,t[r]);n.show_errors=i,n.close=a}return!1!==s&&(!function(t,e){gt.erase(),t.jquery&&(t=t[0]);for(;!u(t,"modal-dialog");)t=t.childNodes[0];var n,i=t.parentNode;if(c(i,"show"),c(document.body,"modal-open"),!u(t,"modal-dialog-centered")){var a=$(e).geometry(),s=$(window).geometry(),r=$(i).offset(),o=(a.top+a.bottom-t.offsetHeight)/2;o=Math.max(s.top+5,Math.min(s.bottom-5-t.offsetHeight,o))-r.top,t.style.top=o+"px";var l=(a.right+a.left-t.offsetWidth)/2;l=Math.max(s.left+5,Math.min(s.right-5-t.offsetWidth,l))-r.left,t.style.left=l+"px"}$(t).find("input, button, textarea, select").filter(":visible").each((function(){if(u(this,"want-focus"))return n=this,!1;n||u(this,"dangerous")||u(this,"no-focus")||(n=this)})),n&&function(t){if(t.jquery&&(t=t[0]),t.focus(),!t.hotcrp_ever_focused){if(t.select&&u(t,"want-select"))t.select();else if(t.setSelectionRange)try{t.setSelectionRange(t.value.length,t.value.length)}catch(t){}t.hotcrp_ever_focused=!0}}(n)}(n,t.anchor||window),n.find(".need-autogrow").autogrow(),n.find(".need-tooltip").each(gt)),n},e}window.markdownit.linkify=An(),window.markdownit.linkify.set({fuzzyEmail:!1,"---":!0}),$.fn.extend({geometry:function(t){var e,n;if(this[0]==window)e={left:this.scrollLeft(),top:this.scrollTop()};else{if(1==this.length&&this[0].getBoundingClientRect)return e=$.extend({},this[0].getBoundingClientRect()),(n=window.pageXOffset)&&(e.left+=n,e.right+=n),(n=window.pageYOffset)&&(e.top+=n,e.bottom+=n),"width"in e||(e.width=e.right-e.left,e.height=e.bottom-e.top),e;e=this.offset()}return e&&(e.width=t?this.outerWidth():this.width(),e.height=t?this.outerHeight():this.height(),e.right=e.left+e.width,e.bottom=e.top+e.height),e},scrollIntoView:function(t){t=t||{};for(let e=0;e!==this.length;++e){let n=$(this[e]).geometry(),i=this[e].parentNode;for(;i&&i.tagName&&"visible"===$(i).css("overflow-y");)i=i.parentNode;i=i&&i.tagName?i:window;let a=$(i).geometry();if(n.top<a.top+(t.marginTop||0)||t.atTop){let e=Math.max(n.top-(t.marginTop||0),0);i===window?i.scrollTo(i.scrollX,e):i.scrollTop=e}else if(n.bottom>a.bottom-(t.marginBottom||0)){let e=Math.max(n.bottom+(t.marginBottom||0)-a.height,0);i===window?i.scrollTo(i.scrollX,e):i.scrollTop=e}}return this},serializeWith:function(t){var e=this.serialize();if(null!=e&&t){let n=e.length&&"&"!=e[e.length-1]?"&":"";for(let i in t)null!=t[i]&&(e+=n+encodeURIComponent(i)+"="+encodeURIComponent(t[i]),n="&")}return e}}),Dn.prototype.push=function(t,e){return t&&e?(this.open.push(this.html+t),this.close.push(e),this.html="",this.open.length-1):(this.html+=t,this)},Dn.prototype.pop=function(t){var e=this.open.length;for(null==t&&(t=Math.max(0,e-1));e>t;)--e,this.html=this.open[e]+this.html+this.close[e],this.open.pop(),this.close.pop();return this},Dn.prototype.pop_n=function(t){return this.pop(Math.max(0,this.open.length-t)),this},Dn.prototype.push_pop=function(t){return this.html+=t,this.pop()},Dn.prototype.pop_push=function(t,e){return this.pop(),this.push(t,e)},Dn.prototype.pop_collapse=function(t){for(null==t&&(t=this.open.length?this.open.length-1:0);this.open.length>t;)""!==this.html&&(this.html=this.open[this.open.length-1]+this.html+this.close[this.open.length-1]),this.open.pop(),this.close.pop();return this},Dn.prototype.render=function(){return this.pop(0),this.html},Dn.prototype.clear=function(){return this.open=[],this.close=[],this.html="",this},Dn.prototype.next_htctl_id=(kn=1,function(){for(;document.getElementById("htctl"+kn);)++kn;return"htctl"+(++kn-1)});var Fn=function(){var t,e=!1;function n(n,i){var a,r;n&&"string"==typeof n&&(n=Cn(n)),n&&e&&(a=new Date(1e3*i),r=s(t?"%A %#e %b %Y %#R your time":"%A %#e %b %Y %#r your time",a),"SPAN"==n.tagName?(n.innerHTML=" ("+r+")",n.style.display="inline"):(n.innerHTML=r,n.style.display="block"))}return n.initialize=function(n,i){t=i,e=Math.abs((new Date).getTimezoneOffset()-n)>=60},n}(),Tn=[];function Nn(t){if(t)"string"==typeof t?Tn.push(Nn[t]):Tn.push(t);else for(var e=0;e<Tn.length;++e)Tn[e]()}Nn.time=function(t,e){Fn.initialize(t,e)};var jn={},Ln=1;function zn(t,e,n){var i,a,s,r,o,l;if(t instanceof Array)for(i=0;i<t.length;i++)zn(t[i],e,n);else if("string"==typeof t)o=n,null!=jn[t]&&null!=jn[t][n]&&(o=jn[t][n]),l=o||"",zn(Cn("fold"+t)||Cn(t),e,o),(a=Cn("foldsession."+t+l))?a.src=a.src.replace(/val=.*/,"val="+(e?1:0)+"&u="+Ln++):(a=Cn("foldsession."+t))&&(a.src=a.src.replace(/val=.*/,"val="+(e?1:0)+"&sub="+(n||l)+"&u="+Ln++)),!e&&(a=Cn("fold"+t+l+"_d"))&&(a.setSelectionRange&&null==a.hotcrp_ever_focused&&(a.setSelectionRange(a.value.length,a.value.length),a.hotcrp_ever_focused=!0),a.focus());else if(t&&(s="fold"+(l=n||"")+"o",r="fold"+l+"c",null==e&&t.className.indexOf(s)>=0&&(e=!0),t.className=e?t.className.replace(s,r):t.className.replace(r,s),document.recalc))try{t.innerHTML=t.innerHTML+""}catch(t){}return!1}function On(){d(this,"need-pa-grade");const t=te.closest(this),e=ne.closest(this);if(t&&e){const n=t.render(e);if(this.parentElement.replaceChild(this,n),e.update_at(n),t.landmark_range&&this.closest(".pa-gradebox")&&t.landmark_grade(this.firstChild),this.hasAttribute("data-pa-landmark-buttons")){const t=JSON.parse(this.getAttribute("data-pa-landmark-buttons"));for(let e=0;e!==t.length;++e)"string"==typeof t[e]?$(n).find(".pa-pv").append(t[e]):t[e].className&&$(n).find(".pa-pv").append('<button type="button" class="btn uic uikd pa-grade-button" data-pa-grade-button="'+t[e].className+'">'+t[e].title+"</button>")}}}function Bn(t,e,n){let i="";t.scores_editable&&t.section_has(e,(t=>t.description))&&(i+='<button class="btn ui pa-grade-toggle-description need-tooltip'.concat(n.closest(".pa-gsection").classList.contains("pa-hide-description")?" btn-primary":"",'" aria-label="Toggle description"></button>')),!t.answers_editable&&t.section_has(e,(t=>"markdown"===t.type))&&(i+='<button class="btn ui pa-grade-toggle-markdown need-tooltip" aria-label="Toggle Markdown">M</button>'),t.scores_editable&&t.section_has(e,(t=>t.answer&&"section"!==t.type))&&(i+='<button class="btn ui pa-grade-toggle-answer need-tooltip" aria-label="Toggle answer editing">E</button>');let a=n.firstChild;if(!a.classList.contains("pa-p-section")){if(""===i)return;a=document.createElement("div"),a.className="pa-p pa-p-section",a.appendChild(document.createElement("label")),a.firstChild.className="pa-pt",a.firstChild.textContent="",n.insertBefore(a,n.firstChild)}if(u(document.body,"pa-multiuser")&&t.user){let e=document.createElement("span");e.className="pa-fileref-context",e.innerText=t.user+" / ",a.firstChild.insertBefore(e,a.firstChild.firstChild)}c(n,"pa-with-sticky"),c(a,"pa-sticky");const s=a.firstChild.nextSibling;if(s&&u(s,"pa-pdesc")&&(c(s,"pa-ptop"),n.insertBefore(s,a.nextSibling)),""!==i){const t=document.createElement("div");t.className="hdr-actions btnbox",t.innerHTML=i,a.firstChild.appendChild(t)}}function In(t){let e,n,i;for(t.each((function(){if(e=this,this.getBoundingClientRect().bottom>40)return!1})),n=e.firstChild;n;){if(n.nodeType===Node.ELEMENT_NODE){if(u(n,"pa-p")&&!u(n,"pa-sticky")&&(i=n.getBoundingClientRect().bottom)>40)return{element:n,bottom:i};if(u(n,"pa-dg")&&n.firstChild){n=n.firstChild;continue}}for(;!n.nextSibling&&!u(n.parentElement,"pa-gsection");)n=n.parentElement;n=n.nextSibling}return null}function Pn(t){if(t){const e=t.element.getBoundingClientRect().bottom;window.scrollBy(0,Math.ceil(e-t.bottom))}}function Rn(){d(this,"need-pa-gradelist"),c(this,"pa-gradelist");const t=this.closest(".pa-psetinfo"),e=ne.closest(t);if(!e)return;const n={};let i=this.firstChild;for(;i;)if(u(i,"pa-grade")&&(n[i.getAttribute("data-pa-grade")]=i),u(i,"pa-dg"))i=i.firstChild;else{for(;!i.nextSibling&&u(i.parentElement,"pa-dg");)i=i.parentElement;i=i.nextSibling}for(i=this.firstChild;i&&!u(i,"pa-dg")&&!u(i,"pa-grade");)i=i.nextSibling;function a(t,e){for(;e;){const n=e;e=e.nextSibling,t.removeChild(n)}}let s=this,r=null,o=null,l=e.has((t=>t.description||t.answer||"section"===t.type||"markdown"===t.type&&!1===e.answers_editable)),h=u(this,"is-main"),p="pa-dg pa-gsection ".concat(e.scores_editable?" pa-hide-description":"",h?" is-main":"");for(let t=0;t!==e.order.length;++t){const c=e.order[t],d=e.entries[c];if(!e.scores_editable&&d.concealed)continue;let h=null;if(l&&("section"===d.type||s===this)){for(;s!==this;)a(s,i),i=s.nextSibling,s=s.parentElement;if(a(r,o),r=o=null,(!i||!u(i,"pa-gsection"))&&(h=document.createElement("div"),h.className=p,s.insertBefore(h,i),i=h,e.section_wants_sidebar(d))){h.className+=" pa-with-sidebar";const t=document.createElement("div");t.className="pa-sidebar",h.appendChild(t);const e=document.createElement("div");e.className="pa-dg is-mainsb",h.appendChild(e)}for(;i;)if(u(i,"pa-dg"))s=i,i=i.firstChild;else{if(!u(i,"pa-sidebar"))break;r=i,o=i.firstChild,i=i.nextSibling}}const f=n[c];if(f&&f===i)for(i=i.nextSibling;i&&u(i,"pa-pdesc");)i=i.nextSibling;else if(f)s.insertBefore(f,i);else{const t=d.render(e);s.insertBefore(t,i),e.update_at(t)}if(h&&Bn(e,d,s),!d.answer&&r){if("pa-sidebar"===r.className){if(null===r.firstChild){const t=document.createElement("div");t.className="pa-gradebox pa-ps",r.appendChild(t)}r=r.firstChild,o=r.firstChild}if(o&&o.getAttribute("data-pa-grade")===c)o=o.nextSibling;else{const t=d.render(e);r.insertBefore(t,o),e.update_at(t,{sidebar:!0})}}}if(a(s,i),l&&a(this,s.nextSibling),a(r,o),this.classList.contains("want-psetinfo-links")){const t=document.createElement("div");t.className="pa-psetinfo-links btnbox mt-2 mb-2 hidden",this.append(t);for(const e of[!0,!1]){const n=Hn(this,e);n&&(Wn(t,e),Wn(n.querySelector(".pa-psetinfo-links"),!e))}}}function Hn(t,e){const n=e?"previousSibling":"nextSibling",i=t.closest(".pa-psetinfo");let a=i;for(;a&&(a===i||1!==a.nodeType||!a.classList.contains("pa-psetinfo"));)a=a[n];return a}function Wn(t,e){if(t&&!t.querySelector(e?".prev":".next")){t.classList.remove("hidden");const n=document.createElement("button");n.textContent=e?"":"",n.className="ui pa-psetinfo-link "+(e?"prev":"next"),n.type="button",t[e?"prepend":"append"](n)}}b.on("js-foldup",(function(t,e){var n,i,a,s=this;if("number"==typeof e?e={n:e}:e||(e={}),"DIV"!==this.tagName||!t||!t.target.closest("a")||e.required){!("n"in e)&&s.hasAttribute("data-fold-target")&&(i=s.getAttribute("data-fold-target").match(/^(\D[^#]*$|.*(?=#)|)#?(\d*)([cou]?)$/))&&(""!==i[1]&&(s=document.getElementById(i[1])),e.n=parseInt(i[2])||0,"f"in e||""===i[3]||("u"===i[3]&&"INPUT"===this.tagName&&"checkbox"===this.type?e.f=this.checked:e.f="c"===i[3]));for(var r="fold"+(e.n||"");s&&(!s.id||"fold"!=s.id.substr(0,4))&&!u(s,"has-fold")&&(null==e.n||!u(s,r+"c")&&!u(s,r+"o"));)s=s.parentNode;if(!s)return!0;if(null==e.n){a=p(s);for(var o=0;o!==a.length;++o)"fold"===a[o].substring(0,4)&&(i=a[o].match(/^fold(\d*)[oc]$/))&&(null==e.n||+i[1]<e.n)&&(e.n=+i[1],r="fold"+(e.n||""))}if(!("f"in e)&&("INPUT"===this.tagName||"SELECT"===this.tagName)){var l=null;if("checkbox"===this.type)e.f=!this.checked;else if("radio"===this.type){if(!this.checked)return!0;l=this.value}else"select-one"===this.type&&(l=this.selectedIndex<0?"":this.options[this.selectedIndex].value);if(null!==l){var c=(s.getAttribute("data-"+r+"-values")||"").split(/\s+/);e.f=c.indexOf(l)<0}}n=!u(s,r+"c"),"f"in e&&!e.f===n||(e.f=n,zn(s,n,e.n||0),$(s).trigger(e.f?"fold":"unfold",e)),this.hasAttribute("aria-expanded")&&this.setAttribute("aria-expanded",n?"false":"true"),t&&"object"==typeof t&&"click"===t.type&&!u(t.target,"uic")&&(t.stopPropagation(),t.preventDefault())}})),b.on("js-hide-error",(function(){c(this,"hidden")})),b.on("js-pset-upload-grades",(function(){$("#upload").removeClass("hidden")})),b.on("pa-signin-radio",(function(){let t;"login"===this.value?(zn("logingroup",!1),zn("logingroup",!1,2),t="Sign in"):"forgot"===this.value?(zn("logingroup",!0),zn("logingroup",!1,2),t="Reset password"):"new"===this.value&&(zn("logingroup",!0),zn("logingroup",!0,2),t="Create account"),document.getElementById("signin").value=t})),b.on("change.pa-gradevalue",(function(){var t,e=this.closest("form"),n=this;e&&u(e,"pa-pv")?$(e).submit():"hidden"===n.type&&(t=te.closest(n))&&setTimeout((function(){t.gc.update_edit.call(t,n,+n.value,{})}),0)})),function(){function t(t){var e=$(t);e.find(".pa-gradediffers, .pa-save-message").remove(),e.append('<span class="pa-save-message compact"><span class="spinner"></span></span>');var n=ne.closest(t),i={},a={};e.find("input.pa-gradevalue, textarea.pa-gradevalue, select.pa-gradevalue").each((function(){let t,e=n.xentry(this.name);e&&null!=(t=e.value_in(n))&&(a[this.name]=t),"checkbox"!==this.type&&"radio"!==this.type||this.checked?i[this.name]=this.value:"checkbox"===this.type&&(i[this.name]=0)})),e.data("paOutstandingPromise",new Promise((function(n,s){W(L("=api/grade",{psetinfo:e[0]}),{grades:i,oldgrades:a}).then((function(i){e.removeData("paOutstandingPromise"),i.ok?(e.find(".pa-save-message").addClass("compact fadeout").html('<span class="savesuccess"></span>'),ne.store(t.closest(".pa-psetinfo"),i),n(t)):(e.find(".pa-save-message").removeClass("compact").html('<strong class="err">'+i.error+"</strong>"),s(t))}))})))}b.on("pa-pv",(function(e){e.preventDefault();var n=$(this).data("paOutstandingPromise");n?n.then(t):t(this)}))}(),b.on("pa-grade-button",(function(t){if("keydown"===t.type){var e,n=A(t);if(t.ctrlKey&&("n"===n||"N"===n||"p"===n||"P"===n||"A"===n)&&(e=this.closest(".pa-grade"))){var i=e.getAttribute("data-pa-grade"),a=$(".pa-grade[data-pa-grade="+i+"] .pa-grade-button[data-pa-grade-button="+this.getAttribute("data-pa-grade-button")+"]").filter(":visible"),s=a.toArray().indexOf(this);if(s>=0){if("n"===n||"N"===n||"p"===n||"P"===n){var r=a[(s+("n"===n||"N"===n?1:a.length-1))%a.length],o=r.closest(".pa-dg");o&&$(o).scrollIntoView({marginTop:24,atTop:!0}),r.focus(),$(r).scrollIntoView()}else a.click();t.preventDefault()}}}else"click"===t.type&&b.trigger.call(this,this.getAttribute("data-pa-grade-button"),t)})),b.on("pa-grade-toggle-description",(function(t){const e=this.closest(".pa-gsection"),n=t.metaKey?$(".pa-gsection"):$(e),i=u(e,"pa-hide-description"),a=In(n);n.each((function(){h(this,"pa-hide-description",!i),$(this).find(".pa-grade-toggle-description").toggleClass("btn-primary",!i)})),Pn(a),gt.erase()})),b.on("pa-grade-toggle-markdown",(function(t){const e=this.closest(".pa-gsection"),n=t.metaKey?$(".pa-gsection"):$(e),i=!u(this,"btn-primary"),a=In(n);n.each((function(){const t=ne.closest(this);$(this).find(".pa-grade").each((function(){"markdown"===t.entries[this.getAttribute("data-pa-grade")].type&&u(this,"pa-markdown")!==i&&(h(this,"pa-markdown",i),u(this,"e")||(t.remount_at(this,0),t.update_at(this)))})),$(this).find(".pa-grade-toggle-markdown").toggleClass("btn-primary",i)})),Pn(a),gt.erase()})),b.on("pa-grade-toggle-answer",(function(t){const e=this.closest(".pa-gsection"),n=t.metaKey?$(".pa-gsection"):$(e),i=u(this,"btn-primary")?0:2,a=In(n);n.each((function(){const t=ne.closest(this);$(this).find(".pa-grade").each((function(){t.entries[this.getAttribute("data-pa-grade")].answer&&(t.remount_at(this,i),t.update_at(this))})),$(this).find(".pa-grade-toggle-answer").toggleClass("btn-primary",0!==i)})),Pn(a),gt.erase()})),$((function(){$(".need-pa-grade").each(On),$(".need-pa-gradelist").each(Rn)})),b.on("pa-psetinfo-link",(function(){const t=Hn(this,this.classList.contains("prev"));t&&t.id&&(location.hash="#"+t.id)})),b.on("pa-notes-grade",(function(t){if("keydown"===t.type){var e,n=A(t);if(t.ctrlKey&&("n"===n||"N"===n||"p"===n||"P"===n||"A"===n)&&(e=this.closest(".pa-grade"))){var i=e.getAttribute("data-pa-grade"),a=$(".pa-grade[data-pa-grade="+i+"] .pa-notes-grade").filter(":visible"),s=a.toArray().indexOf(this);if(s>=0){if("n"===n||"N"===n||"p"===n||"P"===n){var r=a[(s+("n"===n||"N"===n?1:a.length-1))%a.length],o=r.closest(".pa-dg");o&&$(o).scrollIntoView({marginTop:24,atTop:!0}),r.focus(),$(r).scrollIntoView()}else a.click();t.preventDefault()}}}else if("click"===t.type){var l=$(this).closest(".pa-grade").find(".pa-gradevalue");l.length&&l.val()!=l.attr("data-pa-notes-grade")&&l.val(l.attr("data-pa-notes-grade")).change(),t.preventDefault()}})),$((function(){document.body.setAttribute("data-time-skew",Math.floor((new Date).getTime()/1e3)-+document.body.getAttribute("data-now"))})),$(".pa-download-timed").each((function(){var t=this,e=setInterval(n,15e3);function n(){const n=+t.getAttribute("data-pa-download-at"),i=+t.getAttribute("data-pa-commit-at"),a=+t.getAttribute("data-pa-download-expiry"),r=(new Date).getTime()/1e3+ +document.body.getAttribute("data-time-skew");let o;o=r>a?s("%Y/%m/%d %H:%M",n):Math.round((r-n)/60)+" min",i>n&&(o+="  "+Math.round((i-n)/60)+" min before commit"),$(t).find(".pa-download-timer").text(o),r>a&&clearInterval(e)}n()})),b.on("pa-anonymized-link",(function(t){var e=this.getAttribute("data-pa-link");t&&t.metaKey?window.open(e):window.location=e})),b.on("js-multiresolveflag",(function(){const t=$(this.closest("form")).find(".gtable").first(),e=t.data("paTable"),n=[];t.find(".papsel:checked").each((function(){const t=e.s(this.closest("tr").getAttribute("data-pa-spos"));n.push({psetid:t.psetid,uid:t.uid,commit:t.commit,flagid:t.flagid})})),0!==n.length?$.ajax(L("=api/multiresolveflag"),{type:"POST",cache:!1,data:{flags:JSON.stringify(n)}}):window.alert("No flags selected.")})),window.$pa={beforeunload:function(){var t=!0;if($(".pa-gw textarea").each((function(){var e=this.closest(".pa-dl"),n=Ut.at(e);l(this.value,n.text)||u(e,"pa-save-failed")||(t=!1)})),!t)return event.returnValue="You have unsaved notes. You will lose them if you leave the page now."},checklatest:function(t){var e,n=(new Date).getTime();function i(t){t&&t.commits&&$(".pa-commitcontainer").each((function(){var n=this.getAttribute("data-pa-pset"),i=this.getAttribute("data-pa-checkhash");for(var a of t.commits)if(a.pset==n&&a.commit&&a.commit!==i&&a.snaphash!==i){$(this).find(".pa-pv").append('<div class="pa-inf-error"><span class="pa-inf-alert">Newer commits are available.</span> <a href="'+L("pset",{u:siteinfo.uservalue,pset:n,commit:a.commit})+'">Load them</a></div>'),clearTimeout(e);break}}))}setTimeout((function a(){var s=(new Date).getTime(),r=$(".pa-commitcontainer[data-pa-checkhash]").length>0;e=s-n<=6e4?setTimeout(a,r?1e4:2e3):s-n<=6e5?setTimeout(a,r?2e4:1e4):s-n<=36e5?setTimeout(a,1.25*(s-n)):null,$.ajax(L("=api/latestcommit",{u:siteinfo.uservalue,pset:t}),{type:"GET",cache:!1,dataType:"json",success:i})}),2e3)},decorate_diff_page:bt.decorate_page,gradeentry_closest:te.closest,fold:zn,grgraph:function(){const t=this,e=t.getAttribute("data-pa-pset");$.ajax(L("=api/gradestatistics",e?{pset:e}:{}),{type:"GET",cache:!0,dataType:"json",success:function(e){e.series&&e.series.all&&($(t).data("paGradeData",new Ue(e)),Ke.call(t))}})},hoturl:L,note_near:Ut.near,on:b.on,onload:Nn,loadgrades:function(){if(!u(this,"pa-psetinfo"))throw new Error("bad pa_loadgrades");const t=ne.closest(this);if(!t||!t.order)return;$(this).find(".need-pa-grade").each((function(){On.call(this,!0)})),$(this).find(".pa-gradelist").each((function(){Rn.call(this,!0)})),$(this).find(".pa-grade").each((function(){t.update_at(this,{reset:!0})}));const e=[t.grade_total(),t.grade_maxtotal],n=""+e[0];let i=!1;e[0]&&$(this).find(".pa-gradelist:not(.pa-gradebox)").each((function(){$(this).find(".pa-total").length||$(this).prepend(function(t,e){var n='<div class="pa-total pa-p',i=0;for(var a in t.entries)t.entries[a].type_tabular&&++i;return i<=1&&(n+=" hidden"),n+'"><div class="pa-pt">total</div><div class="pa-pv"><span class="pa-gradevalue pa-gradewidth"></span> <span class="pa-gradedesc">of '+e[1]+"</span></div></div>"}(t,e))})),$(this).find(".pa-total").each((function(){const t=$(this).find(".pa-gradevalue");t.text()!==n&&(t.text(n),i=!0)})),i&&$(this).find(".pa-grgraph").trigger("redrawgraph")},load_runsettings:function(t){var e,n,i=$("#pa-runsettings"),a=i.find(".n");for(n in a.attr("data-outstanding","1"),t){for(e=0;e!=a.length&&$.trim($(a[0]).val())!=n;++e);e==a.length?Se(n,t[n]):$.trim(i.find("[name=v"+e+"]").val())!=t[n]&&(i.find("[name=v"+e+"]").val(t[n]),$(a[e]).removeAttr("data-outstanding"))}for(e=0;e!=a.length;++e)$(a[e]).attr("data-outstanding")&&$("[data-runsetting-num="+$(a[e]).attr("name").substr(1)+"]").remove()},pset_actions:function(){var t=$(this);function e(){var e=t.find("select[name='state']").val();t.find(".pa-if-enabled").toggleClass("hidden","disabled"===e),t.find(".pa-if-visible").toggleClass("hidden","disabled"===e||"invisible"===e)}e(),t.find("select[name='state']").on("change",e),t.find("input, select").on("change",(function(){t.find("[type='submit']").addClass("alert")})),t.removeClass("need-pa-pset-actions")},render_text_page:It.on_page,render_pset_table:function(n,i){var a,r,o,l,p,f,g,m,b,_,v,x=$(this),y=0,w=[],k=null,A=n.flagged_commits,C=n.scores_visible,E={f:A?"at":"name",last:!1,rev:1},S=-1,D=null,M=n.anonymous;function F(t){return null==t.pinned_scores_visible?C:t.pinned_scores_visible}var T={checkbox:{th:'<th class="gt-checkbox" scope="col"></th>',td:function(t,e,n){if(1&n)return"<td></td>";{let e='<td class="gt-checkbox"><input type="checkbox" value="1"';return 2&n?e+' class="uic js-range-click" data-range-type="s61o"></td>':e.concat(' name="',q(t),'" class="',this.className||"uic js-range-click papsel",'" data-range-type="s61"></td>')}},tw:1.5,pin:!0},flagcheckbox:{th:'<th class="gt-checkbox" scope="col"></th>',td:function(t,e,n){return n?"<td></td>":'<td class="gt-checkbox"><input type="checkbox" name="s:'.concat(t._spos,'" value="1" class="',this.className||"uic js-range-click papsel",'" data-range-type="s61"></td>')},tw:1.5},rownumber:{th:'<th class="gt-rownumber" scope="col"></th>',td:function(t,e){return'<td class="gt-rownumber">'+e+".</td>"},tw:.75*Math.ceil(Math.log10(Math.max(i.length,1)))+1,pin:!0},pset:{th:'<th class="gt-pset l plsortable" data-pa-sort="pset" scope="col">Pset</th>',td:function(t){return'<td class="gt-pset"><a href="'+B(t)+'" class="track">'+V(siteinfo.psets[t.psetid].title)+(t.commit?"/"+t.commit.substr(0,7):"")+"</a></td>"},tw:12,sort_forward:!0,compare:function(t,e){return t.psetid!=e.psetid?siteinfo.psets[t.psetid].pos<siteinfo.psets[e.psetid].pos?-1:1:t.pos<e.pos?-1:1}},at:{th:'<th class="gt-at l plsortable" data-pa-sort="at" scope="col">Flagged</th>',td:function(t){return'<td class="gt-at">'+(t.at?s("%#e%b%#k:%M",t.at):"")+"</td>"},tw:8,sort_forward:!0,compare:function(t,e){return t.at!=e.at?t.at<e.at?-1:1:t.pos<e.pos?-1:1}},username:{th:function(){var t='<span class="heading">'+(M||!E.email?"Username":"Email")+"</span>";return n.anonymous&&n.can_override_anonymous?t+=' <button type="button" class="btn-ulink n js-switch-anon">[anon]</button>':n.anonymous&&(t+=' <span class="n">[anon]</span>'),'<th class="gt-username l plsortable" data-pa-sort="username" scope="col">'+t+"</th>"},td:function(t){return'<td class="gt-username">'+P(t)+"</td>"},tw:12,pin:!0,sort_forward:!0},name:{th:function(){return'<th class="gt-name l plsortable" data-pa-sort="name" scope="col">Name</th>'},td:function(t){return'<td class="gt-name">'+H(t,!1)+"</td>"},tw:14,sort_forward:!0},name2:{th:function(){var t='<span class="heading">'+(M?"Username":"Name")+"</span>";return n.anonymous&&n.can_override_anonymous&&(t+=' <button type="button" class="btn-ulink n js-switch-anon">[anon]</button>'),'<th class="gt-name2 l plsortable" data-pa-sort="name2" scope="col">'+t+"</th>"},td:function(t){return'<td class="gt-name2">'+H(t,!0)+"</td>"},tw:14,sort_forward:!0},extension:{th:'<th class="gt-extension l plsortable" data-pa-sort="extension" scope="col">X?</th>',td:function(t){return t.x?'<td class="gt-extension">X</td>':'<td class="gt-extension"></td>'},tw:2,sort_forward:!0,compare:function(t,e){return t.x!=e.x?t.x?-1:1:et(t,e)}},year:{th:'<th class="gt-year c plsortable" data-pa-sort="year" scole="col">Yr</th>',td:function(t){var e="";return t.year&&(e="number"==typeof t.year?t.year>=1&&t.year<=20?String.fromCharCode(9311+t.year):t.year:1===t.year.length&&t.year>="A"&&t.year<="Z"?String.fromCharCode(9333+t.year.charCodeAt(0)):V(t.year)),'<td class="gt-year c">'.concat(e,"</td>")},tw:2,sort_forward:!0,compare:function(t,e){return t.year!=e.year?t.year&&e.year?typeof t.year!=typeof e.year?"number"==typeof t.year?-1:1:t.year<e.year?-1:1:t.year?-1:1:et(t,e)}},grader:{th:'<th class="gt-grader l plsortable" data-pa-sort="grader" scope="col">Grader</th>',td_html:function(t){return t.gradercid&&siteinfo.pc[t.gradercid]?U(siteinfo.pc[t.gradercid]):t.gradercid?"???":""},td:function(t){return'<td class="gt-grader">'.concat(this.td_html(t),"</td>")},tw:6,sort_forward:!0,compare:function(t,e){return nt(t,e)||et(t,e)}},latehours:{th:'<th class="gt-latehours r plsortable" data-pa-sort="latehours" scope="col" title="Late"></th>',td:function(t){return'<td class="gt-latehours r">'.concat(t.late_hours||"","</td>")},tw:2.5,compare:function(t,e){return t.late_hours!=e.late_hours?(t.late_hours||0)-(e.late_hours||0):et(t,e)}},notes:{th:'<th class="gt-notes c plsortable" data-pa-sort="gradestatus" scope="col"></th>',td_html:function(t){let e=F(t)?"":"";return A&&t.is_grade&&(e+=""),t.has_notes&&(e+=""),!A&&t.has_nongrader_notes&&(e+="+"),e},td:function(t){return'<td class="gt-notes c">'.concat(this.td_html(t),"</td>")},tw:2},conversation:{th:'<th class="gt-conversation l plsortable" data-pa-sort="conversation" scope="col">Flag</th>',td:function(t){return'<td class="gt-conversation l">'.concat(V(t.conversation||t.conversation_pfx||""),t.conversation_pfx?"":"","</td>")},compare:function(t,e){const n=t.conversation||t.conversation_pfx||"",i=e.conversation||e.conversation_pfx||"";return""===n||""===i?n===i?0:""===n?1:-1:n.localeCompare(i)},sort_forward:!0,tw:20},gdialog:{th:'<th class="gt-gdialog"></th>',td:function(){return'<td class="gt-gdialog"><button type="button" class="btn-xlink ui js-gdialog" tabindex="-1" scope="col"></button></td>'},tw:1.5,pin:!0},total:{th:'<th class="gt-total r plsortable" data-pa-sort="total" scope="col">Tot</th>',td:function(t){const e=null==t.total?"":t.total;return'<td class="gt-total r">'.concat(e,"</td>")},compare:function(t,e){if(null==t.total||null==e.total){if(null!=t.total)return 1;if(null!=e.total)return-1}else if(t.total!=e.total)return t.total<e.total?-1:1;return-et(t,e)},tw:3.5},grade:{th:function(){return'<th class="'.concat(this.className,' plsortable" data-pa-sort="grade',this.gidx,'" scope="col" title="',V(this.ge.title_text),'">',this.ge.abbr(),"</th>")},td_text:function(t){const e=t.grades[this.gidx];return this.ge.tcell(e)},td:function(t){const e=t.grades[this.gidx],n=t.highlight_grades&&t.highlight_grades[this.gkey];return'<td class="'.concat(n?"gt-highlight ":"",this.className,'">',V(this.ge.tcell(e)),"</td>")},tw:function(){const t=.5*this.ge.abbr().length+1.5;return Math.max(t,this.ge.tcell_width())}},ngrades:{th:'<th class="gt-ngrades r plsortable" data-pa-sort="ngrades" scope="col">#G</th>',td:function(t){return'<td class="gt-ngrades r">'+(t.ngrades_nonempty||"")+"</td>"},tw:2,sort_forward:!0,compare:function(t,e){return t.ngrades_nonempty!==e.ngrades_nonempty?t.ngrades_nonempty<e.ngrades_nonempty?-1:1:-et(t,e)}},repo:{th:'<th class="gt-repo" scope="col"></th>',td:function(t){var e;return e=t.repo?M?'<a href="" data-pa-link="'.concat(V(t.repo),'" class="ui pa-anonymized-link">repo</a>'):'<a class="track" href="'.concat(V(t.repo),'">repo</a>'):"",t.repo_broken&&(e+=' <strong class="err">broken</strong>'),t.repo_unconfirmed&&(e+=' <strong class="err">unconfirmed</strong>'),t.repo_too_open&&(e+=' <strong class="err">open</strong>'),t.repo_handout_old&&(e+=' <strong class="err">handout</strong>'),t.repo_partner_error&&(e+=' <strong class="err">partner</strong>'),t.repo_sharing&&(e+=' <strong class="err">sharing</strong>'),'<td class="gt-repo">'.concat(e,"</td>")},tw:10}};function N(t){return function(){return t}}function j(){"name"!==E.f&&"name2"!==E.f&&"username"!==E.f&&"email"!==E.f&&null!=E.nameflag||(E.nameflag=0,"name"!==E.f&&"name2"!==E.f||(E.nameflag|=1),E.last&&(E.nameflag|=2),E.email&&(E.nameflag|=4),M&&(E.nameflag|=8))}function z(t){return M&&t.anon_username||t.username||""}function O(t){var e={u:z(t),pset:t.psetid?siteinfo.psets[t.psetid].urlkey:n.key};return!t.commit||t.is_grade&&!A?t.gradecommit&&(e.commit=t.gradecommit,e.commit_is_grade=1):e.commit=t.commit,e}function B(t){return V(L("pset",O(t)))}function I(t,e){return'<a href="'.concat(B(e),'" class="track',e.dropped?' gt-dropped">':'">',t,"</a>")}function P(t){return I(V(M&&t.anon_username?t.anon_username:E.email&&t.email?t.email:t.username||""),t)}function R(t,e){return null!=t.first&&null!=t.last?e?t.last.concat(", ",t.first):t.first.concat(" ",t.last):null!=t.first?t.first:null!=t.last?t.last:""}function H(t,e){var n=V(e&&M?t.anon_username||"?":R(t,D));return e?I(n,t):n}function q(t){var e=M&&t.anon_username||t.username;return"s:"+encodeURIComponent(e).replace(/\./g,"%2E")}function U(t){return t.__nickname||(t.nick?t.__nickname=t.nick:t.nicklen||t.lastpos?t.__nickname=t.name.substr(0,t.nicklen||t.lastpos-1):t.__nickname=t.name),t.__nickname}function Z(t){var e,n,a=t.children("tbody"),s=t.children("thead")[0].firstChild.childNodes.length,r=a[0],o=function(t){for(var e={},n=t.find("tbody")[0].firstChild,i=null;n;)n.hasAttribute("data-pa-partner")?i.push(n):e[n.getAttribute("data-pa-spos")]=i=[n],n=n.nextSibling;return e}(t),l=0,h=!1,p=r.firstChild;for(e=0;e!==i.length;++e){for(var f=i[e];(n=p)&&"gt-boring"===n.className;)p=p.nextSibling,r.removeChild(n);f.boringness!==h&&!1!==h&&r.insertBefore($('<tr class="gt-boring"><td colspan="'+s+'"><hr></td></tr>')[0],p),h=f.boringness;var g=o[f._spos];for(n=0;n<g.length;++n)p!==g[n]?r.insertBefore(g[n],p):p=p.nextSibling,d(g[n],"k"+(1-l%2)),c(g[n],"k"+l%2);++l}l=0,a.find(".gt-rownumber").html((function(){return++l+"."}));var m=E.f&&E.last;m!==D&&(D=m,a.find(".gt-name, .gt-name2").html((function(){return H(w[this.parentNode.getAttribute("data-pa-spos")],u(this,"gt-name2"))})))}function K(){for(var t=[],e=0;e!==i.length;++e)t.push(z(i[e]));r.value=t.join(" ")}function J(){Z(x),k&&Z(k),r&&K(),t.site(!0,"pa-pset"+n.id+"-table",JSON.stringify(E))}function Y(){for(var t={},e=x.find("tbody")[0].firstChild;e;)t[e.getAttribute("data-pa-uid")]=e,e=e.nextSibling;return t}function G(){var t=k?$([x[0],k[0]]):x;t.find("td.gt-username").each((function(){var t=w[this.parentNode.getAttribute("data-pa-spos")];$(this).html(P(t))})),t.find("th.gt-username > span.heading").html(M||!E.email?"Username":"Email"),t.find("td.gt-name2").each((function(){var t=w[this.parentNode.getAttribute("data-pa-spos")];$(this).html(H(t,!0))})),t.find("th.gt-name2 > span.heading").html(M?"Username":"Name")}function X(){x.toggleClass("gt-anonymous",!!M),y&&a&&(x.css("width",y-(M?a.width:0)+"px"),$(x[0].firstChild).find(".gt-name").css("width",(M?0:a.width)+"px"))}function Q(t){(M=!M)||(E.override_anonymous=!0),X(),G(),x.find("tbody input.gt-check").each((function(){var t=w[this.parentNode.parentNode.getAttribute("data-pa-spos")];this.setAttribute("name",q(t))})),it(),J(),x.closest("form").find("input[name=anonymous]").val(M?1:0),t.preventDefault(),t.stopPropagation()}function tt(t){let n="";return 8&S&&t.anon_username?n=t.anon_username+" ":1&S&&(n=R(t,2==(2&S))+" "),4&S&&t.email?n+=t.email:n+=t.username||"",null!=t.psetid&&(n+=e(" %5d",t.psetid)),null!=t.at&&(n+=e(" %11g",t.at)),n.toLowerCase()}function et(t,e){return t._sort_user.localeCompare(e._sort_user)}function nt(t,e){var n=t.gradercid?siteinfo.pc[t.gradercid]:null,i=e.gradercid?siteinfo.pc[e.gradercid]:null,a=n&&U(n)||"~~~",s=i&&U(i)||"~~~";return a!=s?a<s?-1:1:0}function it(){let t=E.f;!function(){if(E.nameflag!==S){S=E.nameflag;for(var t=0;t<i.length;++t)i[t]._sort_user=tt(i[t])}}();let e=b[t];e&&e.compare?i.sort(e.compare):e&&e.make_compare?i.sort(e.make_compare(E)):"name"!==t&&"name2"!==t||M?"gradestatus"===t?i.sort((function(t,e){const n=F(t);return n!==F(e)?n?-1:1:t.has_notes!=e.has_notes?t.has_notes?-1:1:nt(t,e)||et(t,e)})):E.email&&!M?(t="username",i.sort((function(t,e){var n=(t.email||"").toLowerCase(),i=(e.email||"").toLowerCase();return n!==i?""===n||""===i?""===n?1:-1:n<i?-1:1:et(t,e)}))):("name2"!==t&&(t="username"),i.sort(et)):i.sort(et),E.rev<0&&i.reverse(),i.sort((function(t,e){return t.boringness!==e.boringness?t.boringness-e.boringness:0}));var n=k?$([x[0].firstChild,k[0].firstChild]):$(x[0].firstChild);n.find(".plsortable").removeClass("plsortactive plsortreverse"),n.find("th[data-pa-sort='"+t+"']").addClass("plsortactive").toggleClass("plsortreverse",E.rev<0)}function at(){if(!this.hasAttribute("data-pa-sort"))return;const t=this.getAttribute("data-pa-sort");if(t!==E.f){E.f=t;const e=b[t];E.rev=e&&e.sort_forward?1:-1}else"name"===t||"name2"===t&&!M?(E.rev=-E.rev,1===E.rev&&(E.last=!E.last)):"username"===t?(-1!==E.rev||M||(E.email=!E.email,G()),E.rev=-E.rev):E.rev=-E.rev;j(),it(),J()}function st(){const t=this.getAttribute("data-range-type");if("s61"===t&&k||"s61o"===t){const e="s61"===t,n=this.closest("tbody"),i=(e?k:x)[0].tBodies[0];let a=n.firstChild,s=i.firstChild,r=this.closest("tr");for(;a!==r;)a=a.nextSibling,s=s.nextSibling;s.querySelector("[data-range-type="+(e?"s61o]":"s61]")).checked=this.checked}}function rt(t,e,i){const a=t[e.uid],s=w[a.getAttribute("data-pa-spos")];let r=0;for(let t=0;t!==i.length;++t){let o,l=i[t],u=n.grades.entries[l];u&&null!=u.gpos&&(o=m[u.colpos])&&(s.grades[u.gpos]!==e.grades[t]&&(s.grades[u.gpos]=e.grades[t],a.childNodes[u.colpos].innerText=o.td_text.call(o,s)),null!=e.grades[t]&&""!==e.grades[t]&&++r)}if(e.total!==s.total&&(s.total=e.total,_)){const t=null==s.total?"":s.total;a.childNodes[_].innerText=t}r!==s.ngrades_nonempty&&(s.ngrades_nonempty=r,v&&(a.childNodes[v].innerText=s.ngrades_nonempty||""))}function ot(t,e){const n=t[e.uid],i=w[n.getAttribute("data-pa-spos")],a=b.grader,s=b.notes;Object.assign(i,e),a&&(n.childNodes[a.index].innerHTML=a.td_html.call(a,i)),s&&(n.childNodes[s.index].innerHTML=s.td_html.call(s,i))}function lt(t){o.find(".has-error").removeClass("has-error"),t.ok?o.find(".pa-messages").html(""):(o.find(".pa-messages").html($n(2,V(t.error))),t.errf&&o.find(".pa-gradevalue").each((function(){t.errf[this.name]&&c(this,"has-error")})))}function ut(){const t=o.find(".pa-gdialog-gradesheet input"),e=[],i=[];for(let i=0;i!==t.length;++i)t[i].checked&&e.push(n.grades.entries[t[i].name]);for(let t of p)i.push(t.uid);if(0===e.length)alert("No grades selected.");else{const t={pset:n.key,anonymous:M?1:"",users:i.join(" ")};1===e.length&&e[0].landmark_range_file&&(t.file=e[0].landmark_range_file,t.lines=e[0].landmark_range_first+"-"+e[0].landmark_range_last),t.grade=e[0].key;for(let n=1;n!==e.length;++n)t.grade+=" "+e[n].key;!function(t,e){const n=document.createElement("form");n.setAttribute("method","post"),n.setAttribute("enctype","multipart/form-data"),n.setAttribute("accept-charset","UTF-8"),n.action=L(t,e);const i=document.createElement("input");i.type="hidden",i.name="____empty____",i.value="1",n.appendChild(i),document.body.appendChild(n),n.submit()}("=diffmany",t)}}function ct(t){const e=o.find("button[name=mode-gradesheet]").hasClass("btn-primary");let i=!1,a={};if(e){if(!t)return void ut()}else o.find(".pa-gradevalue").each((function(){if((this.hasAttribute("data-pa-unmixed")||Sn(this))&&!this.indeterminate){let t,e=this.name,s=n.grades.entries[e];t="checkbox"===this.type?this.checked?this.value:"":$(this).val();for(let n of p)a[n.uid]=a[n.uid]||{grades:{},oldgrades:{}},a[n.uid].grades[e]=t,a[n.uid].oldgrades[e]=n.grades[s.gpos];i=!0}}));if(t=t||function(){o.close()},i)if(1===p.length)W(L("=api/grade",O(p[0])),a[p[0].uid]).then((function(e){lt(e),e.ok&&(rt(Y(),e,e.value_order||e.order),t())}));else{for(let t of p)t.gradecommit?(a[t.uid].commit=t.gradecommit,a[t.uid].commit_is_grade=1):t.commit&&(a[t.uid].commit=t.commit);W(L("=api/multigrade",{pset:n.key}),{us:JSON.stringify(a)}).then((function(e){if(lt(e),e.ok){const n=Y();for(let t of e.us)rt(n,t,e.value_order||e.order);t()}}))}else t()}function dt(){const t=this.getAttribute("data-pa-spos");ct((function(){ht([t])}))}function ht(t){p=[];for(let e=0;e!==t.length;++e)p.push(w[t[e]]);o.find("h2").html(V(n.title)+" : "+p.map((function(t){return V(M?t.anon_username:t.username||t.email)})).join(", ")),1===p.length?function(t){let e;e=t.first||t.last?t.first.concat(" ",t.last," <",t.email,">"):"<".concat(t.email,">"),o.find(".gt-name-email").html(V(e)).removeClass("hidden");let n,i=x.find("tbody")[0].firstChild;for(;i&&i.getAttribute("data-pa-spos")!=t._spos;)i=i.nextSibling;for(n=i;n&&(n===i||!n.hasAttribute("data-pa-spos"));)n=n.previousSibling;for(o.find("button[name=prev]").attr("data-pa-spos",n?n.getAttribute("data-pa-spos"):"").prop("disabled",!n),n=i;n&&(n===i||!n.hasAttribute("data-pa-spos"));)n=n.nextSibling;o.find("button[name=next]").attr("data-pa-spos",n?n.getAttribute("data-pa-spos"):"").prop("disabled",!n)}(p[0]):o.find(".gt-name-email").addClass("hidden"),o.find(".pa-grade").each((function(){let t=this.getAttribute("data-pa-grade"),e=n.grades.entries[t],i=p[0].grades[e.gpos],a={reset:!0,mixed:!1};for(let t=1;t!==p.length;++t){let n=p[t].grades[e.gpos];if(!(n===i||null==n&&""===i||""===n&&null==i)){i=null,a.mixed=!0;break}}e.update_at(this,i,a)}))}function pt(t){let e;!t.ctrlKey||"n"!==t.key&&"p"!==t.key||!(e=o.find("button[name="+("n"===t.key?"next":"prev")+"]"))||e[0].disabled?"Return"===t.key||"Enter"===t.key?(ct(null),t.stopImmediatePropagation(),t.preventDefault()):"Esc"===t.key||"Escape"===t.key?(t.stopImmediatePropagation(),o.close()):"Backspace"===t.key&&this.hasAttribute("placeholder")&&this.closest(".pa-gradelist")&&ft.call(this):(dt.call(e[0]),t.stopImmediatePropagation(),t.preventDefault())}function ft(){d(this,"has-error"),this.hasAttribute("placeholder")&&(this.setAttribute("data-pa-unmixed",1),this.removeAttribute("placeholder"),gt.call(this))}function gt(){h(this.closest(".pa-pv"),"pa-grade-changed",this.hasAttribute("data-pa-unmixed")||Sn(this))}function mt(t){if("click"===t.type&&!t.shiftKey){const t=this.checked;let e=this.closest("label");for(;e=e.nextSibling;){const n=e.firstChild.firstChild;if(n.classList.contains("pa-gdialog-section"))break;n.checked=t}}}function bt(){const t=o.find(".pa-gradelist")[0];if(!t.firstChild){const e=ne.closest(t);for(let n=0;n!==f.length;++n)t.appendChild(f[n].render(e,1))}o.find(".pa-gdialog-tab").addClass("hidden"),t.classList.remove("hidden"),o.find("button[name=bsubmit]").text("Save").removeClass("hidden")}function _t(){const t=o.find(".pa-gdialog-settings")[0],e=t.closest("form"),i={};for(let t of p)i[t.uid]={uid:t.uid};if("save-gvis"===this.name){let e;$(t).find(".pa-gvis").each((function(){this.checked&&!this.indeterminate&&(e=JSON.parse(this.value))}));for(let t of p)i[t.uid].pinned_scores_visible=e}else if("save-grader"===this.name&&"clear"===e.elements.gradertype.value)for(let t of p)i[t.uid].gradercid=0;else if("save-grader"===this.name&&"previous"===e.elements.gradertype.value)for(let t of p)i[t.uid].gradercid="previous";else if("save-grader"===this.name){let e=[],n=[],a=0;if($(t).find(".pa-grader").each((function(){this.checked&&!this.indeterminate&&(e.push(+this.name.substring(6)),n.push(1),++a)})),a)for(let t of p){let s=Math.floor(Math.random()*a),r=0;for(;s>=n[r];)s-=Math.max(n[r],0),++r;if(i[t.uid].gradercid=e[r],a-=Math.min(n[r],1),--n[r],a<=0)for(r in a=0,n)++n[r],a+=Math.max(n[r],0)}}this.disabled=!0;const a=[];for(let t of p)a.push(i[t.uid]);const s=document.createElement("progress");s.max=a.length,s.className="float-right",this.after(s);let r=0;!function t(){const e=a.slice(r,r+16);r+=e.length,W(L("=api/gradesettings",{pset:n.key}),{us:JSON.stringify(e)},{timeout:2e4}).then((function(e){if(lt(e),s.value=r,e.ok&&e.us){const t=Y();for(let n of e.us)ot(t,n)}e.ok&&r<a.length?t():o.close()}))}()}function vt(){const t=o.find(".pa-gdialog-settings")[0];$(t).find(".pa-gvis").prop("checked",!1).prop("indeterminate",!1),this.checked=!0}function xt(){const t=o.find(".pa-gdialog-settings")[0],e=this;$(t).find(".pa-grader:indeterminate").each((function(){e!==this&&this.indeterminate&&(this.checked=!1),this.indeterminate=!1})),this.checked?t.closest("form").elements.gradertype.value="set":setTimeout((function(){0===$(t).find(".pa-grader:checked").length&&(t.closest("form").elements.gradertype.value="clear")}),0)}function yt(){o.find(".nav-pills button").removeClass("btn-primary"),"mode-gradesheet"===this.name?function(){const t=o.find(".pa-gdialog-gradesheet")[0];if(!t.firstChild){const e=new Dn;let i=!1;for(let t=0;t!==n.grades.order.length;++t){const a=n.grades.entries[n.grades.order[t]],s=i&&"section"!==a.type?"checki ml-4":"checki",r="section"===a.type?" pa-gdialog-section":"";e.push('<label class="'.concat(s,'"><span class="checkc"><input type="checkbox" name="',a.key,'" class="uic js-range-click',r,'" data-range-type="mge"></span>',a.title_html,"</label>")),i=i||"section"===a.type}t.innerHTML=e.render()}o.find(".pa-gdialog-tab").addClass("hidden"),t.classList.remove("hidden"),o.find("button[name=bsubmit]").text("Edit gradesheet").removeClass("hidden")}():"mode-settings"===this.name?function(){const t=o.find(".pa-gdialog-settings")[0],e=t.closest("form");if(!t.firstChild){const e=new Dn;e.push('<fieldset class="mb-3"><legend>Grade visibility</legend>',"</fieldset>"),e.push('<label class="checki"><span class="checkc"><input type="checkbox" name="gvis" value="true" class="uic pa-gvis"></span>Visible</label>'),e.push('<label class="checki"><span class="checkc"><input type="checkbox" name="gvis" value="false" class="uic pa-gvis"></span>Hidden</label>'),e.push('<label class="checki"><span class="checkc"><input type="checkbox" name="gvis" value="null" class="uic pa-gvis"></span>Default ('+(n.scores_visible?"visible":"hidden")+")</label>"),e.push('<div class="popup-actions"><button type="button" class="btn btn-primary" name="save-gvis">Save</button></div>'),e.pop(),e.push("<fieldset><legend>Grader</legend>","</fieldset>"),e.push('<label class="checki"><span class="checkc"><input type="radio" name="gradertype" value="clear" class="uic"></span>Clear</label>'),e.push('<label class="checki"><span class="checkc"><input type="radio" name="gradertype" value="set" class="uic"></span>Set grader</label>'),e.push('<div class="checki mt-1 multicol-3">',"</div>");for(let t=0;t!==siteinfo.pc.__order__.length;++t){const n=siteinfo.pc.__order__[t],i=siteinfo.pc[n];e.push('<label class="checki"><span class="checkc"><input type="checkbox" name="grader'.concat(n,'" class="uic js-range-click pa-grader" data-range-type="grader"></span>',V(i.name),'<span class="ct small dim"></span></label>'))}e.pop(),e.push('<div class="popup-actions"><button type="button" class="btn btn-primary" name="save-grader">Save</button></div>'),t.innerHTML=e.render(),$(t).on("click","button",_t),$(t).on("click",".pa-grader",xt),$(t).on("click",".pa-gvis",vt)}const i={},a={},s={};for(let t of p){null==t.pinned_scores_visible?i.null=(i.null||0)+1:t.pinned_scores_visible?i.true=(i.true||0)+1:i.false=(i.false||0)+1;const e=t.gradercid||0;a[e]=(a[e]||0)+1}for(let t of w){const e=t.gradercid||0;s[e]=(s[e]||0)+1}$(t).find("input").prop("checked",!1).prop("indeterminate",!1);for(let e in i)$(t).find(".pa-gvis[value="+e+"]").prop("checked",!!i[e]).prop("indeterminate",i[e]&&i[e]!==p.length);$(t).find("input[name=gradertype][value="+((a[0]||0)===p.length?"clear":"set")+"]").prop("checked",!0);for(let t in a)if(0!=t){const n=e.elements["grader"+t];n.checked=!0,n.indeterminate=a[t]!==p.length}$(t).find(".pa-grader").each((function(){const t=+this.name.substring(6),e=a[t]||0,n=s[t]||0;this.closest(".checki").lastChild.textContent=n&&e===n?" (".concat(n,")"):n?" (".concat(e,"/",n,")"):""})),o.find(".pa-gdialog-tab").addClass("hidden"),t.classList.remove("hidden"),o.find("button[name=bsubmit]").addClass("hidden")}():bt(),this.classList.add("btn-primary")}function wt(){l=this;const t=Mn();t.push("<h2></h2>"),M||t.push('<strong class="gt-name-email"></strong>'),t.push('<div class="pa-messages"></div>'),t.push('<div class="nav-pills">',"</div>"),t.push('<button type="button" class="btn btn-primary no-focus is-mode" name="mode-values">Values</button>'),t.push('<button type="button" class="btn no-focus is-mode" name="mode-gradesheet">Gradesheet</button>'),t.push('<button type="button" class="btn no-focus is-mode" name="mode-settings">Settings</button>'),t.pop(),t.push('<div class="pa-gdialog-tab pa-gradelist is-modal"></div>'),t.push('<div class="pa-gdialog-tab pa-gdialog-gradesheet multicol-3 hidden"></div>'),t.push('<div class="pa-gdialog-tab pa-gdialog-settings hidden"></div>'),t.push_actions(),t.push('<button type="button" name="bsubmit" class="btn-primary">Save</button>'),t.push('<button type="button" name="cancel">Cancel</button>'),t.push('<span class="btnbox"><button type="button" name="prev" class="btnl">&lt;</button><button type="button" name="next" class="btnl">&gt;</button></span>'),(o=t.show(!1)).children(".modal-dialog").addClass("modal-dialog-wide"),o.find("form").addClass("pa-psetinfo").data("pa-gradeinfo",n.grades),bt(),o.on("click",".pa-gdialog-section",mt),o.on("change blur",".pa-gradevalue",gt),o.on("input change",".pa-gradevalue",ft),o.on("keydown",pt),o.on("keydown","input, textarea, select",pt),o.find("button[name=bsubmit]").on("click",(function(){ct(null)})),o.find("button[name=prev], button[name=next]").on("click",dt),o.find("button.is-mode").on("click",yt);const e=x.find(".papsel:checked").toArray().map((function(t){return t.parentElement.parentElement.getAttribute("data-pa-spos")})),i=l.closest("tr").getAttribute("data-pa-spos");e.indexOf(i)<0?ht([i]):(o.find("button[name=prev], button[name=next]").prop("disabled",!0).addClass("hidden"),ht(e)),t.show()}function kt(){let t=0;for(;t!==m.length&&!m[t].pin;)++t;var e=$('<div style="position:absolute;left:0;top:0;bottom:0;width:'+(m[t].left-10)+'px;pointer-events:none"></div>').prependTo(x.parent())[0],n=!1,i=!1;var a=new IntersectionObserver((function(t){for(var a of t)a.target===e?i=a.isIntersecting:n=a.isIntersecting;!n||i||k?n&&i&&k&&(k.parent().remove(),k=null):function(){let t,e,n=0,i=0,a=[];for(;n!==m.length&&!m[n].pin;)++n;for(t=n;t!==m.length&&m[t].pin;++t)i+=m[t].width;e='<table class="gtable gtable-fixed gtable-overlay new" style="position:absolute;left:-24px;width:'+(i+24)+'px"><thead><tr class="gt k0 kfade"><th style="width:24px"></th>';for(let i=n;i!==t;++i)e+='<th style="width:'+m[i].width+'px"'+m[i].th.call(m[i]).substring(3);k=$(e+"</thead><tbody></tbody></table>");var s=x[0].firstChild.firstChild,r=k[0].firstChild.firstChild;for(let e=n;e!==t;++e)r.childNodes[e-n+1].className=s.childNodes[e].className;x[0].parentNode.prepend($('<div style="position:sticky;left:0;z-index:2"></div>').append(k)[0]),k.find("thead").on("click","th",at),k.find("tbody").on("click","input[type=checkbox]",st),k.find(".js-switch-anon").click(Q),s=x.children("tbody")[0].firstChild;let o=0;for(;s;){if(u(s,"gt-boring"))a.push('<tr class="gt-boring"><td colspan="'+(t-n+1)+'"><hr></td></tr>');else{let e=s.getAttribute("data-pa-spos"),i='<tr class="'.concat(s.className,' kfade" data-pa-spos="',e);s.hasAttribute("data-pa-uid")&&(i+='" data-pa-uid="'+s.getAttribute("data-pa-uid"));let r=2;s.hasAttribute("data-pa-partner")?(i+='" data-pa-partner="1',r|=1):++o,i+='"><td></td>';for(let a=n;a!==t;++a)i+=m[a].td.call(m[a],w[e],o,r);a.push(i+"</tr>")}s=s.nextSibling}k.find("tbody").html(a.join("")),x.find("input[data-range-type=s61]:checked").each(st),setTimeout((function(){k&&d(k[0],"new")}),0)}()}));a.observe(e),a.observe(x.parent()[0])}function At(t,e,n){const i=[];for(let a=0;a!==m.length;++a)i.push(m[a].td.call(m[a],t,e,n));return i}function Ct(t,e){const n=document.createElement("template");return n.innerHTML=e.join(""),t.appendChild(n.content),[]}x.parent().on("click",".js-gdialog",(function(t){wt.call(this),t.preventDefault()})),function(){var e=t.site(!0,"pa-pset"+n.id+"-table");if(e&&(E=JSON.parse(e)),E.f&&/^\w+$/.test(E.f)||(E.f="name"),1!==E.rev&&-1!==E.rev&&(E.rev=1),M&&n.can_override_anonymous&&E.override_anonymous||delete E.override_anonymous,M&&E.override_anonymous&&(M=!1),null==E.nameflag&&j(),f=[],n.grades){n.grades=new ne(n.grades);for(let t=0;t!==n.grades.value_order.length;++t){const e=n.grades.value_order[t],i=n.grades.entries[e];i.type_tabular&&f.push(i)}}let s=-1,o=!1;for(let t=0;t<i.length;++t){const e=i[t];e.dropped?e.boringness=2:e.emptydiff||!e.gradecommit&&!e.commit&&!n.gitless_grades?e.boringness=1:e.boringness=0;let a=0;for(var l=0;l!==f.length;++l)f[l].key!=n.total_key&&null!=e.grades[l]&&""!==e.grades[l]&&++a;e.ngrades_nonempty=a,-1===s?s=a:s!==a&&(!e.boringness||a>0)&&(s=-2),o=o||!!e.late_hours}if(g=-2===s,n.col)m=n.col;else{m=[],n.checkbox&&m.push(n.flagged_commits?"flagcheckbox":"checkbox"),m.push("rownumber"),A?(m.push("pset"),m.push("at")):m.push("gdialog"),m.push("username","name","extension","year","grader"),o&&m.push("latehours"),A&&m.push("conversation"),(A||!n.gitless_grades||C)&&m.push("notes"),n.need_total&&(_=m.length,m.push("total"));for(let t=0;t!==f.length;++t){const e=f[t];e.gpos=t,e.colpos=m.length,m.push(e.configure_column({type:"grade",name:"grade"+t,gidx:t,gkey:e.key},n))}g&&(v=m.length,m.push("ngrades")),n.gitless||m.push("repo")}b={};for(let t=0;t!==m.length;++t)"string"==typeof m[t]&&(m[t]={type:m[t],name:m[t]}),m[t].index=t,Object.assign(m[t],T[m[t].type]),"string"==typeof m[t].th&&(m[t].th=N(m[t].th)),b[m[t].name]=b[m[t].name]||m[t];a=b.name,x[0].closest("form")&&(r=$('<input name="slist" type="hidden" value="">')[0],x.after(r))}(),function(){const t=x.hasClass("want-gtable-fixed"),e=parseFloat(window.getComputedStyle(document.documentElement).fontSize);let a=['<tr class="gt k0">'];for(const n of m)if(a.push(n.th.call(n)),t){let t=n.tw;"number"!=typeof t&&(t=t.call(n)),t*=e,n.left=y,n.width=t,y+=t}const s=document.createElement("thead");if(a=Ct(s,a),t){let t=s.firstChild.firstChild;for(const e of m)t.style.width=e.width+"px",t=t.nextSibling}X(),x[0].appendChild(s),x.toggleClass("gt-useemail",!!E.email),x.find("thead").on("click","th",at),x.find(".js-switch-anon").click(Q),t&&x.removeClass("want-gtable-fixed").css("table-layout","fixed");const o=$('<tbody class="has-hotlist"></tbody>')[0];x[0].appendChild(o),n.no_sort||it(),D="name"===E.f&&E.last;let l=0,u=0;for(let t=0;t!==i.length;++t){const e=i[t];e._spos=w.length,w.push(e),++l,e.boringness!==u&&1!=l&&a.push('<tr class="gt-boring"><td colspan="'+m.length+'"><hr></td></tr>'),u=e.boringness;const n=At(e,l);let s='<tr class="gt k'.concat(l%2,'" data-pa-spos="',e._spos);e.uid&&(s+='" data-pa-uid="'+e.uid),a.push(s.concat('">',n.join(""),"</tr>"));for(let t=0;e.partners&&t<e.partners.length;++t){const i=e.partners[t];i._spos=w.length,w.push(i);const r=At(e.partners[t],l,1);for(let t=0;t<r.length;++t)r[t]===n[t]&&(r[t]="<td></td>");s='<tr class="gt k'.concat(l%2,' gtrow-partner" data-pa-spos="',i._spos),i.uid&&(s+='" data-pa-uid="'+i.uid),a.push(s.concat('" data-pa-partner="1">',r.join(""),"</tr>"))}a.length>50&&(a=Ct(o,a))}0!==a.length&&Ct(o,a),r&&K(),x.find("tbody").on("click","input[type=checkbox]",st),t&&window.IntersectionObserver&&kt()}(),x.data("paTable",{name_text:function(t){var e,n=x.find("tr[data-pa-uid="+t+"]").attr("data-pa-spos");return n?(e=w[n])?(M?e.anon_username:R(e,D))||"?":"[none]":null},s:function(t){return i[t]}}),x.children("tbody").on("pa-hotlist",(function(t){for(var e=[],a=0;a<i.length;++a){var s=i[a],r="~".concat(encodeURIComponent(z(s)));A&&(r=r.concat("/pset/",siteinfo.psets[s.psetid].urlkey),s.commit&&(r=r.concat("/",s.commit))),e.push(r)}t.hotlist={pset:A?null:n.key,items:e}}))},runmany:function(t){const n=document.getElementById("pa-runmany-form");let i;function a(){u(n,"pa-run-active")?i||(i=setTimeout(a,2e3)):$.ajax(L("=api/runchainhead",{chain:t}),{type:"POST",cache:!1,dataType:"json",timeout:3e4,success:s})}function s(t){if(i&&clearTimeout(i),i=null,t&&t.ok&&t.queueid){n.elements.u.value=t.u,n.elements.pset.value=t.pset;let e=$('<a href="'+siteinfo.site_relative+"~"+encodeURIComponent(t.u)+"/pset/"+t.pset+'" class="q ansib ansifg7"></a>');e.text(t.u),Ee(n.elements.run,{noclear:!0,queueid:t.queueid,timestamp:t.timestamp,headline:e[0],done_function:a})}t&&null!=t.njobs&&function(t){let i=document.getElementById("pa-runmany-progress");i||($("#run-"+n.elements.run.value).after('<div>Progress: <progress id="pa-runmany-progress" class="ml-3 mr-3"></progress></div>'),i=document.getElementById("pa-runmany-progress")),i.max=Math.max(i.max,t+1),i.value=i.max-t,i.textContent=e("%d%%",i.value/i.max),0===t&&i.after("Done!")}(t.njobs),t&&0===t.njobs||(i=setTimeout(a,4e3))}n&&!$(n).data("paRunmanyUnload")&&($(window).on("beforeunload",(function(){const t=document.getElementById("pa-runmany-progress");if(t&&t.max<t.value)return"Several server requests are outstanding."})),$(n).data("paRunmanyUnload",!0)),a()},store_gradeinfo:ne.store,text_eq:l}}();
//# sourceMappingURL=pa.min.js.map?version=008b5b6c91d9
