(()=>{var t={680:()=>{let t,e={};function n(t,n){const i=window.getComputedStyle(t);let s="font-size:".concat(i.fontSize,";font-family:",i.fontFamily,";font-weight:",i.fontWeight,";font-style:",i.fontStyle,";line-height:",i.lineHeight,"px;position:absolute;top:-10000px;left:-10000px;resize:none;word-wrap:break-word;white-space:pre-wrap;");if("TEXTAREA"!==t.tagName){const e=parseFloat(i.paddingLeft),a=parseFloat(i.paddingRight),r=parseFloat(i.borderLeftWidth),o=parseFloat(i.borderRightWidth);s=s.concat("width:auto;display:table-cell;padding-left:",e,"px;padding-right:",e+a+r+o,"px;"),"0px"===i.minWidth&&n&&(t.style.minWidth=n+"px"),"none"!==i.maxWidth||t.classList.contains("wide")||(t.style.maxWidth="640px")}let a=e[s];return a||(a=e[s]={signature:s,elt:document.createElement("div"),refcount:0},a.elt.setAttribute("style",s),document.body.appendChild(a.elt)),++a.refcount,a}function i(){for(let e of t)e[1]()}function s(n,i){$(n).removeData("autogrower"),i&&(i instanceof Element?i.remove():0===--i.refcount&&(i.elt.remove(),delete e[i.signature])),t&&t.delete(n)}$.fn.autogrow=function(){return this.each(function(){var e,a,r,o,l=$(this),c=l.data("autogrower");!c&&this.classList.contains("need-autogrow")&&(this.classList.remove("need-autogrow"),"TEXTAREA"===this.tagName?(e=this,c=function(t){if(!1===t)return s(e,a);var i=e.clientWidth;if(!(i<=0)){a||(a=n(e),r=e.clientHeight,a.elt.innerText="!",o=a.elt.clientHeight);var l=e.value;t&&"keydown"==t.type&&13===t.keyCode&&(l+="\n"),a.elt.style.width=i+"px",a.elt.innerText=l+"...";var c=Math.max($(window).height()-4*o,4*o);$(e).height(Math.min(c,Math.max(a.elt.clientHeight,r)))}}):"INPUT"===this.tagName&&"text"===this.type&&(c=function(t){var e,i,a;return function(r){if(!1===r)return s(t,e);var o=0;try{o=t.offsetWidth}catch{}if(o<=0)return;if(!e){e=n(t,o);let s=window.getComputedStyle(t);i=parseFloat(s.minWidth),a=parseFloat(s.maxWidth)}e.elt.innerText=t.value+"  ";let l=Math.min(e.elt.offsetWidth,$(window).width());a==a&&(l=Math.min(l,a)),$(t).outerWidth(Math.max(l,i))}}(this)),c&&(l.data("autogrower",c).on("change input",c),t||(t=new Map,$(window).resize(i)),t.set(this,c))),c&&""!==l.val()&&c()}),this},$.fn.unautogrow=function(){return this.each(function(){var t=$(this).data("autogrower");t&&t(!1)}),this}}},e={};function n(i){var s=e[i];if(void 0!==s)return s.exports;var a=e[i]={exports:{}};return t[i](a,a.exports,n),a.exports}(()=>{"use strict";let t=function(){return!1};try{window.localStorage&&window.JSON&&(t=function(t,e,n){try{var i=t?window.sessionStorage:window.localStorage;return void 0===e?!!i:void 0===n?i.getItem(e):null===n?i.removeItem(e):"object"==typeof n?i.setItem(e,JSON.stringify(n)):i.setItem(e,n)}catch{return!1}})}catch{}function e(t){var e,n,i,s,a,r,o=t.split(/(%(?:%|-?(?:\d*|\*?)(?:\.\d*)?[sdefgroxX]))/),l="";for(e=0,s=1;e!=o.length;++e)if("%"!=(n=o[e]).charAt(0))l+=n;else if("%"==n.charAt(1))l+="%";else{if(i=arguments[s],++s,"*"==(a=n.match(/^%(-?)(\d*|\*?)(?:|[.](\d*))(\w)/))[2]&&(a[2]=i.toString(),i=arguments[s],++s),a[4]>="e"&&a[4]<="g"&&null==a[3]&&(a[3]=6),"g"===a[4]?i=(i=Number(i).toPrecision(a[3]).toString()).replace(/\.(\d*[1-9])?0+(|e.*)$/,function(t,e,n){return(null==e?"":"."+e)+n}):"f"===a[4]?i=Number(i).toFixed(a[3]):"e"===a[4]?i=Number(i).toExponential(a[3]):"r"===a[4]?(i=Number(i).toFixed(+(a[3]||0)),+(a[3]||0)&&(i=i.replace(/\.?0*$/,""))):"d"===a[4]?i=Math.floor(i):"o"===a[4]?i=Math.floor(i).toString(8):"x"===a[4]?i=Math.floor(i).toString(16):"X"===a[4]&&(i=Math.floor(i).toString(16).toUpperCase()),i=i.toString(),""!==a[2]&&"0"!==a[2])for(r="0"===a[2].charAt(0)?"0":" ";i.length<parseInt(a[2],10);)i=a[1]?i+r:r+i;l+=i}return l}function i(t,e,n){return(e+=t.toString()).length<=n?e:e.substring(e.length-n)}function s(t,e,n){return n&&e&&!t.getSeconds()?r("%H:%M",t):n?r("%H:%M:%S",t):e&&t.getSeconds()?r("%#l:%M:%S%P",t):e&&t.getMinutes()?r("%#l:%M%P",t):r(e?"%#l%P":"%I:%M:%S %p",t)}t.json=function(e,n){var i=t(e,n);return!!i&&JSON.parse(i)},t.site=function(e,n,i){return"/"!==siteinfo.base&&(n=siteinfo.base+n),t(e,n,i)},t.site_json=function(e,n){return"/"!==siteinfo.base&&(n=siteinfo.base+n),t.json(e,n)};const a={a:function(t){return["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][t.getDay()]},A:function(t){return["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][t.getDay()]},d:function(t){return i(t.getDate(),"0",2)},e:function(t,e){return i(t.getDate(),e?"":" ",2)},u:function(t){return t.getDay()||7},w:function(t){return t.getDay()},b:function(t){return["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][t.getMonth()]},B:function(t){return["January","February","March","April","May","June","July","August","September","October","November","December"][t.getMonth()]},h:function(t){return a.b(t)},m:function(t){return i(t.getMonth()+1,"0",2)},y:function(t){return t.getFullYear()%100},Y:function(t){return t.getFullYear()},H:function(t){return i(t.getHours(),"0",2)},k:function(t,e){return i(t.getHours(),e?"":" ",2)},I:function(t){return i(t.getHours()%12||12,"0",2)},l:function(t,e){return i(t.getHours()%12||12,e?"":" ",2)},M:function(t){return i(t.getMinutes(),"0",2)},X:function(t){return r("%#e %b %Y %#q",t)},p:function(t){return t.getHours()<12?"AM":"PM"},P:function(t){return t.getHours()<12?"am":"pm"},q:function(t,e){return s(t,e,r.is24)},r:function(t,e){return s(t,e,!1)},R:function(t,e){return s(t,e,!0)},S:function(t){return i(t.getSeconds(),"0",2)},T:function(t){return r("%H:%M:%S",t)},D:function(t){return r("%m/%d/%y",t)},F:function(t){return r("%Y-%m-%d",t)},s:function(t){return Math.floor(t.getTime()/1e3)},n:function(){return"\n"},t:function(){return"\t"},"%":function(){return"%"}};function r(t,e){var n,i,s,r,o=t.split(/(%#?\S)/),l="";for(null==e?e=new Date:"number"==typeof e&&(e=new Date(1e3*e)),n=0;n!=o.length;++n)s="#"==(i=o[n]).charAt(1),"%"==i.charAt(0)&&(r=a[i.charAt(1+s)])?l+=r(e,s):l+=i;return l}function o(t,e){if((t=Math.round(t))>-60&&t<60)return t+"s";let n=t<0?"-":"";if((t=Math.abs(t))>=3600)if(t%900==0&&"quarterhour"===e)n=n.concat(t/3600,"h"),t=0;else{const e=Math.floor(t/3600);n=n.concat(e,"h"),(t-=3600*e)<60&&(n+="0m")}if(t>=60){const e=Math.floor(t/60);n=n.concat(e,"m"),t-=60*e}return 0!==t&&(n=n.concat(t,"s")),n}window.JSON&&window.JSON.parse||(window.JSON={parse:$.parseJSON}),Element.prototype.closest||(Element.prototype.closest=function(t){return $(this).closest(t)[0]}),Element.prototype.replaceChildren||(Element.prototype.replaceChildren=function(){for(;this.lastChild;)this.removeChild(this.lastChild);for(let t=0;t!==arguments.length;++t)this.append(arguments[t])}),Element.prototype.checkVisibility||(Element.prototype.checkVisibility=function(){return null!=this.offsetParent}),String.prototype.startsWith||(String.prototype.startsWith=function(t,e){return e=!e||e<0?0:+e,this.substring(e,e+t.length)===t}),String.prototype.endsWith||(String.prototype.endsWith=function(t,e){return(void 0===e||e>this.length)&&(e=this.length),this.substring(e-t.length,e)===t}),String.prototype.trimStart||(String.prototype.trimStart=function(){return this.replace(/^[\s\uFEFF\xA0]+/,"")}),Object.hasOwn||Object.defineProperty(Object,"hasOwn",{value:Object.prototype.hasOwnProperty,configurable:!0,writable:!0});class l{constructor(t){this.value=t}then(t){try{const e=t(this.value);return e instanceof Promise||e instanceof l?e:new l(e)}catch(t){return Promise.reject(t)}}catch(){return this}finally(t){try{t()}catch{}return this}}function c(t,e){return t===e||(t=(null==t?"":t).replace(/\r\n?/g,"\n"))===(null==e?"":e).replace(/\r\n?/g,"\n")}function u(t,e){let n=0,i=0;const s=/([\x00-\x7F]*)([\u0080-\u07FF]*)([\u0800-\uD7FF\uE000-\uFFFF]*)((?:[\uD800-\uDBFF][\uDC00-\uDFFF])*)/y,a=t.length;for(;i<a&&e>0;){s.lastIndex=i;const a=s.exec(t);if(!a)break;if(a[1].length){const t=Math.min(e,a[1].length);n+=t,e-=t}if(a[2].length){const t=Math.min(e,2*a[2].length);n+=t/2,e-=t}if(a[3].length){const t=Math.min(e,3*a[3].length);n+=t/3,e-=t}if(a[4].length){const t=Math.min(e,2*a[4].length);n+=t/2,e-=t}i+=a[0].length}return n}let d,h,p,f,m;"classList"in document.createElement("span")&&!/MSIE|rv:11\.0/.test(navigator.userAgent||"")?(d=function(t,e){let n=t.classList;return n&&n.contains(e)},h=function(t,e){t.classList.add(e)},p=function(t,e){t.classList.remove(e)},f=function(t,e,n){t.classList.toggle(e,n)},m=function(t){return t.classList}):(d=function(t,e){return $(t).hasClass(e)},h=function(t,e){$(t).addClass(e)},p=function(t,e){$(t).removeClass(e)},f=function(t,e,n){$(t).toggleClass(e,n)},m=function(t){let e=$.trim(t.className);return""===e?[]:e.split(/\s+/)});const g={};function b(t,e,n){for(let i=0;i!==e.length;i+=3)if(!e[i]||e[i]===n){let n=t.length;for(;0!==n&&e[i+1]>t[n-2];)n-=2;t.splice(n,0,e[i+1],e[i+2])}}function _(t,e,n){for(let i=0;i!==t.length&&!n.isImmediatePropagationStopped();i+=2)t[i+1].call(e,n)}function v(t){let e=t.target;(e&&(d(e,"ui")||d(e,"uin"))||"A"===this.tagName&&d(this,"ui"))&&t.preventDefault();let n=m(this),i=null;for(let e=0;e<n.length;++e){let s=g[n[e]];s&&(i=i||[],b(i,s,t.type))}i&&i.length&&_(i,this,t)}v.on=function(t,e,n){let i=t.indexOf("."),s=null;i>=0&&(s=t.substring(0,i),t=t.substring(i+1)),g[t]=g[t]||[],g[t].push(s,n||0,e)},v.trigger=function(t,e){let n=g[t];if(n){"string"==typeof e&&(e=$.Event(e));let t=[];b(t,n,e.type),t.length&&_(t,this,e)}},$(document).on("click",".ui, .uic",v),$(document).on("change",".uich",v),$(document).on("error",".ui-error",v),$(document).on("input",".uii",v),$(document).on("keydown",".uikd",v),$(document).on("load",".ui-load",v),$(document).on("mouseup mousedown",".uim",v),$(document).on("unfold",".ui-unfold",v),$(document).on("focusin",".ui-focusin",v),$(document).on("focusout",".ui-focusout",v);let y=!1;function x(t,e,n){if(null!=n&&(n=!n),f(t,"hidden",n),e){const n=e.querySelector("span.foldarrow");n&&n.classList.toggle("isopen",!d(t,"hidden"))}return!1}function w(t){return"checkbox"===t.type||"radio"===t.type}function k(t){if(t.hasAttribute("data-default-value"))return t.getAttribute("data-default-value");if(w(t)){let e=t.defaultChecked;return t.hasAttribute("data-default-checked")&&(e="false"!==t.getAttribute("data-default-checked")),e?t.defaultValue:""}return t.defaultValue}function C(t,e){w(t)?(t.checked=t.checked,t.removeAttribute("data-default-checked"),t.removeAttribute("data-default-value"),null==e||""==e?t.defaultChecked=!1:e==t.value?t.defaultChecked=!0:t.setAttribute("data-default-value",e)):(t.value=t.value,"select"!==t.type?(t.removeAttribute("data-default-value"),t.defaultValue=e):t.setAttribute("data-default-value",e))}function A(t){const e=t.type;if(e)return"button"!==e&&"submit"!==e&&"reset"!==e&&("checkbox"===e||"radio"===e?t.checked!==k(t):((n=t.value)!==(i=k(t))&&(n=(null==n?"":n).replace(/\r\n?/g,"\n"),i=(null==i?"":i).replace(/\r\n?/g,"\n")),!(n===i)));if(t instanceof RadioNodeList)for(let e=0;e!==t.length;++e)if(A(t[e]))return!0;return!1;var n,i}function E(t){let e;t instanceof HTMLFormElement?e=t.elements:(e=$(t).find("input, select, textarea"),e.length||(e=$(t).filter("input, select, textarea")));const n=e.length;for(let t=0;t!==n;++t){const n=e[t];if(n.name&&!d(n,"ignore-diff")&&!n.disabled&&A(n))return n}return null}function S(t,e){const n=document.createElement(t);if(e)if("string"==typeof e)n.className=e;else for(const t in e)null==e[t]||("boolean"==typeof e[t]?e[t]?n.setAttribute(t,""):n.removeAttribute(t):n.setAttribute(t,e[t]));for(let t=2;t<arguments.length;++t)null!=arguments[t]&&n.append(arguments[t]);return n}function N(){d(this,"need-autogrow")&&$(this).autogrow(),d(this,"need-tooltip")&&$pa.tooltip.call(this)}$(document).on("keydown keyup",function(t){"Tab"!==t.key||t.metaKey||(y="keydown"===t.type)}),$(document).on("focus","textarea.ta1",function(){if(y){let t=this;setTimeout(function(){t.setSelectionRange(0,t.value.length)},0)}}),$.fn.awaken=function(){return this.each(N),this.find(".need-autogrow, .need-tooltip").each(N),this},$(function(){$(document.body).awaken()});const D={Spacebar:" ",Esc:"Escape"},F={9:"Tab",13:"Enter",27:"Escape"},M={9:"Tab",13:"Enter",16:"ShiftLeft",17:"ControlLeft",18:"AltLeft",20:"CapsLock",27:"Escape",33:"PageUp",34:"PageDown",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",91:"OSLeft",92:"OSRight",93:"OSRight",224:"OSLeft",225:"AltRight"},T={Alt:2,AltLeft:2,AltRight:2,CapsLock:2,Control:2,ControlLeft:2,ControlRight:2,Meta:2,OSLeft:2,OSRight:2,Shift:2,ShiftLeft:2,ShiftRight:2,ArrowLeft:1,ArrowRight:1,ArrowUp:1,ArrowDown:1,Backspace:1,Delete:1,End:1,Enter:1,Escape:1,Home:1,PageUp:1,PageDown:1,Tab:1};function L(t){let e;return"string"==typeof t?t:null!=(e=t.key)?D[e]||e:(e=t.charCode)?F[e]||String.fromCharCode(e):(e=t.keyCode)?M[e]?M[e]:e>=48&&e<=57||e>=65&&e<=90?String.fromCharCode(e):void 0:""}function j(t){return encodeURIComponent(t).replace(/%20/g,"+")}function O(t,e,n){if(!1!==t.first&&t.v.length){for(var i=0;i<t.v.length;++i){var s=e.exec(t.v[i]);if(s)return t.pt+=n+s[1]+"/",t.v.splice(i,1),void(t.first=s[1])}t.first=!1}}function z(t,e){if(!1!==t.last&&t.v.length){for(var n=0;n<t.v.length;++n){var i=e.exec(t.v[n]);if(i)return t.t+="/"+i[1],t.v.splice(n,1),void(t.last=i[1])}t.last=!1}}function B(t,e,n){const i=t.closest(".pa-psetinfo");let s,a;if((s=i.getAttribute("data-pa-user")||siteinfo.uservalue)&&n.push("u="+encodeURIComponent(s)),(s=i.getAttribute("data-pa-pset"))&&n.push("pset="+encodeURIComponent(s)),(s=i.getAttribute("data-pa-commit"))&&n.push("commit="+encodeURIComponent(s)),("api/grade"===e||"=api/grade"===e)&&(a=i.pa__gradesheet)){const t=[];for(let e in a.entries)t.push(e);n.push("knowngrades="+j(t.join(" ")))}}function I(t,e){let n,i,s,a,r,o="";if(null!=siteinfo.site_relative&&null!=siteinfo.suffix||(siteinfo.site_relative=siteinfo.suffix=""),"string"==typeof e)(s=e.match(/^(.*?)(#.*)$/))&&(e=s[1],o=s[2]),r=e.split(/&/);else for(n in r=[],e)i=e[n],null==i||("anchor"===n?o="#"+i:"psetinfo"===n&&i instanceof Element?B(i,t,r):r.push(encodeURIComponent(n).concat("=",j(i))));return t.startsWith("=")&&(r.push("post="+siteinfo.postvalue),t=t.substring(1)),a={pt:"",v:r,t:t+siteinfo.suffix},"help"===t?z(a,/^t=(\w+)$/):"api"===t.substr(0,3)?(t.length>3&&(a.t="api"+siteinfo.suffix,r.push("fn="+t.substr(4))),O(a,/^u=([^?&#]+)$/,"~"),z(a,/^fn=(\w+)$/)):"index"===t||"run"===t?O(a,/^u=([^?&#]+)$/,"~"):"pset"===t&&(O(a,/^u=([^?&#]+)$/,"~"),z(a,/^pset=([^?&#]+)$/),z(a,/^commit=([0-9A-Fa-f]+)$/)),siteinfo.defaults&&r.push(function(t){if("string"==typeof t)return t;if(t){var e,n,i=[""];for(e in t)null!=(n=t[e])&&i.push(encodeURIComponent(e),"=",j(n),"&");return i[i.length-1]="",i.join("")}return""}(siteinfo.defaults)),r.length&&(a.t+="?"+r.join("&")),siteinfo.site_relative+a.pt+a.t+o}function q(t,e){window.location=I(t,e)}function R(t,e,n){!e&&t instanceof Error?t={error:(e=t).toString()}:"string"==typeof t&&(t={error:t}),e&&e.fileName&&!t.url&&(t.url=e.fileName),e&&e.lineNumber&&!t.lineno&&(t.lineno=e.lineNumber),e&&e.columnNumber&&!t.colno&&(t.colno=e.columnNumber),e&&e.stack&&(t.stack=e.stack),$.ajax(I("=api/jserror"),{global:!1,method:"POST",cache:!1,data:t}),e&&!n&&"object"==typeof console&&console.error&&console.error(t.error)}L.printable=function(t){return!(T[L(t)]||"string"!=typeof t&&(t.ctrlKey||t.metaKey))},L.is_modifier=function(t){return T[L(t)]>1},L.is_default_a=function(t,e){return!(t.shiftKey||t.metaKey||t.ctrlKey||0!=t.button||e&&d("ui",e))},L.modcode=function(t){return(t.shiftKey?1:0)+(t.ctrlKey?2:0)+(t.altKey?4:0)+(t.metaKey?8:0)},L.SHIFT=1,L.CTRL=2,L.ALT=4,L.META=8,n(680),v.on("js-range-click",function(t){if("change"===t.type)return;const e=this.closest("form"),n=e.jsRangeClick||{},i=this.getAttribute("data-range-type")||this.name;e.jsRangeClick=n;let s=!1;if("keydown"!==t.type||L.modcode(t)||(s=L(t)),n.__clicking__||"updaterange"===t.type&&n["__update__"+i]||"keydown"===t.type&&"ArrowDown"!==s&&"ArrowUp"!==s)return;const a=[],r=[];for(const t of e.querySelectorAll("input.js-range-click").values())i===(t.getAttribute("data-range-type")||t.name)&&t.checkVisibility()&&(a.push(t),d(t,"is-range-group")&&r.push(t));let o,l,c=n[i];for(let t=0;t!==a.length;++t)a[t]===this&&(o=t),a[t]===c&&(l=t);if(s)return 0!==o&&"ArrowUp"===s?--o:o<a.length-1&&"ArrowDown"===s&&++o,$(a[o]).focus().scrollIntoView(),void t.preventDefault();let u=!1,h=!1;if("click"===t.type){let e,s;for(n.__clicking__=!0,d(this,"is-range-group")?(e=0,s=a.length-1,u=this.getAttribute("data-range-group")):(n[i]=this,t.shiftKey&&c?l<=o?(e=l,s=o-1):(e=o+1,s=l):(e=1,s=0,h=this.getAttribute("data-range-group")));e<=s;)a[e].checked===this.checked||d(a[e],"is-range-group")||u&&a[e].getAttribute("data-range-group")!==u||$(a[e]).trigger("click"),++e;delete n.__clicking__}else"updaterange"===t.type&&(n["__updated__"+i]=!0);for(const n of r){const s=n.getAttribute("data-range-group");if(h&&s!==h)continue;let r=null;for(const t of a)if(t.getAttribute("data-range-group")===s&&!d(t,"is-range-group"))if(null===r)r=t.checked;else if(r!==t.checked){r="indeterminate";break}let o=!1;if("indeterminate"===r?(o=!n.indeterminate,n.indeterminate=!0,n.checked=!0):(o=n.indeterminate||n.checked!==r,n.indeterminate=!1,n.checked=r),o||n===t.target){const t=new CustomEvent("rangechange",{bubbles:!0,cancelable:!0,detail:{rangeType:i,rangeGroup:s,newState:r}});e.dispatchEvent(t)}}},-1),$(function(){$(".is-range-group").each(function(){v.trigger.call(this,"js-range-click","updaterange")})});let P=window.onerror,H=0;function W(t,e,n){return"parsererror"===e?"<0>Internal error: bad response from server":n?"<0>"+n.toString():"timeout"===e?"<0>Connection timed out":e?"<0>Failed ["+e+"]":"<0>Failed"}function U(t,e){"object"==typeof t&&(t.message_list&&!$.isArray(t.message_list)?(R(e.url+": bad message_list"),t.message_list=[{message:"<0>Internal error",status:2}]):t.error&&!t.message_list?t.message_list=[{message:"<0>"+t.error,status:2}]:t.warning&&R(e.url+": `warning` obsolete"))}window.onerror=function(t,e,n,i,s){if((e||!n)&&t.indexOf("ResizeObserver loop limit exceeded")<0&&++H<=10){var a={error:t,url:e,lineno:n};i&&(a.colno=i),R(a,s,!0)}return!!P&&P.apply(this,arguments)},$(function(){var t=[],e=[];if($("button.btn-link,button.btn-qlink,button.btn-qolink,.btn-xlink,.btn-ulink,.btn-disabled,a.qx,a.u,a.x").each(function(){t.push(function(t){for(var e=[];t&&"BODY"!==t.nodeName&&"MAIN"!==t.nodeName;){var n=t.nodeName,i=t.className.replace(/\s+/g,".");""!==t.id&&(n+="#"+t.id),""!==i&&(n+="."+i),e.push(n),t=t.parentElement}return e.reverse(),e.join(">")}(this)),e.push(this)}),t.length>0){if(window.console){console.log(t.join("\n"));for(var n=0;n!==e.length;++n)console.log(e[n])}R(t.join("\n"))}}),$(document).ajaxError(function(t,e,n,i){if(4!=e.readyState)return;let s;if(e.responseText&&"{"===e.responseText.charAt(0))try{s=JSON.parse(e.responseText)}catch{}if(U(s,n),502!==e.status){let t=new URL(n.url,document.baseURI).href+" API failure: ";siteinfo.user&&siteinfo.user.email&&(t+="user "+siteinfo.user.email+", "),t+=e.status,i&&(t+=", "+i),e.responseText&&(t+=", "+e.responseText.substring(0,100)),R(t)}});let Z=0,K=[];function Y(t){if(void 0===t)return Z>0;Z>0?K.push(t):t()}$.ajaxPrefilter(function(t){if(!1===t.global)return;let e=t.success||[],n=t.error;$.isArray(e)||(e=[e]),t.success=[function(e){U(e,t),"object"!=typeof e||!e.sessioninfo||!t.url.startsWith(siteinfo.site_relative)||""===siteinfo.site_relative&&/^(?:[a-z][-a-z0-9+.]*:|\/|\.\.(?:\/|$))/i.test(t.url)||function(t,e){siteinfo.user.cid==t.sessioninfo.cid?(siteinfo.postvalue=t.sessioninfo.postvalue,$("form").each(function(){var t=/^([^#]*[&?;]post=)([^&?;#]*)/.exec(this.action);t&&(this.action=t[1].concat(siteinfo.postvalue,this.action.substring(t[0].length))),this.elements.post&&(this.elements.post.value=siteinfo.postvalue)})):$("form").each(function(){this.elements.sessionreport&&(this.elements.sessionreport=e.url.concat(": bad response ",JSON.stringify(t.sessioninfo),", current user ",JSON.stringify(siteinfo.user)))})}(e,t)}],e.length&&Array.prototype.push.apply(t.success,e),t.error=[],n&&Array.prototype.push.apply(t.error,$.isArray(n)?n:[n]),t.error.push(function(n,i,s){let a;if(/application\/json/.test(n.getResponseHeader("Content-Type")||"")&&n.responseText)try{a=JSON.parse(n.responseText)}catch{}a&&"object"==typeof a&&!1===a.ok||(a={ok:!1}),U(a,t),a.message_list||(a.message_list=[{message:W(0,i,s),status:2}]);for(let t=0;t!==e.length;++t)e[t](a,n,i)}),null==t.timeout&&(t.timeout=1e4),null==t.dataType&&(t.dataType="json"),t.trackOutstanding&&++Z}),$(document).ajaxComplete(function(t,e,n){if(n.trackOutstanding&&0===--Z)for(;K.length;)K.shift()()});let J,X=0,V=[],G=[];function Q(t,e,n){return"string"==typeof n&&(n={method:n}),new Promise(function(i){Q.then(function(){$.ajax(t,Object.assign({data:e,method:"POST",cache:!1,dataType:"json",success:function(t){i(t),Q.done()}},n||{}))})})}function tt(){if(X<1||X>5)throw new Error("api_conditioner outstanding error "+X);V.length?V.shift()():--X}function et(e){for(var n="string"==typeof e?1:0,i=t.site_json(!1,"list_digests")||[],s=-1,a=(new Date).getTime(),r=0;r<i.length;++r){var o=i[r];o[n]===e?s=r:o[2]<a-3e4?(i.splice(r,1),--r):a<=o[0]&&(a=o[0]+1)}return s>=0?i[s][2]=a:n&&(i.push([a,e,a]),s=i.length-1),t.site(!1,"list_digests",i),s>=0&&i[s][1-n]}function nt(t){var e,n;return(n=/^list(\d+)(?=\s|$)/.exec(t))&&(e=et(+n[1]))?e:t}function it(t,e){let n=function(t){var e=et(t);return e?"list"+e:t}(t=nt(t));e&&/(?:^|\/)pset(?:|\.php)\//.test(e)&&(n+=function(t,e){var n,i,s=/(?:^|\/)(~[^/]+)\/pset(?:|\.php)\/([^/]+)((?:\/[0-9a-f]+)?)(?=[/?#]|$)/.exec(e);if(s){if((t=JSON.parse(t)).pset){if(t.pset!==s[2])return"";n=i=s[1]}else n=(i=s[1]+"/pset/"+s[2])+s[3];var a=t.items.indexOf(n);if(a<0&&i!==n&&(a=t.items.indexOf(i)),a>=0)return" "+JSON.stringify({cur:s[1]+"/pset/"+s[2],prev:0===a?null:t.items[a-1],next:a===t.items.length-1?null:t.items[a+1]})}return""}(t,e)),J=(new Date).getTime();let i,s=`hotlist-info-${J}=${encodeURIComponent(n)}${siteinfo.cookie_params}; Max-Age=20`;siteinfo.site_relative&&(i=/^[a-z]+:\/\/[^/]*(\/.*)/.exec((siteinfo.absolute_base||(siteinfo.absolute_base=new URL(siteinfo.base,document.baseURI).href),siteinfo.absolute_base)))&&(s+="; Path="+i[1]),document.cookie=s}function st(t,e){let n,i;if(!(e&&e.startsWith(siteinfo.site_relative)&&function(t){return/(?:^|\/)pset(?:|\.php)(?:$|\/)/.test(t)}(i=e.substring(siteinfo.site_relative.length))&&(n=t.closest(".has-hotlist"))))return;let s=n.getAttribute("data-hotlist");if(!s){const t=new CustomEvent("pa-hotlist",{bubbles:!0,cancelable:!0,detail:{hotlist:null}});n.dispatchEvent(t),s=t.detail.hotlist,s&&"string"!=typeof s&&(s=JSON.stringify(s))}s&&it(s,i)}function at(){var t,e=location.href;return location.hash&&(e=e.substring(0,e.length-location.hash.length)),this.href.substring(0,e.length+1)===e+"#"||!!Y()&&(Y((t=this,function(){window.location=t.href})),!0)}Q.then=function(t){X<5?(++X,t()):V.push(t)},Q.done=function(){G.length&&(V.unshift(...G),G.length=0),tt()},Q.retry=function(t){G.push(t),tt()},$(document).on("click","a",function(t){d(this,"ui")||L.is_default_a(t)&&!this.target&&at.call(this,t)||st(this,this.getAttribute("href"))}),$(document).on("submit","form",function(t){d(this,"ui-submit")?(t.preventDefault(),v.call(this,t)):st(this,this.getAttribute("action"))}),$(window).on("beforeunload",function(){var t=document.body.getAttribute("data-hotlist");t&&(!J||J+3<(new Date).getTime())&&it(t,location.href)}),$(function(){$(".has-hotlist").each(function(){var t=this.getAttribute("data-hotlist");t&&t.startsWith("list")&&(t=nt(t))&&this.setAttribute("data-hotlist",t)})});const rt=/[&<>"']/g,ot={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function lt(t){return null!==t&&"number"!=typeof t?t.replace(rt,function(t){return ot[t]}):t}function ct(t,e){return(t=e?String(t).replace(/([-$()*+./?[\\\]^{|}])/g,"\\$1"):String(t).replace(/([$()*+./?[\\\]^{|}])/g,"\\$1")).replace(/\x08/g,"\\x08")}function ut(t){return encodeURIComponent(t).replace(/[^-A-Za-z0-9_.%]|%../g,function(t){return 1===t.length?"@"+t.charCodeAt(0).toString(16):"%2F"===t?"/":"@"+t.substring(1)})}function dt(t){return decodeURIComponent(t.replace(/@/g,"%"))}const ht=["Top","Right","Bottom","Left"],pt=["top","right","bottom","left"],ft=["height","width"];function mt(t,e){return"border"+ht[t]+e}function gt(t){return mt(t,"Color")}let bt=Math.round;var _t;function vt(t,e){!e&&t&&"object"==typeof t?t=(e=t).content:e?"string"==typeof e&&(e={color:e}):e={};var n=null,i=e.dir,s=null,a=e.color?" "+e.color:"";let r=document.createElement("div");r.className="bubble nomargin"+a;{let t=document.createElement("div");t.className="bubtail bubtail0 nomargin"+a;let e=document.createElement("div"),n=document.createElement("div");n.className="bubtail bubtail1 nomargin"+a,r.append(t,e,n),t.style.width=t.style.height=n.style.width=n.style.height="0px"}document.body.appendChild(r),e["pointer-events"]&&$(r).css({"pointer-events":e["pointer-events"]});var o=r.childNodes,l=null,c=null;function u(){var t=[0,0,0,0],e=l[1],n=l[0]/2;(c=parseFloat($(r).css(mt(s,"Width"))))!=c&&(c=0),t[1^s]=t[3^s]=n+"px",t[2^s]=e+"px",o[0].style.borderWidth=t.join(" "),t[1^s]=t[3^s]=n+"px",t[2^s]=e+"px",o[2].style.borderWidth=t.join(" ");for(var i=1;i<=3;++i)o[0].style[pt[s^i]]=o[2].style[pt[s^i]]="";o[0].style[pt[s]]=-e-c+"px";var a=c/n*Math.sqrt(e*e+n*n);for(o[2].style[pt[s]]=-e-c+a+"px",i=0;i<3;i+=2)o[i].style.borderLeftColor=o[i].style.borderRightColor=o[i].style.borderTopColor=o[i].style.borderBottomColor="transparent";var u,d,h=(u=$(r).css("backgroundColor"),d=u.match(/^rgb\((.*)\)$/),d?"rgba("+d[1]+", 1)":u).replace(/([\d.]+)\)/,function(t,e){return.75*e+.25+")"});o[0].style[gt(2^s)]=$(r).css(gt(s)),o[2].style[gt(2^s)]=h}function d(t,e,n,i){var s=t[pt[n]],a=t[pt[2^n]],r=(1-i)*s+i*a;return r=Math.max(r,Math.min(a,e[pt[n]]+8)),Math.min(r,Math.max(s,e[pt[2^n]]-8))}function h(t,e,n,i,s,a){var r=e[pt[i]],o=e[pt[2^i]],c=n[ft[1&i]],u=t-s*c;return!a&&u<r+8?u=Math.min(t-l[0],r+8):!a&&u+c>o-8&&(u=Math.max(t+l[0]-c,o-8-c)),u}function p(t,e){var i=Math.max(3===e?0:n.left-t.left,1===e?0:t.right-n.right);return("h"===e||1===e||3===e)&&i>100?Math.min(t.width,i)-24:t.width-24}function f(t,e){var i=$(r);i.css("maxWidth","");var s=i.geometry(!0),a=p(t,e);a<s.width&&(i.css("maxWidth",a),s=i.geometry(!0));var o=[n.top-l.bottom-s.height-l[0],n.right+l.left+s.width+l[0],n.bottom+l.top+s.height+l[0],n.left-l.right-s.width-l[0]];return o.width=s.width,o.height=s.height,o.wconstraint=a,o}function m(t,e,n){var i=p(e,n);return(i<t.wconstraint&&i<t.width||i>t.wconstraint&&t.width>=t.wconstraint)&&(t=f(e,n)),t}function g(t,e){var n;return t.length>e&&(n="0123trblnesw".indexOf(t.charAt(e)))>=0?n%4:-1}function b(t,e){var n,i=$(r).css("border"+t+"Radius");return i?((n=i.indexOf(" "))>-1&&(i=e?i.substring(n+1):i.substring(0,n)),parseFloat(i)):0}function _(t,e,n){var i,s;return 1&n?(i=b(ht[0]+ht[n],1),s=b(ht[2]+ht[n],1)):(i=b(ht[n]+ht[3],1),s=b(ht[n]+ht[1],1)),Math.min(Math.max(t,i),e[ft[1&n^1]]-s-l[0])}function v(){l=l||function(t){const e=function(t){const e=document.createElement("div");e.className="bubble hidden"+t;const n=document.createElement("div");return n.className="bubtail bubtail0 nomargin"+t,e.appendChild(n),document.body.appendChild(e),e}(t),n=$(e).children(),i=[n.width(),n.height()],s=window.getComputedStyle(e);for(let t=0;4!==t;++t){let e=s["margin"+ht[t]];e&&(e=parseFloat(e))||(e=0),i[pt[t]]=e}return e.remove(),i}(a),null==i&&(i="r");var t=/!/.test(i),e=/\*/.test(i),c=i.replace(/[^a0-3neswtrblhv]/,""),p=g(c,0),b=g(c,1);b=p>=0&&b>=0&&(1&b)!=(1&p)?1===b||2===b?1:0:.5,p<0&&(p=/^[ahv]$/.test(c)?c:"a");var v=$(window).geometry(),y=f(v,c);"a"===p&&(y.height+l[0]>Math.max(n.top-v.top,v.bottom-n.bottom)?y=m(y,v,p="h"):p="v");var x,w,k,C,A,E=[v.top+24,v.right-24,v.bottom-24,v.left+24];("v"===p||0===p||2===p)&&!t&&b<0&&y[2]>E[2]&&y[0]<E[0]&&(y[3]>=E[3]||y[1]<=E[1])&&(y=m(y,v,p="h")),y=m(y,v,p="v"===p&&y[2]>E[2]&&y[0]>E[0]||0===p&&!t&&y[2]>v.bottom&&v.top-y[0]<y[2]-v.bottom||2===p&&(t||y[0]>=v.top+8)?2:"v"===p||0===p||2===p?0:"h"===p&&y[3]-v.left<v.right-y[1]||1===p&&!t&&y[3]<v.left||3===p&&(t||y[1]<=v.right-8)?3:1),p!==s&&(s=p,u());var S=parseFloat($(r).css(mt(1&p?0:3,"Width")));1&p?(w=h(C=d(n,v,0,b),v,y,0,b,e),A=_(bt(C-w-l[0]/2-S),y,p),o[0].style.top=o[2].style.top=A+"px",x=1==p?n.left-l.right-y.width-l[1]-1:n.right+l.left+l[1]):(x=h(k=d(n,v,3,b),v,y,3,b,e),A=_(bt(k-x-l[0]/2-S),y,p),o[0].style.left=o[2].style.left=A+"px",w=0==p?n.bottom+l.top+l[1]:n.top-l.bottom-y.height-l[1]-1),r.style.left=bt(x)+"px",r.style.top=bt(w)+"px",r.style.visibility="visible"}function y(){r&&r.parentElement.removeChild(r),r=null}let x={near:function(t,e){("string"==typeof t||t.tagName||t.jquery)&&(t=$(t),null==i&&t[0]&&(i=t[0].getAttribute("data-tooltip-dir")),t=t.geometry(!0));for(let e=0;e<4;++e)!(pt[e]in t)&&pt[2^e]in t&&(t[pt[e]]=t[pt[2^e]]);var s,a;return e&&(e=$(e))&&e.length&&e[0]!=window&&(s=t,a=e.geometry(),(s=$.extend({},s)).top+=a.top,s.right+=a.left,s.bottom+=a.top,s.left+=a.left,t=s),n=t,v(),x},at:function(t,e,n){return x.near({top:e,left:t},n)},dir:function(t){return i=t,x},remove:y,color:function(t){return a!==(t=t?" "+t:"")&&(a=t,r.className="bubble"+a,o[0].className="bubtail bubtail0"+a,o[2].className="bubtail bubtail1"+a,s=l=null,n&&v()),x},html:function(t){var e=o[1];if(void 0===t)return e.innerHTML;if("string"==typeof t&&t===e.innerHTML&&"visible"===r.style.visibility)return x;if(n&&$(r).css({maxWidth:"",left:"",top:""}),"string"==typeof t)e.innerHTML=t;else{for(;e.childNodes.length;)e.removeChild(e.childNodes[0]);t&&t.jquery?t.appendTo(e):e.appendChild(t)}return n&&v(),x},text:function(t){return void 0===t?$(o[1]).text():x.html(t?function(t){var e=document.createElement("div");return e.appendChild(document.createTextNode(t)),e.innerHTML}(t):t)},content_node:function(){return o[1].firstChild},hover:function(t,e){return $(r).hover(t,e),x},removeOn:function(t,e){return arguments.length>1?$(t).on(e,y):r&&$(r).on(t,y),x},self:function(){return r?$(r):null},outerHTML:function(){return r?r.outerHTML:null}};return t&&x.html(t),x}window.devicePixelRatio&&window.devicePixelRatio>1&&(_t=window.devicePixelRatio,bt=function(t){return Math.round(t*_t)/_t});let yt={},xt=null;function wt(t){if(window.disable_tooltip)return null;const e=this;t=t&&"string"==typeof t?{builder:t}:t instanceof HTMLElement?{content:t}:Object.assign({},t||{}),(t=function(t,e){var n=t.getAttribute("data-tooltip-info");return n&&("string"==typeof n&&"{"===n.charAt(0)?n=JSON.parse(n):"string"==typeof n&&(n={builder:n}),e=$.extend(n,e)),e.builder&&yt[e.builder]&&(e=yt[e.builder].call(t,e)||e),(null==e.dir||t.hasAttribute("data-tooltip-dir"))&&(e.dir=t.getAttribute("data-tooltip-dir")||"v"),(null==e.type||t.hasAttribute("data-tooltip-type"))&&(e.type=t.getAttribute("data-tooltip-type")),(null==e.className||t.hasAttribute("data-tooltip-class"))&&(e.className=t.getAttribute("data-tooltip-class")||"tooltip dark"),t.hasAttribute("data-tooltip")?e.content=t.getAttribute("data-tooltip"):null==e.content&&(t.hasAttribute("aria-label")?e.content=t.getAttribute("aria-label"):t.hasAttribute("title")&&(e.content=t.getAttribute("title"))),t.hasAttribute("data-tooltip-delay")?e.delay=parseInt(t.getAttribute("data-tooltip-delay")):null!=e.delay||null!=e.type&&"hover"!==e.type||(e.delay=150),e}(e,t)).element=this;var n,i=null,s=null,a=null,r=null,o=1,l=t.content;function c(){s=clearTimeout(s),i&&i.remove(),$(e).removeData("tooltipState"),xt===n&&(xt=null)}function u(){r||0===o||(l?l instanceof Promise?l.then(function(t){l=t,u()}):i?i.html(l):(i=vt(l,{color:t.className,dir:t.dir}),a=t.near||t.element,i.near(a).hover(n.enter,n.exit)):(i&&i.remove(),i=a=null))}n={enter:function(){return s=clearTimeout(s),++o,n},exit:function(){var e="focus"===t.type?0:200;return s=clearTimeout(s),--o<=0&&"sticky"!==t.type&&(s=setTimeout(c,e)),n},close:c,_element:e,html:function(t){return void 0===t?l:(l=t,u(),n)},text:function(t){return n.html(lt(t))},near:function(){return a},noDelayClass:function(){return t.noDelayClass}};{let s=xt;s&&s._element===t.element&&s.html()===l?n=s:(s&&s.close(),$(e).data("tooltipState",n),!t.delay||t.noDelayClass&&s&&s.noDelayClass()===t.noDelayClass?u():r=setTimeout(function(){r=null,l&&!i&&u()},t.delay),xt=n)}return n}function kt(){const t=$(this).data("tooltipState");t?t.enter():wt.call(this)}function Ct(){const t=$(this).data("tooltipState");t&&t.exit()}function At(){p(this,"need-tooltip"),"focus"===this.getAttribute("data-tooltip-type")?$(this).on("focus",kt).on("blur",Ct):$(this).hover(kt,Ct)}function Et(t,e,n){let i;for(;e!==n&&(32===(i=t.charCodeAt(e))||9===i);)++e;return e}function $t(t,e,n,i){for(;e!==n;){const n=t.charCodeAt(e),s=32|n;if(s>=97&&s<=122);else if(i!==e||45!==n&&(n<48||n>57))break;++e}return e}function St(t,e,n){let i;const s={tag:null,ok:!1,open:null,close:null,attr:{},pos:e};if(60!==t.charCodeAt(e))return s;(e=Et(t,e+1,n))!==n&&47===t.charCodeAt(e)&&(s.open=!1,s.close=!0,e=Et(t,e+1,n));const a=e;if((e=$t(t,e,n,e))===a)return s;for(null===s.open&&(s.open=!0),s.tag=t.substring(a,e).toLowerCase();;){if(i=(e=Et(t,e,n))!==n?t.charCodeAt(e):-1,62===i)return s.pos=e+1,s.ok=!0,s;if(47===i)s.close=!0,++e;else{if(s.close)return s;if(!((32|i)>=97&&(32|i)<=122))return s;{const a=e,r=$t(t,e,n,e),o=t.substring(a,r).toLowerCase();if((e=Et(t,r,n))!==n&&61===t.charCodeAt(e))if(i=(e=Et(t,e+1,n))!==n?t.charCodeAt(e):-1,34===i||39===i){const n=t.indexOf(t.charAt(e),e+1),i=t.indexOf("\n",e+1);if(-1===n||i>0&&n>i)return s;s.attr[o]=t.substring(e+1,n),e=n+1}else{if(!(45===i||i>=48&&i<=57||(32|i)>=97&&(32|i)<=122))return s;{const i=e;e=$t(t,e+1,n,e),s.attr[o]=t.substring(i,e)}}else s.attr[o]=!0}}}}function Nt(t,e){let n=t.src,i=t.pos,s=t.posMax;if(60!==n.charCodeAt(i)||i+2>=s)return!1;let a=32|n.charCodeAt(i+1);if(47!==a&&98!==a&&105!==a&&115!==a)return!1;const r=St(n,i,s);if(!r.ok)return!1;if("br"===r.tag){if(r.open){const t=St(n,Et(n,r.pos,s),s);t.ok&&"br"===t.tag&&!t.open&&(r.pos=t.pos)}e||t.push("hardbreak","br",0)}else if("sub"!==r.tag&&"sup"!==r.tag||r.close){if("img"!==r.tag||!r.attr.src)return!1;{let e=t.push("image","img",0);e.attrs=[["src",r.attr.src],["alt",""]],r.attr.title&&e.attrs.push(["title",r.attr.title]),e.children=[],e.content=r.attr.alt||"",""!==e.content&&t.md.inline.parse(e.content,t.md,t.env,e.children)}}else{const i=n.indexOf("<",r.pos),a=n.indexOf("\n",r.pos);let o=i>=r.pos&&(a<0||a>i)?St(n,i,s):null;if(!o||!o.ok||o.open||o.tag!==r.tag)return!1;e||(t.push(r.tag+"_open",r.tag,1),t.push("text","",0).content=n.substring(r.pos,i),t.push(r.tag+"_close",r.tag,-1)),r.pos=o.pos}return t.pos=r.pos,!0}function Dt(t){t.inline.ruler.after("autolink","minihtml_inline",Nt)}At.close=function(t){const e=t?$(t).data("tooltipState"):xt;e&&e.close()},At.close_under=function(t){xt&&t.contains(xt.near())&&xt.close()},At.add_builder=function(t,e){yt[t]=e},At.enter=function(t,e){const n=$(t).data("tooltipState");n?n.enter():wt.call(t,e)},At.leave=function(t){Ct.call(t)};const Ft=/\{(?:(?:\.[^#.=\s}]+(?=[#.\s}])|#[^#.=\s}]+(?=[#.\s}])|[^.#="}]+="[^"]*"(?=[\s}]))\s*)+\}[ \t]*(?:\n|$)/y;function Mt(t,e,n,i){if(t.sCount[e]-t.blkIndent>=4)return!1;let s=t.bMarks[e]+t.tShift[e];if(123!==t.src.charCodeAt(s))return!1;Ft.lastIndex=s;let a=Ft.exec(t.src);if(!a)return!1;if(i)return!0;const r=t.tokens[t.tokens.length-1],o=r.type;let l=null;if("paragraph_close"===o||"blockquote_close"===o||"ordered_list_close"===o||"bullet_list_close"===o||"table_close"===o?l=function(t,e){let n=t.tokens[e].nesting||0;for(--e;0!==n&&e>=0;--e)if(n+=t.tokens[e].nesting||0,0===n)return t.tokens[e];return null}(t,t.tokens.length-1):"fence"===o&&(l=r),!l)return!1;const c=a[0];for(let t of c.matchAll(/\.([^#.=\s}]+)|#([^#.=\s}]+)|([^.#="{}]+)="([^"]*)"/g))if(t[1]){let e=l.attrGet("class")||"";l.attrSet("class",e?e+" "+t[1]:t[1])}else t[2]?l.attrSet("id",t[2]):l.attrSet(t[3],t[4]);return t.line=e+1,!0}function Tt(t){t.block.ruler.after("lheading","mdattribute",Mt,{alt:["list","blockquote","paragraph"]})}function Lt(t){let e=0,n=0;for(;;){const i=t.charCodeAt(n);if(0===n?60!==i:62!==i&&(i<48||i>57))return[0,t];if(0!==n&&i>=48&&i<=57)e=10*e+i-48;else if(62===i)return 1===n?[0,t]:[e,t.substring(n+1)];++n}}const jt={};function Ot(t){if(null==t.format||""===t.format||jt[t.format])throw new Error("bad or reused format");jt[t.format]=t}function zt(t){return t.replace(/((?:https?|ftp):\/\/(?:[^\s<>"&]|&amp;)*[^\s<>"().,:;&])(["().,:;]*)(?=[\s<>&]|$)/g,function(t,e,n){return'<a href="'+e+'" rel="noreferrer">'+e+"</a>"+n})}let Bt,It;function qt(t,e,n,i){if(e&&hljs.getLanguage(e))try{var s=hljs.highlight(t,{language:e,ignoreIllegals:!0}).value,a=i?i.attrIndex("class"):-1,r=i?i.attrIndex("data-lineno-start"):-1;if(a>=0&&/^(.*(?: |^))need-lineno((?: |$).*)$/.test(i.attrs[a][1])){let t=r>=0?i.attrs[r][1]:"1";const e=t.match(/^(.*?)(\d*)(\D*)$/),n=e[1],a=e[2].startsWith("0")?e[2].length:0,o=e[3],l=t=>n+t.toString().padStart(a,"0")+o;t=e[2]?+e[2]:1;let c=s.split(/\n/);c.length>0&&""===c[c.length-1]&&c.pop();const u='<span class="has-lineno has-lineno-'.concat(l(t+c.length-1).length,'" data-lineno="');for(let e=0;e!==c.length;++e,++t)c[e]=u.concat(l(t),'">',c[e],"</span>");s=c.join("\n")+"\n"}return s}catch{}return""}function Rt(t,e,n,i,s){return(t[e].attrGet("href")||"").startsWith("#")||t[e].attrSet("target","_blank"),s.renderToken(t,e,n,i)}function Pt(t,e,n){const i=d(t,"format-inline")||window.getComputedStyle(t).display.startsWith("inline"),s=(i&&e.render_inline||e.render).call(t,n,t);var a,r;t.className=(a=t.className,r=e.format,a?a.replace(/(?:^|\s)(?:need-format|format\d+)(?=$|\s)/g,"").concat(" format",r).trimStart():"format"+r),t.innerHTML=s,i&&!e.render_inline&&1===t.children.length&&"P"===t.firstChild.tagName&&t.firstChild.replaceWith(...t.firstChild.childNodes)}function Ht(t,e,n){if("f"===e){var i=Lt(n);e=i[0],n=i[1]}try{Pt(t,jt[e]||jt[0],n)}catch(i){window.console&&window.console.error(i),Pt(t,jt[0],n),delete jt[e]}}function Wt(){const t=this.hasAttribute("data-format")?this.getAttribute("data-format"):"f";Ht(this,""!==t?t:"f",this.hasAttribute("data-content")?this.getAttribute("data-content"):this.textContent)}function Ut(){$(".need-format").each(Wt)}Ot({format:0,render:function(t){for(var e,n=t.split(/((?:\r\n?|\n)(?:[-+*][ \t]|\d+\.)?)/),i=1;i<n.length;i+=2)n[i-1].length>49&&n[i].length<=2&&""!==(e=n[i+1].charAt(0))&&" "!==e&&"\t"!==e&&(n[i]=" ");return(t="<p>"+zt(lt(n.join("")))+"</p>").replace(/\r\n?(?:\r\n?)+|\n\n+/g,"</p><p>")},render_inline:function(t){return zt(lt(t))}}),Ot({format:1,render:function(t){return Bt||(Bt=window.markdownit({highlight:qt,linkify:!0}).use(markdownit_katex).use(Dt)),Bt.render(t)}}),Ot({format:3,render:function(t){return It||(It=window.markdownit({highlight:qt,linkify:!0,html:!0,attributes:!0}).use(markdownit_katex).use(Tt),It.renderer.rules.link_open=Rt),It.render(t)}}),Ot({format:5,render:function(t){return t}});const Zt={add_format:Ot,on_page:Ut};$(Ut);const Kt={parse:Lt,unparse:function(t,e){return t||e.startsWith("<")?"<".concat(t||0,">",e):e}};function Yt(t,e){let n=0;for(const i of t||[])!(-3===i.status&&0===n||i.status>=1&&i.status>n)||e&&i.field!==e||(n=i.status);return n}function Jt(t){const e=document.createElement("ul");e.className="feedback-list";for(const n of t||[])Vt(e,n);return e}function Xt(t,e){h(t,"msg"),t.className=t.className.replace(/(?:^| )msg-(?:success|error|warning|info)(?= |$)/,"");const n=Yt(e);return h(t,-3===n?"msg-success":n>=2?"msg-error":1===n?"msg-warning":"msg-info"),t.replaceChildren(Jt(e)),t}function Vt(t,e){let n,i;if(!function(t,e){return null==t.message||""===t.message||!t.landmark&&t.context&&e.getAttribute("data-last-mi")===t.status+" "+t.message}(e,t)){let s="";null!=e.status&&e.status>=-4&&e.status<=3&&(s=["note","success","warning-note","urgent-note","","warning","error","error"][e.status+4]),i=document.createElement("div"),-5===e.status&&t.firstChild?(n=t.lastChild,i.className="msg-inform format-inline"):(n=document.createElement("li"),t.appendChild(n),i.className=s?"is-diagnostic format-inline is-"+s:"is-diagnostic format-inline"),n.appendChild(i),Ht(i,"f",e.message),e.landmark?t.removeAttribute("data-last-mi"):t.setAttribute("data-last-mi",e.status+" "+e.message)}if(e.context){const n=e.context[0],i=u(n,e.context[1]),s=u(n,e.context[2]);let a=s>i+2?"context-mark":"context-caret-mark";e.status>0&&(a+=e.status>1?" is-error":" is-warning"),t.lastChild||t.appendChild(document.createElement("li")),t.lastChild.appendChild(S("div","msg-context",n.substring(0,i),S("span",a,n.substring(i,s)),n.substring(s)))}}let Gt={append_item:Vt,append_item_near:function(t,e){if(t instanceof RadioNodeList&&(t=t.item(0)),1!==e.status||d(t,"has-error")?e.status>=2&&(p(t,"has-warning"),h(t,"has-error")):h(t,"has-warning"),null==e.message||""===e.message)return!0;let n=t&&t.closest(".f-i, .entry, .entryi, fieldset");if(n&&d(n,"entryi")&&(n=n.querySelector(".entry")),!n)return!1;let i=n.firstElementChild;for(;i&&("LABEL"===i.tagName||"LEGEND"===i.tagName||d(i,"feedback"));)i=i.nextElementSibling;if(!i||!d(i,"feedback-list")){let t=Jt();n.insertBefore(t,i),i=t}return Vt(i,e),!0},list_status:Yt,render_list:Jt,maybe_render_list:function(t){const e=Jt(t);return e.firstChild?e:null},render_alert:function(t){return Xt(document.createElement("div"),t)},render_alert_onto:Xt,render_xhr_error_onto:function(t,e){if(t.replaceChildren(),e.message_list)for(let n of e.message_list){if(n.status<1||!n.message)continue;const e=S("span","format-inline");Ht(e,"f",n.message),t.firstChild&&t.appendChild(S("br")),t.appendChild(e)}else e.error&&(t.innerHTML=e.error);return t.firstChild||t.append("Failure"),t}};function Qt(t){return function(){const e=this,n={psetinfo:this,[t]:d(this,"active")?0:1};"gradelock"===t&&(n.grade=1),$.post(I("=api/gradeflag",n),{},function(t){if(!t)return;const n=e.closest(".pa-pv");for(;n.lastChild&&d(n.lastChild,"feedback-list");)n.lastChild.remove();if(t&&t.ok&&function(t,e){const n=t.closest(".pa-psetinfo"),i=!!e.gradecommit&&e.gradecommit===n.getAttribute("data-pa-commit");$(n).find(".pa-flagger-grade").toggleClass("active",i),$(n).find(".pa-flagger-gradelock").toggleClass("active",i&&e.gradelock),$(n).find(".pa-flagger-nograde").toggleClass("active",""===e.gradecommit)}(e,t),t&&t.message_list){const e=Gt.render_list(t.message_list||[]);h(e,"pa-feedback-list"),n.append(e)}})}}v.on("js-repo-copy",function(){var t=document.createTextNode(this.getAttribute("data-pa-repo")),e=vt(t,{color:"tooltip",dir:"t"});e.near(this);var n=document.createRange();n.selectNode(t),window.getSelection().removeAllRanges(),window.getSelection().addRange(n);try{document.execCommand("copy")}catch{}window.getSelection().removeAllRanges(),e.remove(),xt&&xt.elt==this&&xt.text(this.getAttribute("data-pa-repo"))}),v.on("js-repo-list",function(t){var e=this;$.ajax(I("=api/repositories",{u:this.getAttribute("data-pa-user")}),{method:"POST",cache:!1,success:function(t){var n="Error loading repositories";if(t.repositories&&t.repositories.length){n="Repositories: ";for(var i=0;i<t.repositories.length;++i){var s=t.repositories[i];i&&(n+=", "),n+='<a href="'+lt(s.url)+'">'+lt(s.name)+"</a>"}}else t.repositories&&(n="No repositories");$('<div style="font-size:medium;font-weight:normal"></div>').html(n).insertAfter(e)}}),t.preventDefault()}),v.on("js-pset-viewoptions",function(){x(this.nextSibling,this.parentNode)}),v.on("js-pset-setgrader",function(){var t=$(this.closest("form"));$.ajax(t[0].getAttribute("action"),{data:t.serializeWith({}),type:"POST",cache:!1,dataType:"json",success:function(e){var n;t.find(".ajaxsave61").html(e.ok?"Saved":Gt.render_xhr_error_onto(S("strong","err"),e)),e.ok&&(n=t.find("a.actas")).length&&n.attr("href",n.attr("href").replace(/actas=[^&;]+/,"actas="+encodeURIComponent(e.grader_email)))},error:function(){t.find(".ajaxsave61").html('<strong class="err">Failed</strong>')}})}),v.on("js-pset-setcommit",function(){this.closest("form").submit()}),v.on("pa-flagger",function(){let t=this,e=t.closest("form");e.elements.flagreason?$.post(I("=api/flag",{psetinfo:this,flagid:"new"}),{reason:e.elements.flagreason.value},function(n){n&&n.ok?($(e).find(".flagreasoneditor").remove(),$(t).replaceWith(S("strong",null,"Flagged"))):$(e).find(".ajaxsave61").html('<strong class="err">Failed</strong>')}):(t.parentElement.append(S("div","flagreasoneditor mt-1",S("span","flagreason mr-2","Why do you want to flag this commit?"),S("input",{type:"text",name:"flagreason",value:"",placeholder:"Optional reason",class:"need-autogrow mr-2"}),S("button",{type:"button",class:"ui pa-flagger"},"OK"),S("span","ajaxsave61"))),$(e.elements.flagreason).on("keypress",function(e){L.modcode(e)||"Enter"!==L(e)||(e.preventDefault(),e.stopImmediatePropagation(),$(t).click())}).autogrow()[0].focus(),h(t,"hidden"))}),v.on("pa-flagger-grade",Qt("grade")),v.on("pa-flagger-nograde",Qt("nograde")),v.on("pa-flagger-gradelock",Qt("gradelock")),v.on("pa-flagger-resolve",function(){let t=this,e=t.closest("form");$.post(I("=api/flag",{psetinfo:this,flagid:this.getAttribute("data-flagid"),resolve:1}),{},function(n){n&&n.ok?$(t).replaceWith("<strong>Resolved</strong>"):$(e).find(".ajaxsave61").html('<strong class="err">Failed</strong>')})});const te={};function ee(){const t=document.getElementById("dropmenu-modal");t&&t.previousSibling.matches("details[open]")?t.previousSibling.open=!1:$("details.dropmenu-details").each(function(){this.open=!1}),t&&t.remove()}function ne(t){if(t&&t.open){const e=document.getElementById("dropmenu-modal");e&&e.remove(),t.open=!1}}function ie(t){if(!t)return null;const e=t.querySelectorAll("button");if(1===e.length)return e[0];const n=t.querySelectorAll("a");return 1===n.length?n[0]:null}function se(t){const e=t.target,n=this.closest("details");if("A"===e.tagName||"BUTTON"===e.tagName)return void(e.classList.contains("dropmenu-close")&&queueMicrotask(()=>ne(n)));if(e.closest("ul")!==this)return;const i=ie(e.closest("li"));i&&("A"===i.tagName&&i.href&&"click"===t.type&&!L.is_default_a(t)?window.open(i.href,"_blank","noopener"):(i.click(),i.classList.contains("dropmenu-close")&&queueMicrotask(()=>ne(n))),t.preventDefault(),t.stopPropagation())}function ae(t){return document.activeElement&&t.contains(document.activeElement)?document.activeElement.closest("li"):null}function re(t,e){for(;t;t=t.nextElementSibling){const n=d(t,"has-link")?ie(t):null;if(n&&n.textContent.normalize("NFKD").replace(/\p{M}/gu,"").toLowerCase().startsWith(e))return n}return null}let oe,le,ce;function ue(t){const e=L(t);if("Escape"===e)oe=null,ne(this.closest("details"));else{if("Enter"===e||"Space"===e)return oe=null,void se.call(this,t);if("ArrowUp"===e||"ArrowDown"===e||"Home"===e||"End"==e){oe=null,p(this,"dropmenu-hovering");const t="ArrowUp"===e||"End"===e;let n="Home"===e||"End"===e?null:ae(this);for(n&&(n=n[t?"previousElementSibling":"nextElementSibling"]),n||(n=this[t?"lastElementChild":"firstElementChild"]);n&&!d(n,"has-link");)n=n[t?"previousElementSibling":"nextElementSibling"];const i=ie(n);i&&i.focus()}else{if(!L.printable(t)||!/^(?:\p{L}|\p{N})$/u.test(e))return void(L.printable(t)&&(oe=null));{(oe!==this||t.timeStamp-le>500)&&(ce=""),oe=this,le=t.timeStamp,ce+=e;const n=ae(this);let i=n?re(n.nextElementSibling,ce):null;i=i||re(this.firstElementChild,ce),i&&(p(this,"dropmenu-hovering"),i.focus())}}}t.preventDefault(),t.stopPropagation()}function de(){h(this,"dropmenu-hovering")}v.on("click.js-dropmenu-open",function(t){let e=document.getElementById("dropmenu-modal");if(d(this,"need-dropmenu"))for(const e of this.classList)te[e]&&te[e].call(this,t);const n=("BUTTON"===this.nodeName?this.closest("summary"):this).parentElement;if(window.$pa.tooltip.close(),n.open)"BUTTON"===this.tagName&&(e&&e.remove(),n.open=!1);else{e||(e=S("div","modal transparent"),e.id="dropmenu-modal",n.parentElement.insertBefore(e,n.nextSibling),e.addEventListener("click",ee,!1)),n.open=!0;const t=n.querySelector(".dropmenu");t&&function(t,e){t.style.maxHeight=null;const n=parseFloat(window.getComputedStyle(t).maxHeight),i=e.getBoundingClientRect();t.style.maxHeight=Math.max(Math.min(n,visualViewport.height-i.bottom-24),120)+"px",p(t,"dropmenu-hovering"),d(t,"has-dropmenu-events")||(t.addEventListener("click",se),t.addEventListener("keydown",ue),t.addEventListener("mousemove",de),h(t,"has-dropmenu-events"))}(t,n)}t.preventDefault(),t.stopPropagation()});const he=[];class pe{constructor(t){if(t.nodeType!==Node.ELEMENT_NODE||!d(t,"pa-filediff"))throw new Error;this.element=t}static closest(t){const e=t.closest(".pa-filediff");return e?new pe(e):null}static referenced(t){let e,n=t.closest(".pa-fileref").firstChild;for(;n&&"SPAN"===n.nodeName;)n=n.nextSibling;return"A"===n.tagName&&(e=pe.by_hash(n.hash)),e||pe.closest(t)}static by_file(t){const e=document.getElementById("F"+ut(t));return e?new pe(e):null}static by_hash(t){let e;return(t.startsWith("#F")||t.startsWith("#U"))&&(e=document.getElementById(t.substring(1))),e?new pe(e):null}static by_href(t){const e=t.match(/^[^#]*#(?:L[ab]\d+|)([UF][-A-Za-z0-9_.@/]+)$/),n=e&&e[1]?document.getElementById(e[1]):null;return n?new pe(n):null}static add_decorator(t){he.push(t)}load(){if(d(this.element,"need-load")){const t=this.element.closest(".pa-psetinfo"),e=d(this.element,"pa-wdiff");return p(this.element,"need-load"),new Promise(n=>{$.ajax(I("api/filediff",{psetinfo:t,wdiff:e?1:null}),{type:"GET",cache:!1,dataType:"json",data:{file:this.file,base_commit:t.getAttribute("data-pa-base-commit"),commit:t.getAttribute("data-pa-commit")},success:t=>{if(t.ok&&t.content_html){const e=$(t.content_html);$(this.element).html(e.children()),this.decorate(),$pa.render_text_page()}n(this)}})})}return new l(this)}load_if(t){return t?this.load():new l(this)}decorate(){for(let t of he)t(this)}static decorate_page(){$(".pa-filediff.need-decorate").each(function(){p(this,"need-decorate"),d(this,"need-load")||new pe(this).decorate()})}toggle(t){null==t&&(t=d(this.element,"hidden"));const e=this.element.previousSibling,n=e&&d(e,"pa-fileref")?pe.referenced(e):null,i=n&&n.element===this.element;x(this.element,i?e:null,t)}toggle_show_left(t){null==t&&(t=d(this.element,"pa-hide-left")),f(this.element,"pa-hide-left",!t),$(this.element.previousSibling).find(".pa-diff-toggle-hide-left").toggleClass("btn-primary",t)}toggle_show_comments(t){null==t&&(t=d(this.element,"pa-hide-comments")),f(this.element,"pa-hide-comments",!t),$(this.element.previousSibling).find(".pa-diff-toggle-hide-comments").toggleClass("btn-primary",!t)}get file(){const t=this.element.id;if("U"===t.charAt(0)){const e=t.indexOf("/F");return dt(t.substring(e+2))}return dt(t.substring(1))}lineid_anchor(t){return"L".concat(t,this.element.id)}lines(){return fe.all(this.element.firstChild)}line(t,e,n){return null==e&&(e=+t.substring(1),t="b"===t.charAt(0)),this.load().then(()=>{for(let i of fe.all(n||this.element.firstChild)){if(i.base_contains(t,e))return i;if(i.expansion_contains(t,e))return i.expand().then(n=>this.line(t,e,n))}throw null})}get psetinfo(){return void 0===this._psetinfo&&(this._psetinfo=this.element.closest(".pa-psetinfo")),this._psetinfo}get pset(){return this.psetinfo.getAttribute("data-pa-pset")}get repourl(){return this.psetinfo.getAttribute("data-pa-repourl")}scroll_position(){let t=this.element.getBoundingClientRect().y+window.scrollY;const e=this.element.previousSibling;return e&&"H3"===e.nodeName&&(t-=e.getBoundingClientRect().height+8),Math.max(t-8,0)}static define_method(t,e){Object.prototype.hasOwnProperty.call(pe.prototype,t)||Object.defineProperty(pe.prototype,t,{value:e,enumerable:!1,configurable:!0,writable:!0})}}class fe{constructor(t){if(t.nodeType!==Node.ELEMENT_NODE||!d(t,"pa-dl"))throw new Error;this.element=t}static closest(t){const e=t.closest(".pa-dl");return e?new fe(e):null}get filediff(){return void 0===this._filediff&&(this._filediff=pe.closest(this.element)),this._filediff}get file(){return this.filediff.file}get note_lineid(){const t=this.element;let e,n,i;return t.hasAttribute("data-landmark")?t.getAttribute("data-landmark"):d(t,"pa-dlr")&&(e=t.lastChild.firstChild)&&(n=e.getAttribute("data-landmark"))&&(i=n.indexOf("-"))>=0?(d(t,"pa-gd")?"a":"b").concat(n.substring(i+1)):d(t,"pa-gd")?"a".concat(t.firstChild.getAttribute("data-landmark")):"b".concat(t.firstChild.nextSibling.getAttribute("data-landmark"))}get linea(){const t=this.element;return d(t,"pa-gc")||d(t,"pa-gd")&&!d(t,"pa-dlr")?+t.firstChild.getAttribute("data-landmark"):this.linea_within(1/0)}get lineb(){const t=this.note_lineid;return t.startsWith("b")?+t.substring(1):null}linea_within(t){let e=this.element;for(;e&&t>=0;){if(d(e,"pa-gc"))return+e.firstChild.getAttribute("data-landmark");e=e.previousSibling,--t}return 0}get psetinfo(){return this.filediff.psetinfo}get pset(){return this.filediff.pset}get repourl(){return this.filediff.repourl}get hash(){const t=this.element,e=this.filediff.element.id;return t.hasAttribute("data-landmark")?"#L".concat(t.getAttribute("data-landmark"),e):d(t,"pa-gd")?"#La".concat(t.firstChild.getAttribute("data-landmark"),e):d(t,"pa-gi")||d(t,"pa-gc")?"#Lb".concat(t.firstChild.nextSibling.getAttribute("data-landmark"),e):null}is_visible(){return!!this.element.offsetParent}visible_predecessor(){if(!this.element.offsetParent)for(let t=this.element.previousSibling;t;t=t.previousSibling)if(d(t,"pa-dlr"))return new fe(t);return this}visible_source(){for(let t of fe.all(this,1))if(t.is_visible()&&t.is_source())return t;return null}is_base(){return/^pa-dl pa-g[idc]/.test(this.element.className)}base_contains(t,e){const n=this.element;return/^pa-dl pa-g[idc]/.test(n.className)&&(t?n.firstChild.nextSibling:n.firstChild).getAttribute("data-landmark")==e}is_source(){return/ pa-g[idc]/.test(this.element.className)}is_expandable(){return this.element.hasAttribute("data-expandmark")}expansion_contains(t,e){const n=this.element.getAttribute("data-expandmark"),i=n?n.match(/^a(\d+)b(\d+)\+(\d*)$/):null;if(!i)return!1;const s=e-i[t?2:1];return s>=0&&(!i[3]||s<i[3])}expand(){const t=this.element,e=t.getAttribute("data-expandmark"),n=e?e.match(/^a(\d+)b(\d+)\+(\d*)$/):null;if(!n||"0"===n[3])return new l(this);t.removeAttribute("data-expandmark");const i=+n[1],s=+n[2],a={psetinfo:this.element,file:this.file,fromline:s};return""!==n[3]&&(a.linecount=+n[3]),new Promise(e=>{$.ajax(I("api/blob",a),{success:function(n){if(n.ok&&n.data){const a=n.data.replace(/\n$/,"").split("\n");for(let e=a.length-1;e>=0;--e){const n='<div class="pa-dl pa-gc"><div class="pa-da" data-landmark="'.concat(i+e,'"></div><div class="pa-db" data-landmark="',s+e,'"></div><div class="pa-dd"></div></div>');$(n).insertAfter(t).find(".pa-dd").text(a[e])}const r=t.nextSibling;$(t).remove();const o=pe.closest(r);d(o.element,"pa-highlight")&&o.highlight(),e(new fe(r))}}})})}is_annotation(){return d(this.element,"pa-gn")}is_note(){return d(this.element,"pa-gw")}upper_bound(t,e){null==e&&(e=+t.substring(1),t="b"===t.charAt(0));let n=!1;for(let i of fe.all(this)){const s=i.element;if(n&&(d(s,"pa-gx")||d(s,"pa-dlr")))return i;if(i.is_source()){const a=+(t?s.firstChild.nextSibling:s.firstChild).getAttribute("data-landmark");if(!a&&n||e<a)return i;e===a&&i.is_base()&&(n=!0)}else if(s.hasAttribute("data-landmark")){const n=s.getAttribute("data-landmark");if(n.charAt(0)===(t?"b":"a")&&e<+n.substring(1))return i}}return null}static get BACKWARD(){return 1}static get ANYFILE(){return 2}static*all(t,e){t instanceof fe&&(t=t.element),e=e||0;let n=t.parentElement;const i=1&e?"previousSibling":"nextSibling";for(;;){for(;!t&&n;){if(!(2&e)&&d(n,"pa-filediff"))return;t=n[i],n=n.parentElement}if(!t)break;t.nodeType!==Node.ELEMENT_NODE?t=t[i]:d(t,"pa-dg")?(n=t,t=n[1&e?"lastChild":"firstChild"]):(d(t,"pa-dl")&&(yield new fe(t)),t=t[i])}}static*range(t,e,n,i){let s=-1,a=-1;for(let r of fe.all(t)){const t=r.element;if(!d(t,"pa-dlr")){const o=t.firstChild;if(d(o,"pa-da"))o.hasAttribute("data-landmark")&&(s=+o.getAttribute("data-landmark")),o.nextSibling.hasAttribute("data-landmark")&&(a=+o.getAttribute("data-landmark"));else if(t.hasAttribute("data-landmark")){const e=t.getAttribute("data-landmark");"a"===e.charAt(0)?s=+e.substring(1):a=+e.substring(1)}if(s>n)break;s>=e&&(!i||t.matches(i))&&(r.linea=s,r.lineb=a,yield r)}}}}function me(t){const e=t.match(/^[^#]*#(L[ab]\d+|)((?:U[-A-Za-z0-9_.@]+\/|)F[-A-Za-z0-9_.@/]+)$/),n=e&&e[1]?e[1].substring(1):null,i=e?pe.by_hash("#"+e[2]):null;i&&(n?i.line(n).then(t=>{i.toggle(!0);const e=t.visible_predecessor().element;d(e,"pa-gd")&&i.toggle_show_left(!0),h(e,"pa-line-highlight"),window.scrollTo(0,Math.max($(e).geometry().top-Math.max(.1*window.innerHeight,24),0))}).catch(()=>{window.console&&window.console.error(`Line \`${e[1]}${e[2]}\` not loadable`)}):i.load().then(()=>{i.toggle(!0),window.scrollTo(0,i.scroll_position())}).catch(()=>{window.console&&window.console.error(`File \`${e[2]}\` not loadable`)}))}function ge(){const t=this.closest(".pa-fileref");if(this.open){t&&(t.style.zIndex=2);const e=this.lastElementChild.firstChild;$(e).awaken().find(".want-focus").focus()}else t&&(t.style.zIndex=null),this.removeEventListener("toggle",ge)}let be,_e;var ve;v.on("pa-diff-unfold",function(t){const e=t.metaKey?$(".pa-diff-unfold"):$(this),n=pe.by_hash(this.hash),i=d(n.element,"hidden"),s=!!t.metaKey||i;e.each(function(){pe.by_hash(this.hash).load().then(t=>t.toggle(s))}),t.metaKey||$.post(I("=api/diffconfig",{psetinfo:n.element,file:n.file,collapse:i?0:1}))}),v.on("pa-diff-toggle-hide-left",function(t){const e=t.metaKey?$(".pa-diff-toggle-hide-left"):$(this),n=d(pe.referenced(this).element,"pa-hide-left");e.each(function(){pe.referenced(this).toggle_show_left(n)})}),v.on("pa-diff-toggle-hide-comments",function(t){const e=t.metaKey?$(".pa-diff-toggle-hide-comments"):$(this),n=d(pe.referenced(this).element,"pa-hide-comments");e.each(function(){pe.referenced(this).toggle_show_comments(n)})}),v.on("pa-filenav",function(){me(this.hash)}),v.on("pa-filenav-all",function(){for(const t of this.closest("nav").querySelectorAll(".pa-filenav")){const e=pe.by_href(t.href);e&&e.load().then(()=>{e.toggle(!0)})}}),d(document.body,"want-grgraph-hash")||($(window).on("popstate",function(t){const e=(t.originalEvent||t).state;e&&e.href&&me(e.href)}).on("hashchange",function(){me(location.href)}),$(function(){me(location.href)})),v.on("pa-gx",function(t){new fe(t.currentTarget).expand()}),$(pe.decorate_page),ve=function(){const t=this.closest(".pa-diffset"),e=this.closest(".pa-psetinfo"),n=S("ul","dropmenu need-dropmenu-events");for(let i=t.firstElementChild;i;i=i.nextElementSibling)n.appendChild(S("li","has-link",S("a",{href:"#"+i.id,class:"dropmenu-close"+(i===e?" want-focus":""),role:"menuitem"},i.getAttribute("data-pa-user"))));const i=this.closest("details");i.lastElementChild.replaceChildren(n),i.addEventListener("toggle",ge)},te["pa-dropmenu-diffmany"]=ve;const ye=/[^ \t\r\n]/;function xe(t,e,n){try{const n=hljs.highlight(e,{language:t,ignoreIllegals:!0}),i=n.value;return e.endsWith("\r\n")&&i.endsWith("\n\n")&&(n.value=i.substring(0,i.length-1)),n}catch{return null}}function we(t){return t[0]+1===t[1]?String(t[1]):t[0]+1+"-"+t[1]}function ke(t,e,n,i,s){var a=t[e];return a.map&&0===a.level&&a.attrSet("data-landmark",we(a.map)),s.renderToken(t,e,n,i)}function Ce(t,e,n,i,s){var a=t[e];return a.map&&a.level<=1&&a.attrSet("data-landmark",we(a.map)),s.renderToken(t,e,n,i)}function Ae(t,e){if(e.map&&0===e.level){var n=' data-landmark="'+we(e.map)+'"',i=t.indexOf(" "),s=t.indexOf(">");i>0&&i<s&&(s=i),t=t.substring(0,s)+n+t.substring(s)}return t}function Ee(t){return t?function(e,n,i,s,a){var r=e[n];return Ae(t(e,n,i,s,a),r)}:ke}function $e(t){for(var e;(e=t.firstChild)&&1!==e.nodeType;)t.removeChild(e);if(e&&e.hasAttribute("data-landmark")){for(;e.nextSibling&&1!==e.nextSibling.nodeType;)t.removeChild(e.nextSibling);if(e.nextSibling){"OL"===t.tagName&&(e.hasAttribute("value")||(e.value=t.start),t.start=e.value+1);var n=document.createElement(t.tagName);n.appendChild(t.removeChild(e)),t=n}t.setAttribute("data-landmark",e.getAttribute("data-landmark"))}return t}pe.define_method("markdown",function(){const t=this.element;if(d(t,"pa-markdown")||d(t,"pa-highlight"))return;const e=d(t,"pa-hide-landmarks"),n=e?"pa-dr pa-dhlm":"pa-dr";let i=t.firstChild,s=[],a=1;for(;i;){let e=i.nextSibling;if(d(i,"pa-dlr"))t.removeChild(i);else if(d(i,"pa-gi")||d(i,"pa-gc")){const t=+i.firstChild.nextSibling.getAttribute("data-landmark");for(;a<t;)s.push("\n"),++a;s.push(i.lastChild.textContent),++a,i.hidden=!0}i=e}let r,o,l=document.createElement("div");for(_e=t,l.innerHTML=function(){if(!be){for(var t of(be=markdownit({linkify:!0}).use(markdownit_katex).use(Dt),["paragraph_open","heading_open","ordered_list_open","bullet_list_open","table_open","blockquote_open","hr"]))be.renderer.rules[t]=Ee(be.renderer.rules[t]);be.renderer.rules.fence=be.renderer.rules.code_block=function(t){return function(e,n,i,s,a){const r=e[n];let o,l=r.info?t.utils.unescapeAll(r.info):"";l&&l.indexOf(" ")>=0&&((o=l.match(/^ *([-a-z+]+) *$/))?l=o[1]:(r.content=l+"\n"+r.content,r.map&&(r.map[0]-=1),l=""));let c=l?l.trim().split(/\s+/g)[0]:"";c&&hljs.getLanguage(c)||(c=null);let u=r;if(c){let t=r.attrIndex("class");u={attrs:r.attrs?r.attrs.slice():[]},t<0?u.attrs.push(["class",i.langPrefix+c]):u.attrs[t][1]+=" "+i.langPrefix+c}let d="><code".concat(a.renderAttrs(u),">");if(r.map&&0===r.level){const t=r.content.split(/\n/),e=[];""===t[t.length-1]&&t.pop();const n=t.length;let i=0,s=r.map[0]+2,a=null;for(;c&&i!==n;){const r=xe(c,t[i]+"\n");if(!r)break;e.push('<pre data-landmark="',s+i,i+1!==n?'" class="partial"':'"',d,r.value,"</code></pre>"),a=r.top,++i}for(;i!==n;)e.push('<pre data-landmark="',s+i,i+1!==n?'" class="partial"':'"',d,t[i],"\n</code></pre>"),++i;return e.join("")}return"<pre".concat(d,t.utils.escapeHtml(r.content),"</code></pre>")}}(be),be.renderer.rules.image=function(t){function e(t,e){return siteinfo.site_relative+"~"+encodeURIComponent(siteinfo.uservalue)+"/raw/"+t.getAttribute("data-pa-pset")+"/"+t.getAttribute("data-pa-commit")+"/"+e}return function(n,i,s,a,r){var o,l,c,u=n[i],d=u.attrIndex("src"),h=u.attrs[d][1];if(siteinfo.uservalue&&_e&&(o=_e.closest(".pa-psetinfo"))){if(!/\/\//.test(h)){for(var p=pe.closest(_e),f=p?p.file.replace(/^(.*)\/[^/]*$/,"$1"):"";;)if(h.startsWith("./"))h=h.substring(2).replace(/^\/+/,"");else if(h.startsWith("../")&&""!==f)h=h.substring(3).replace(/^\/+/,""),f=f.replace(/(?:^|\/)[^/]+\/*$/,"");else{if(h.startsWith("../")||h.startsWith("/")){h=null;break}if(!(l=h.match(/(^|\/+)[^/]+\/\.\.(?:\/+|$)(.*)$/)))break;h=l[1]+l[2]}u.attrs[d][1]=h?e(o,f?f+"/"+h:h):"data:image/jpg,"}(l=h.match(/^https:\/\/github\.com\/([^/]+\/[^/]+)\/(?:blob|raw)\/([^/]+)\/(.*)$/))&&(c=(o.getAttribute("data-pa-repourl")||"").match(/^(?:https:\/\/github\.com\/|git@github\.com:)(.*?)\/?$/))&&c[1]==l[1]&&o.getAttribute("data-pa-branch")==l[2]&&(u.attrs[d][1]=e(o,l[3]))}return Ae(t(n,i,s,a,r),u)}}(be.renderer.rules.image),be.renderer.rules.list_item_open=Ce}return be}().render(s.join("")),_e=null,i=t.firstChild;r=l.firstChild;){if(1!==r.nodeType){l.removeChild(r);continue}"OL"===r.tagName||"UL"===r.tagName?r=$e(r):"P"===r.tagName&&1===r.firstChild.nodeType&&"IMG"===r.firstChild.tagName&&r.firstChild===r.lastChild&&h(r,"image-container");const s=document.createElement("div");s.className="pa-dl pa-dlr";const a=document.createElement("div");a.className="pa-da",a.hidden=e;const c=document.createElement("div");c.className="pa-db",c.hidden=e;const u=r.getAttribute("data-landmark");if(u){let t=parseInt(u),e=u.indexOf("-"),n=e>=0?parseInt(u.substring(e+1)):t;for(;i&&!((d(i,"pa-gi")||d(i,"pa-gc"))&&+i.firstChild.nextSibling.getAttribute("data-landmark")>=t);)i=i.nextSibling;c.setAttribute("data-landmark",t);let a=0,r=i;for(;r;){if(d(r,"pa-gi")||d(r,"pa-gc")){if(+r.firstChild.nextSibling.getAttribute("data-landmark")>=n)break;a|=d(r,"pa-gi")?1:2}r=r.nextSibling}s.className+=2===a?" pa-gc":" pa-gi"}for(o=document.createElement("div"),o.className=n,r===l.firstChild&&l.removeChild(r),o.appendChild(r);l.firstChild&&1!==l.firstChild.nodeType;)o.appendChild(l.removeChild(l.firstChild));s.append(a,c,o),t.insertBefore(s,i)}o&&h(o,"pa-dr-last"),h(t,"pa-markdown"),p(t,"need-markdown")}),pe.define_method("unmarkdown",function(){const t=this.element;let e=t.firstChild;for(;e;){var n=e.nextSibling;d(e,"pa-dlr")?t.removeChild(e):(d(e,"pa-gi")||d(e,"pa-gc"))&&(e.hidden=!1),e=n}p(t,"pa-markdown")}),pe.define_method("highlight",function(){const t=this.element;let e;if(!(e=t.getAttribute("data-language"))){let n=this.file;/\.(?:cc|cpp|hh|hpp|c\+\+|h\+\+|C|H)$/.test(n)?e="c++":/\.(?:c|h)$/.test(n)&&(e="c"),e&&t.setAttribute("data-language",e)}if(!e||!hljs.getLanguage(e)||d(t,"pa-markdown"))return;const n="language-"+e;let i=t.firstChild,s=null,a=null;for(;i;i=i.nextSibling){const t=d(i,"pa-gi")?2:d(i,"pa-gc")?3:d(i,"pa-gd")?1:0;if(0===t)continue;const r=i.lastChild,o=d(r,n),l=o?r.getAttribute("data-pa-text"):r.textContent,c=xe(e,l);if(!c)break;if(1&t&&(a=c.top),2&t&&(s=c.top),o)continue;r.setAttribute("data-pa-text",l),r.innerHTML=c.value,h(r,n);let u=0;for(let t=r.firstChild;t;t=t.nextSibling){if(1===t.nodeType&&!d(t,"hljs-comment")||3===t.nodeType&&ye.test(t.textContent)){u=-1;break}1===t.nodeType&&(u=1)}0===u?h(i,"pa-gblank"):1===u&&h(i,"pa-gcomment")}h(t,"pa-highlight"),p(t,"need-highlight")}),pe.define_method("unhighlight",function(){const t=this.element,e=t.getAttribute("data-language"),n=e?"language-"+e:"";let i,s=t.firstChild;for(;s;)(i=s.lastChild)&&i.hasAttribute("data-pa-text")&&(!n||d(i,n))&&(i.innerText=i.getAttribute("data-pa-text"),i.removeAttribute("data-pa-text"),n&&p(i,n)),s=s.nextSibling;p(t,"pa-highlight")}),pe.add_decorator(function(t){d(t.element,"need-markdown")?t.markdown():d(t.element,"need-highlight")&&t.highlight()}),v.on("pa-diff-toggle-markdown",function(t){const e=t.metaKey?$(".pa-diff-toggle-markdown"):$(this),n=pe.referenced(this),i=!d(n.element,"pa-markdown");e.each(function(){const t=pe.referenced(this),e=d(t.element,"pa-markdown");i&&!e?t.markdown():!i&&e&&t.unmarkdown(),f(this,"btn-primary",i)}),t.metaKey||$.post(I("=api/diffconfig",{psetinfo:n.element}),{file:n.file,markdown:i?1:0})});class Se{constructor(){this.iscomment=!1,this.ftext="",this.format=null}empty(){return""===this.ftext}get file(){return pe.closest(this.element||this.source).file}get lineid(){return this.element?this.element.getAttribute("data-landmark"):new fe(this.source).note_lineid}get linea(){return new fe(this.element||this.source).linea}linea_within(t){return new fe(this.element||this.source).linea_within(t)}get editable_text(){return Kt.parse(this.ftext)[1]}static parse(t){const e=new Se;return"string"==typeof t&&""!==t&&(t=JSON.parse(t)),e.assign(t),e}assign(t){let e=[null,""];"number"==typeof t?(this.iscomment=!1,this.ftext="",this.users=null,this.version=t):Array.isArray(t)&&(this.iscomment=t[0],this.ftext=t[1],e=Kt.parse(t[1]),this.users=t[2]||null,this.version=t[3]&&"number"==typeof t[3]?t[3]:null),this.format=e[0];const n=this.element;if(n)if(""===this.ftext&&null==this.version)n.removeAttribute("data-pa-note");else if(""===this.ftext&&null==this.users)n.setAttribute("data-pa-note",""+this.version);else{const t=[this.iscomment,this.ftext];null==this.users&&null==this.version||t.push(this.users,this.version),n.setAttribute("data-pa-note",JSON.stringify(t))}return this}static at(t){const e=Se.parse(t.getAttribute("data-pa-note"));return e.element=t,e}static closest(t){const e=t.closest(".pa-dl");return e?Se.at(e):null}static near(t){t instanceof fe&&(t=t.element);let e=t;for(;e;)if(1!==e.nodeType)e=e.nextSibling;else{if(d(e,"pa-gw"))return Se.at(e);if(!(e===t||d(e,"pa-gn")||d(e,"pa-gx")||e.hidden))break;e=e.nextSibling}const n=new Se;return n.source=t,n}force_element(){if(!this.element){const t=new fe(this.source),e=t.note_lineid,n=t.upper_bound(e);this.element=document.createElement("div"),this.element.className="pa-dl pa-gw",this.element.setAttribute("data-landmark",e),(this.version||""!==this.ftext)&&this.element.setAttribute("data-pa-note",JSON.stringify([this.iscomment,this.ftext,this.users,this.version]));let i=document.createElement("div");i.className="pa-notebox",this.element.appendChild(i),this.source.parentElement.insertBefore(this.element,n?n.element:null)}return this.element}cancel_edit(){return this.element&&d(this.element,"editing")&&$(this.element).find("textarea").val(this.editable_text),this}render(t){if(this.force_element(),d(this.element,"editing")){const t=$(this.element).find("textarea");if(t.length&&!c(this.editable_text,t.val().replace(/\s+$/,"")))return!1;p(this.element,"editing"),$(this.element).find(":focus").blur()}const e=$(this.element).find(".pa-notebox"),n=e.children();if(t?n.slideUp(80).queue(function(){n.remove()}):n.remove(),""===this.ftext)return De(this.element),t?$(this.element).children().slideUp(80):this.element.hidden=!0,!0;const i=document.createElement("div");if(i.className="pa-notecontent clearfix",this.users){const t=$.isArray(this.users)?this.users:[this.users],e=[];for(let n in t){const i=siteinfo.pc?siteinfo.pc[t[n]]:null;i&&(i.nick?e.push(i.nick):i.nicklen||i.lastpos?e.push(i.name.substr(0,i.nicklen||i.lastpos-1)):e.push(i.name))}if(e.length){const t=document.createElement("div");t.className="pa-note-author",t.append("["+e.join(", ")+"]"),i.append(t)}}if(!this.iscomment){const t=document.createElement("div");t.className="pa-gradenote-marker",i.append(t)}const s=document.createElement("div");return s.className="pa-dr pa-note pa-".concat(this.iscomment?"comment":"grade","note"),i.append(s),e.append(i),Ht(s,"f",this.ftext),De(this.element),t?$(i).hide().slideDown(80):e.show(),this.element.hidden=!1,!0}save_ftext(t,e){if(this.element){if(d(this.element,"pa-outstanding"))return Promise.reject(new Error("Outstanding request"));h(this.element,"pa-outstanding")}const n=this.element&&d(this.element,"editing"),i=this,s=this.element||this.source,a=s.closest(".pa-filediff").closest(".pa-psetinfo"),r=s.closest(".pa-grade-range-block"),o={ftext:t},l=this.linea_within(1e3);return e&&(o.iscomment=1),l&&(o.linea=l),r&&r.setAttribute("data-pa-notes-outstanding",+r.getAttribute("data-pa-notes-outstanding")+1),new Promise(function(t,e){Q(I("=api/linenote",{psetinfo:a,file:i.file,line:i.lineid,oldversion:i.version||0}),o).then(function(s){if(i.element&&p(i.element,"pa-outstanding"),s&&s.ok){i.force_element(),p(i.element,"pa-save-failed");const e=s.linenotes[i.file];i.assign(e&&e[i.lineid]),i.render(n),t(i),i.file.startsWith("/g/")&&a&&a.pa__gradesheet&&a.pa__gradesheet.add_linenotes(s.linenotes)}else i.element&&h(i.element,"pa-save-failed"),n&&$(i.element).find(".pa-save-message").html(Gt.render_xhr_error_onto(S("strong","err"),s)),e(new Error("Save failed"));r&&function(t){var e=+t.getAttribute("data-pa-notes-outstanding")-1;e?t.setAttribute("data-pa-notes-outstanding",e):(t.removeAttribute("data-pa-notes-outstanding"),$(t).find(".pa-grade").each(function(){$pa.gradeentry_closest(this).save_landmark_grade(t)}))}(r)})})}save_text(t,e){let n=this.format;return null==n&&(n=+document.body.getAttribute("data-default-format"),isNaN(n)&&(n=0)),this.save_ftext(Kt.unparse(n,t),e)}}function Ne(t,e){let n,i=$(t).find(".pa-note-links a");i.length||(i=$("<a></a>"),$('<div class="pa-note-links"></div>').append(i).prependTo($(t).find(".pa-notecontent"))),e?(i.attr("href",new fe(e).hash),n="NEXT >"):(i.attr("href",""),n="TOP"),i.text()!==n&&i.text(n)}function De(t){const e=$(".pa-gw");let n=0;for(;n<e.length&&e[n]!==t;)++n;if(n<e.length){let i=n-1;for(;i>=0&&Se.at(e[i]).empty();)--i;let s=n+1;for(;s<e.length&&Se.at(e[s]).empty();)++s;i>=0&&Ne(e[i],Se.at(t).empty()?e[s]:t),Ne(t,e[s])}}let Fe={};const Me={red:"cR",orange:"cO",yellow:"cY",green:"cG",blue:"cB",purple:"cP",gray:"cA",grey:"cA"},Te={basic_text:t=>null==t?"":""+t,basic_mount_edit:function(t,e,n){let i=document.createElement("span");i.className="pa-gradedesc",n&&n.max_text?i.append(n.max_text):this.max&&i.append("of "+this.max);const s=new DocumentFragment;let a;return window.$pa.long_page?(a=document.createElement("textarea"),a.className="ta1 uich uii pa-gradevalue pa-gradewidth pa-fresh",a.setAttribute("rows",1),a.setAttribute("cols",1e4),a.setAttribute("wrap","none")):(a=document.createElement("input"),a.type="text",a.className="uich uii pa-gradevalue pa-gradewidth pa-fresh"),a.name=this.key,a.id=e,a.disabled=this.disabled,s.append(a," ",i),s},basic_mount_show:function(t,e){t.id=e;const n=[document.createElement("span")];n[0].className="pa-gradevalue pa-gradewidth",this.max&&"letter"!==this.type&&(n.push(" ",document.createElement("span")),n[2].className="pa-gradedesc",n[2].append("of "+this.max)),t.replaceChildren(...n)},basic_unmount:function(t){t.remove()},basic_update_edit:function(t,e,n){const i=t.querySelector(".pa-gradevalue"),s=this.simple_text(e);C(i,s),i.value=s,null!=n.mixed&&(n.mixed?i.setAttribute("placeholder","Mixed"):i.removeAttribute("placeholder"))},basic_configure_column:function(t){t.ge=this,t.gabbr=this.abbr(),t.justify=this.gc.justify||"right",t.sort_forward="forward"===this.gc.sort;const e=this.gc.justify||"right";return t.gkey===t.ptconf.total_key?t.className=this.readonly?"gt-total":"gt-total gt-grade":t.className=this.readonly?"gt-rograde":"gt-grade",t.className+="left"===e?" l":" r",this.table_color&&Me[this.table_color]&&(t.className+=" "+Me[this.table_color]),t.make_compare=e=>this.gc.make_compare.call(this,t,e),t},basic_make_compare:function(t){const e=t.gidx,n="forward"===this.gc.sort?1:-1;return function(t,i){const s=t.grades&&t.grades[e],a=i.grades&&i.grades[e];if(""===s||null==s||""===a||null==a){if(""!==s&&null!=s)return-n;if(""!==a&&null!=a)return n}else{if(s<a)return-1;if(s>a)return 1}return n*t._sort_user.localeCompare(i._sort_user)}},basic_tcell_width:function(){return 3},add:(t,e)=>{e.type=t,e.initialize=e.initialize||(()=>null),e.type_tabular=null==e.type_tabular||e.type_tabular,e.text=e.text||Te.basic_text,e.simple_text=e.simple_text||e.text,e.configure_column=e.configure_column||Te.basic_configure_column,e.tcell_width=e.tcell_width||Te.basic_tcell_width,e.tcell=e.tcell||e.text,e.make_compare=e.make_compare||Te.basic_make_compare,e.mount_show=e.mount_show||Te.basic_mount_show,e.mount_edit=e.mount_edit||Te.basic_mount_edit,e.update_edit=e.update_edit||Te.basic_update_edit,e.unmount=e.unmount||Te.basic_unmount,Fe[t]=e},find:t=>Fe[t]||Fe.numeric};Te.add("numeric",{mount_edit:Te.basic_mount_edit}),Te.add("formula",{text:function(t){if(null==t||!1===t)return"";if(!0===t)return"";const e=t.toFixed(1);return e.endsWith(".0")?e.substring(0,e.length-2):e}}),Te.add("time",{text:function(t){return null==t||0===t?"":r("%Y-%m-%d %H:%M",t)},tcell_width:10,justify:"left",sort:"forward"}),Te.add("duration",{text:function(t){return null==t?"":o(t,"quarterhour")},tcell_width:4,justify:"left",sort:"forward"}),Te.add("section",{text:()=>"",mount_show:function(t,e){t.id=e,h(t.closest(".pa-p"),"pa-p-section")},mount_edit:function(t){h(t.closest(".pa-p"),"pa-p-section")},update_show:function(){return!1},update_edit:function(){return!1},type_tabular:!1}),Te.add("none",{mount_show:function(){},mount_edit:function(){},update_show:function(){return!1},update_edit:function(){return!1},type_tabular:!1});const Le=".pa-dg, .pa-gradelist";function je(t,e,n){const i=e?"previousElementSibling":"nextElementSibling",s=e?"lastElementChild":"firstElementChild";n&&(t=t.closest(Le));let a,r=t.parentElement,o=!1;for(;r;)if(o||(t=t[i]),o=!1,t)if(d(t,"pa-dg")||d(t,"pa-gradelist")){if(n){if(a=t.querySelector(".pa-sidebar"))return a}else if(a=t.querySelectorAll(".pa-gradevalue"),a.length>0)return a[e?a.length-1:0].closest(Le)}else d(t,"pa-psetinfo")&&(a=t[s])&&(r=t,t=a,o=!0);else r=(t=r).parentElement;return null}function Oe(t,e,n){let i=t.closest(n?".pa-sidebar":Le),s=i.querySelectorAll(".pa-gradevalue"),a=Array.prototype.indexOf.call(s,t);if(a<0)return null;for(;;)if(a+=e?-1:1,a<0||a>=s.length){if(!(i=je(i,e,n)))return null;s=i.querySelectorAll(".pa-gradevalue"),a=e?s.length:-1}else{const t=s[a],e=t.tagName;if(t.offsetParent&&("INPUT"===e||"TEXTAREA"===e||"SELECT"===e||"BUTTON"===e)&&(n||!t.closest(".pa-sidebar")))return t}}document.body.addEventListener("keydown",function(t){if("Tab"!==t.key||!d(t.target,"pa-gradevalue")||t.ctrlKey||t.metaKey)return;let e;t.target.closest(".pa-sidebar")?e=Oe(t.target,t.shiftKey,!0):t.altKey&&(e=Oe(t.target,t.shiftKey,!1)),e&&(e.focus({focusVisible:!0}),"textarea"!==e.type&&"text"!==e.type||e.setSelectionRange(0,e.value.length),t.preventDefault())});let ze,Be=0;const Ie={pset:!0,uid:!0,user:!0,anon_user:!0,email:!0,first:!0,last:!0,year:!0,x:!0,dropped:!0,imageid:!0,commit:!0,base_commit:!0,base_handout:!0,grade_commit:!0,emptydiff:!0,grade_status:!0,late_hours:!0,auto_late_hours:!0,student_timestamp:!0,grades_latest:!0,version:!0,history:!0,total_type:!0,total:!0,total_noextra:!0,answer_version:!0,scores_editable:!0,answers_editable:!0,linenotes:!0,gradercid:!0,has_notes:!0,has_nongrader_notes:!0,repo:!0,repo_broken:!0,repo_unconfirmed:!0,repo_too_open:!0,repo_handout_old:!0,repo_partner_error:!0,repo_sharing:!0,flagid:!0,conversation:!0,conversation_pfx:!0,at:!0};function qe(){if(p(this,"pa-resetgrade"),this.removeEventListener(this,qe,!1),!A(this)){const t=We.closest(this),e=this.closest(".pa-grade");queueMicrotask(function(){t.update_at(e)})}}function Re(t){const e=document.createElement("span");return document.body.appendChild(e),Ht(e,"f",t),e.remove(),e}class Pe{constructor(t){Object.assign(this,t),this.type=this.type||"numeric",this.gc=Te.find(this.type),this.disabled=!!this.disabled,this.normal=!0,this._abbr=null,this._all=null,this.gc.initialize.call(this)}get type_tabular(){return this.gc.type_tabular}student_visible(t){return!0===this.visible||null==this.visible&&(this.answer||t.scores_visible)}get title_node(){let t,e=this.title;return e?60===e.charCodeAt(0)&&(t=e.charCodeAt(1))>=48&&t<=57?Re(e):e:this.key}get title_html(){let t,e=this.title;return e?60===e.charCodeAt(0)&&(t=e.charCodeAt(1))>=48&&t<=57?Re(e).innerHTML:lt(e):this.key}get title_text(){let t,e=this.title;return e?60===e.charCodeAt(0)&&(t=e.charCodeAt(1))>=48&&t<=57?Re(e).textContext:e:this.key}abbr(){return this._abbr||this.compute_abbr(),this._abbr}compute_abbr(){const t=this._all?this._all.order:[this.key],e=this._all?this._all.value_order:[this.key],n=this._all?this._all.entries:{[this.key]:this};let i={},s=[];for(let e=0;e!==t.length;++e)n[t[e]]._abbr=":"+e;for(let t=0;t!==e.length;++t){const a=n[e[t]],r=a.title_text;s.push(r);let o=r.match(/^(p)(?:art[\s\d]|(?=\d))([-.a-z\d]+)(?:[\s:]+|$)/i)||r.match(/^(q)(?:uestion[\s\d]|(?=\d))([-.a-z\d]+)(?:[\s:]+|$)/i)||r.match(/^[\s:]*()(\S{1,3}[\d.]*)[^\s\d]*[\s:]*/);if(o){let e,n=o[1]+o[2],s=r.substring(o[0].length);for(;e=i[n];){if(!0!==e&&(o=e[1].match(/^(\S{1,3}[\d.]*)\S*[\s:]*(.*)$/))&&(e[0]._abbr+=o[1],i[e[0]._abbr]=[e[0],o[2]],i[n]=e=!0),!(o=s.match(/^(\S{1,3}[\d.]*)[^\s\d]*[\s:]*(.*)$/))){!0!==e&&(n+=":"+t);break}n+=o[1],s=o[2]}a._abbr=n,i[n]=[a,s]}}}render(t,e){null==e&&(e=!this.readonly&&(this.answer?t.answers_editable:t.scores_editable)?2:0);const n="pe-ge"+ ++Be,i=document.createElement("div"),s=document.createElement("label"),a=document.createElement(2===e?"form":"div"),r=this.student_visible(t)?"":" pa-p-hidden";if(i.className="pa-grade pa-p".concat(e?" e":"",this.answer?" pa-ans":"",r),i.setAttribute("data-pa-grade",this.key),s.className="pa-pt",s.htmlFor=n,s.innerHTML=this.title_html,i.appendChild(s),this.description){const t=document.createElement("div");t.className="pa-pdesc pa-dr",Ht(t,"f",this.description),i.appendChild(t)}return a.className=2===e?"ui-submit pa-pv"+(this.description?" pa-textv":""):"pa-pv",i.appendChild(a),this.mount_at(a,n,e),i}mount_at(t,e,n){let i;i=n?this.gc.mount_edit.call(this,t,e):this.gc.mount_show.call(this,t,e),"string"==typeof i?t.innerHTML=i:i&&t.replaceChildren(i),n&&$(t).find(".need-autogrow").autogrow()}update_edit(t,e,n){const i=t.querySelector(".pa-gradevalue"),s=this.simple_text(e);if(this.max){const n=t.nextSibling&&t.nextSibling.classList.contains("pa-gradeabovemax");if(!e||e<=this.max)n&&t.parentElement.removeChild(t.nextSibling);else if(!n){const e=document.createElement("div");e.classList="pa-pvnote pa-gradeabovemax",e.textContent="Grade is above max",t.parentElement.insertBefore(e,t.nextSibling)}}let a=t.querySelector(".pa-gradediffers");if(null==n.autograde||e===n.autograde)a&&a.remove();else{const e=("late_hours"===this.key?"auto-late hours":"autograde")+" is "+this.text(n.autograde);a||t.appendChild(a=S("span","pa-gradediffers")),a.textContent!==e&&(a.textContent=e)}if(d(t,"pa-dirty"))return;if(i&&"hidden"!==i.type&&i.matches(":focus"))return void(d(i,"pa-resetgrade")||s===k(i)||(h(i,"pa-resetgrade"),i.addEventListener("blur",qe,!1)));const r=i&&d(i,"pa-fresh");!(n.reset||r)&&i||this.gc.update_edit.call(this,t,e,n),i&&C(i,s),this.landmark&&this.update_landmark(t),i&&n.sidebar&&(i.tabIndex=-1),r&&p(i,"pa-fresh"),$(t).find("input, textarea").autogrow()}update_show(t,e,n){const i=t.classList.contains("pa-gradevalue")?t:t.querySelector(".pa-gradevalue");let s;if(this.gc.update_show)s=this.gc.update_show.call(this,i,e,n);else{let t=this.text(e);s=""===t&&(!this.max||this.required)&&!this.answer,s||(""===t&&(t=""),i.textContent!==t&&(i.textContent=t))}if(null!=s){const e=t.closest(".pa-grade");f(e,this.description?"pa-hidden-description":"hidden",s)}this.landmark&&this.update_landmark(t)}update_at(t,e,n){let i=t.firstChild;for(;!d(i,"pa-pv");)i=i.nextSibling;d(t,"e")?this.update_edit(i,e,n):this.update_show(i,e,n)}update_landmark(t){const e=t.closest(".pa-gradelist");if(!e||!d(e,"want-landmark-links"))return;let n=t.querySelector(".pa-gradeboxref");if(this.landmark?n&&n.getAttribute("data-landmark")===this.landmark:!n)return;const i=/^(.*):(\d+)$/.exec(this.landmark);if(i&&pe.by_file(i[1])){const e=t.closest(".pa-psetinfo").getAttribute("data-pa-directory")||"",s=i[1].startsWith(e)?i[1].substring(e.length):i[1];n||t.append(n=S("span","pa-gradeboxref")),n.setAttribute("data-landmark",this.landmark),n.replaceChildren("@",S("a",{href:"#La".concat(i[2],"F",ut(i[1]))},s+":"+i[2]))}else n&&n.remove()}unmount_at(t){this.gc.unmount.call(this,t)}text(t){return this.gc.text.call(this,t)}simple_text(t){return this.gc.simple_text.call(this,t)}configure_column(t){return this.gc.configure_column.call(this,t)}tcell_width(){const t=this.gc.tcell_width||3;return"function"==typeof t?t.call(this):t}tcell(t){return this.gc.tcell.call(this,t)}landmark_lines(t,e){const n=this.landmark_range?/:(\d+):(\d+)$/.exec(this.landmark_range):null;if(!n)throw new Error("bad landmark_lines");const i=+n[1];let s,a=t instanceof fe?t.element:t;for(;!d(a,"pa-filediff")&&(!(s=a.getAttribute("data-pa-landmark"))||"a"!==s.charAt(0)||parseInt(s.substring(1))>i);)a=a.parentElement;return fe.range(a,+n[1],+n[2],e)}landmark_grade(t){let e=null;for(let n of this.landmark_lines(t,".pa-gw")){const t=Se.at(n.element);let i,s;t.text&&((i=/^[\s]*(\+)(\d+(?:\.\d+)?|\.\d+)((?![.,]\w|[\w%$*])\S*?)[.,;:]?(?:\s|$)/.exec(t.text))||(i=/^[\s]*()(\d+(?:\.\d+)?|\.\d+)(\/[\d.]+(?![.,]\w|[\w%$*/])\S*?)[.,;:]?(?:\s|$)/.exec(t.text)))&&(null===e&&(e=0),e+=parseFloat(i[2]),s=lt(this.title_text).concat(": ",lt(i[1]),"<b>",lt(i[2]),"</b>",lt(i[3])));let a=$(n.element).find(".pa-note-gradecontrib");!a.length&&s&&(a=$(S("div","pa-note-gradecontrib")).insertBefore($(n.element).find(".pa-note"))),s?a.html(s):a.remove()}this.round&&null!=e&&(e="up"===this.round?Math.ceil(e):"down"===this.round?Math.floor(e):Math.round(e));const n=t.closest(".pa-grade")||t.closest(".pa-grade-range-block");let i=n.querySelector(".pa-notes-grade");if(null===e)i.remove();else{if(!i){let t=(d(n,"pa-grade")?n:n.querySelector(".pa-grade")).firstChild;for(;t&&!d(t,"pa-pv");)t=t.nextSibling;for(t=t.firstChild;t&&(1!==t.nodeType||d(t,"pa-gradewidth")||d(t,"pa-gradedesc"));)t=t.nextSibling;i=S("button",{type:"button",class:"link uic uikd pa-notes-grade"}),this.lastChild.insertBefore(i,t)}i.textContent="Notes grade "+e}return e}save_landmark_grade(t){const e=this.landmark_grade(t),n=t.querySelector(".pa-gradevalue");if(n){const t=null===e?"":""+e,i=$(n).val();i==n.getAttribute("data-pa-notes-grade")&&t!=i&&$(n).val(t).change(),n.setAttribute("data-pa-notes-grade",t)}return e}value_order_in(t){const e=t.vpos[this.key];return null!=e?e:null}value_in(t){const e=t.grades?t.vpos[this.key]:null;return null!=e?t.grades[e]:null}autovalue_in(t){const e=t.autogrades?t.vpos[this.key]:null;return null!=e?t.autogrades[e]:null}has_later_value_in(t){return this.answer&&t.grades_latest&&this.key in t.grades_latest&&this.value_in(t)!==t.grades_latest[this.key]}static closest(t){const e=t.closest(".pa-grade");return We.closest(e).entries[e.getAttribute("data-pa-grade")]}static late_hours(){return ze=ze||new He,ze}}class He extends Pe{constructor(){super({key:"late_hours",title:"late hours"}),this.normal=!1}value_in(t){return t.late_hours}autovalue_in(t){return t.auto_late_hours}}class We{constructor(t){this.entries={},this.parent=null,this.root=this,t&&this.assign(t)}make_child(){const t=new We;return Object.assign(t,this),t.parent=t.root=this,t}set_entry(t){if(this.entries!==this.root.entries)throw new Error("!");this.entries[t.key]=t,t._all=this.root}assign(t){const e=this.value_order;if(t.entries)for(let e in t.entries)this.set_entry(new Pe(t.entries[e]));if(t.order&&(this.order=t.order),t.fixed_value_order&&!this.parent&&(this.fixed_value_order=t.fixed_value_order),this.value_order=this.fixed_value_order||this.order,this.value_order!==e){this.vpos={};for(let t=0;t!==this.value_order.length;++t)this.vpos[this.value_order[t]]=t;e&&(this.grades=this.autogrades=null)}t.grades&&(this.grades=this.merge_grades(this.grades,t.grades,t)),t.autogrades&&(this.autogrades=this.merge_grades(this.autogrades,t.autogrades,t)),"scores_visible"in t&&(this.parent?(this.scores_visible_pinned=null!=t.scores_visible)?this.scores_visible=t.scores_visible:this.scores_visible=this.parent.scores_visible:this.scores_visible=t.scores_visible);for(let e in t)Ie[e]&&(this[e]=t[e]);return this}merge_grades(t,e,n){let i=n.fixed_value_order||n.order||this.value_order;if(t||i!==this.value_order){t=t||[];for(let n in i){const s=this.vpos[i[n]];if(null!=s){for(;t.length<=s;)t.push(null);t[s]=e[n]}}return t}return e}xentry(t){return this.entries[t]||("late_hours"===t?Pe.late_hours():null)}*value_entries(){for(const t of this.value_order)yield this.entries[t]}remount_at(t,e){const n=this.xentry(t.getAttribute("data-pa-grade"));if(n){let i,s=t.firstChild;for(;!d(s,"pa-pv");)"LABEL"===s.tagName&&(i=s.htmlFor),s=s.nextSibling;for(;s.nextSibling;)t.removeChild(s.nextSibling);"boolean"==typeof e&&(e=e?2:0);const a=document.createElement(2===e?"form":"div");a.className=2===e?"ui-submit pa-pv"+(this.description?" pa-textv":""):"pa-pv",f(t,"e",0!==e),t.replaceChild(a,s),2===e&&p(t,"hidden"),n.mount_at(a,i,0!==e),$(s).find("input, textarea").unautogrow()}}update_at(t,e){const n=this.xentry(t.getAttribute("data-pa-grade"));let i=n.value_in(this);if(n.has_later_value_in(this)){const e=t.firstChild;e.classList.contains("pa-grade-latest")?i=this.grades_latest[n.key]:e.classList.contains("uic")||(e.classList.add("pa-grade-earlier","uic","need-tooltip"),e.setAttribute("aria-label","Toggle latest version"))}const s={gradesheet:this,autograde:n.autovalue_in(this)};e&&Object.assign(s,e),n.update_at(t,i,s)}grade_total(t){let e=null;for(let n=0;n!==this.value_order.length;++n){const i=this.entries[this.value_order[n]];if(i&&i.in_total&&(!t||!i.is_extra)){const t=this.grades&&this.grades[n];null!=t&&(e=(e||0)+t)}}return null!==e?Math.round(1e3*e)/1e3:null}grade_maxtotal(){let t=null;for(let e=0;e!==this.value_order.length;++e){const n=this.entries[this.value_order[e]];n&&n.in_total&&!n.is_extra&&n.max&&(!n.required||this.scores_editable||this.grades&&null!==this.grades[e])&&(t=(t||0)+n.max)}return null!==t?Math.round(1e3*t)/1e3:null}file_anchor(t){return d(document.body,"pa-multiuser")?"U".concat(ut(this.user),"/F",ut(t)):"F"+ut(t)}get has_sections(){for(let t=0;t!==this.order.length;++t)if("section"===this.entries[this.order[t]].type)return!0;return!1}has(t){for(let e=0;e!==this.value_order.length;++e)if(t(this.entries[this.value_order[e]],this))return!0;return!1}section_has(t,e){let n=this.vpos[t.key];for(;null!=n&&n<this.value_order.length;){const i=this.entries[this.value_order[n]];if(i!==t&&"section"===i.type)break;if(e(i,this))return!0;++n}return!1}section_wants_sidebar(t){let e=0;return this.scores_editable&&this.section_has(t,t=>(e|=t.answer?1:2,3===e))}add_linenotes(t){this.linenotes=this.linenotes||{};for(const[e,n]of Object.entries(t||{}))this.linenotes[e]=this.linenotes[e]||{},Object.assign(this.linenotes[e],n)}show_text_as_diff(t,e,n){h(t,"bg-none"),h(t,"align-self-start");let i=t.firstChild;if(i||(i=document.createElement("div"),i.className="pa-filediff",i.id=this.file_anchor(n),t.appendChild(i)),"DIV"!==i.tagName||i.nextSibling||!d(i,"pa-filediff"))throw new Error("bad ve.firstChild in GradeSheet.show_text_as_diff");i.className="pa-filediff pa-dg pa-hide-left pa-hide-landmarks uim"+(this.scores_editable?" pa-editablenotes live":"")+(this.scores_visible?"":" pa-scores-hidden");let s=0,a=1,r=i.firstChild;for(;s!==e.length;){let t=e.indexOf("\n",s);t=t<0?e.length:t+1;const n=e.substring(s,t);for(;r&&(!d(r,"pa-gi")||d(r,"pa-dlr"));){const t=r.nextSibling;d(r,"pa-gw")||r.remove(),r=t}if(r){if(r.firstChild.nextSibling.getAttribute("data-landmark")!=a)throw new Error(`bad data-landmark in gc-markdown, ${r.firstChild.nextSibling.getAttribute("data-landmark")} vs. ${a}`)}else{r=document.createElement("div"),r.className="pa-dl pa-gi";const t=document.createElement("div"),e=document.createElement("div"),n=document.createElement("div");t.className="pa-da",t.hidden=!0,e.className="pa-db",e.hidden=!0,e.setAttribute("data-landmark",a),n.className="pa-dd pa-dhlm",r.append(t,e,n),i.append(r)}r.lastChild.textContent=n,r=r.nextSibling,++a,s=t}for(;r;){const t=r.nextSibling;d(r,"pa-gw")||r.remove(),r=t}const o=new pe(i);let l;if(d(t.parentElement,"pa-markdown")&&o.markdown(),this.linenotes&&(l=this.linenotes[n]))for(let t in l){const e=l[t];o.line(t).then(t=>{Se.near(t).assign(e).render(!1)})}}static store(t,e){if(!d(t,"pa-psetinfo"))throw new Error("bad GradeSheet.store");We.closest(t).assign(e),window.$pa.loadgrades.call(t)}static closest(t){if(!(t=t.closest(".pa-psetinfo")))return null;if(t.pa__gradesheet)return t.pa__gradesheet;let e;if(d(t,"pa-psetinfo-partial")&&(e=We.closest(t.parentElement))&&(e=e.make_child()),e=e||new We,t.hasAttribute("data-pa-gradeinfo"))try{let n=JSON.parse(t.getAttribute("data-pa-gradeinfo")||"{}");e.assign(n)}catch{}return Object.defineProperty(t,"pa__gradesheet",{value:e,configurable:!0,writable:!0}),e}}let Ue,Ze,Ke,Ye,Je;function Xe(t){t&&null!=t.screenX&&(Je=t.timeStamp,Ke=t.screenX,Ye=t.screenY)}function Ve(t){let e,n;if("mousemove"===t.type&&Je&&(Math.abs(t.screenX-Ke)<=1&&Math.abs(t.screenY-Ye)<=1||t.timeStamp-Je<=500)||("keydown"===t.type||"keyup"===t.type)&&L.is_modifier(t))return;if("keydown"!==t.type||"ArrowUp"!==(e=L(t))&&"ArrowDown"!==e&&"Enter"!==e||(n=L.modcode(t))&&(n!==L.META||"Enter"!==e)||!Ue)return Qe();let i=Ue.visible_source();if(i&&("ArrowDown"===e||"ArrowUp"===e)){p(i.element,"live");let t=i;const n=fe.ANYFILE+("ArrowDown"===e?0:fe.BACKWARD);i=null;for(let e of fe.all(t,n))if(e.element!==t.element&&e.is_visible()&&e.is_source()){i=e;break}}if(i){if(Ue=i,t.preventDefault(),Xe(t),"Enter"===e)an();else{const t=i.element.closest(".pa-with-fixed");$(i.element).addClass("live").scrollIntoView(t?{marginTop:t.firstChild.offsetHeight}:null)}return!0}return Qe()}function Ge(t,e){d(t,"pa-gw")||h(t,"live"),$(".pa-filediff").removeClass("live"),$(document).off(".pa-linenote"),$(document).on((e?"keydown.pa-linenote ":"")+"mousemove.pa-linenote mousedown.pa-linenote",Ve)}function Qe(){$(".pa-dl.live").removeClass("live"),$(".pa-filediff").addClass("live"),$(document).off(".pa-linenote")}function tn(t){const e=t.render(!0),n=Ue&&Ue.visible_source();return n&&Ge(n.element,!0),e}function en(){return tn(Se.closest(this).cancel_edit()),!0}function nn(t){return!("Escape"===L(t)&&!L.modcode(t)&&tn(Se.closest(this))||"Enter"===L(t)&&L.modcode(t)===L.META&&($(this).closest("form").submit(),1))}function sn(t,e){return t*t+e*e<144}function an(t){const e=Se.near(Ue),n=e.force_element();if(Xe(t),d(n,"editing")){if(tn(e))return t&&t.stopPropagation(),!0;var i=$(n).find("textarea").focus();return i[0].setSelectionRange&&i[0].setSelectionRange(0,i.val().length),!1}return function(t,e,n){t[0].hidden=!1,t.addClass("editing");var i=t.find(".pa-notebox");if(n){t.css("display","").children().css("display","");var s=i.children();s.slideUp(80).queue(function(){s.remove()})}let a=We.closest(Ue.element),r=e?e.format:null;null==r&&(r=document.body.getAttribute("data-default-format"));let o='<form method="post" action="'.concat(lt(I("=api/linenote",{psetinfo:a.element,file:Ue.file,line:Ue.note_lineid,oldversion:e&&e.version||0,format:r})),'" enctype="multipart/form-data" accept-charset="UTF-8" class="ui-submit pa-noteform">','<textarea class="pa-note-entry need-autogrow" name="note"></textarea>','<div class="aab aabr pa-note-aa justify-content-between">','<div class="aabutr order-100"><button class="btn-primary" type="submit">Save comment</button></div>','<div class="aabutr order-99"><button type="button" name="cancel">Cancel</button></div>','<div class="aabut"><button type="button" class="btn ui pa-load-note-suggestions"></button></div>');a.scores_visible||(o+='<div class="aabut"><label class="checki"><input type="checkbox" name="iscomment" value="1" class="checkc">Show immediately</label></div>'),o+='<div class="aabut flex-grow-1"></div>';var l=$(o+"</div></form>").appendTo(i),c=l.find("textarea");if(e&&null!==e.ftext){const t=e.editable_text;c.text(t),c[0].setSelectionRange&&c[0].setSelectionRange(t.length,t.length)}c.autogrow().keydown(nn),l.find("input[name=iscomment]").prop("checked",!(!e||!e.iscomment)),l.find("button[name=cancel]").click(en),l.on("submit",function(){!function(t){if(!d(t,"pa-gw"))throw new Error("bad `elt` in pa_save_my_note");if(!d(t,"pa-outstanding")){const e=$(t).find("form")[0],n=e.elements.note.value,i=e.elements.iscomment&&e.elements.iscomment.checked;$(e).find(".pa-save-message").remove(),$(e).find(".aab").append('<div class="aabut pa-save-message">Saving</div>'),Se.at(t).save_text(n,i).then(()=>{const t=Ue?Ue.visible_source():null;t&&Ge(t.element,!0)})}}(this.closest(".pa-dl"))}),n&&(c.focus(),l.hide().slideDown(100))}($(n),e,!0),Ge(Ue.element,!1),!1}function rn(t){const e=siteinfo.user.cid;return t.like&&t.like.indexOf(e)>=0?1:t.dislike&&t.dislike.indexOf(e)>=0?-1:0}function on(t,e){if(t.status!==e.status)return t.status>e.status?-1:1;if(t.ftext.substring(0,3)===e.ftext.substring(0,3))return t.ftext.localeCompare(e.ftext);const n=Kt.parse(t.ftext),i=Kt.parse(e.ftext);return n.localeString(i)}function ln(t,e){!function(t,e){let n,i=t.querySelector(".pa-note-suggestions");if(i){const e=t.querySelector(".pa-search-suggestions");n=un(e?e.value:"")}else{const e=t.querySelector(".pa-note-aa"),n=document.createElement("input");n.type="search",n.className="uikd uii pa-search-suggestions mt-4 mb-3",n.placeholder="Search",i=document.createElement("div"),i.className="pa-note-suggestions",e.before(n,i)}const s=new Set;for(let t=i.firstChild;t;t=t.nextSibling)s.add(t.getAttribute("data-content"));for(const t of e){if(s.has(t.ftext))continue;const e=rn(t),a=document.createElement("div"),r=(t.like||[]).length-(t.dislike||[]).length;a.className="pa-note-suggestion".concat(e<0||0===e&&r<0?" dim":""),a.setAttribute("data-content",t.ftext),n&&!n.test(t.ftext)&&(a.hidden=!0),i.appendChild(a);const o=document.createElement("div"),l=document.createElement("button"),c=document.createElement("button"),u=document.createElement("div");o.className="btnbox small",o.append(l,c),u.className="flex-grow-1",a.append(o,u),l.type=c.type="button",l.className="ui pa-use-suggestion like".concat(e>0?" taken":""),l.setAttribute("aria-label","Use"),l.textContent="",c.className="ui pa-use-suggestion dislike".concat(e<0?" taken":""),c.setAttribute("aria-label","Downrank"),c.textContent="",Ht(u,"f",t.ftext),At.call(l),At.call(c)}}(t,e.notelist),$(t).find(".pa-load-note-suggestions").prop("disabled",!e.more)}function cn(t,e){const n=fe.closest(t);$.ajax(I("=api/linenotemark",{file:n.file,linea:n.linea,mark:e,pset:n.pset}),{data:{ftext:t.getAttribute("data-content")},method:"POST"})}function un(t){let e="";for(const n of t.split(/\s+/))""!==n&&(e=e.concat("(?=.*",ct(n),")"));return e?new RegExp(e,"i"):null}v.on("pa-editablenotes",function(t){var e=t.target.closest(".pa-dl");if(0===t.button&&e&&!d(e,"pa-gx")&&!t.target.matches("button, a, textarea, input, label")&&!t.target.closest(".pa-note-suggestions")){var n=function(t){for(;t&&"TEXTAREA"!==t.tagName&&"A"!==t.tagName;){if(d(t,"pa-dl")){for(let e of fe.all(t)){if(e.is_note())return e;if(e.element!==t&&e.is_visible()&&!e.is_annotation())break}return new fe(t)}t=t.parentElement}return null}(t.target),i=(new Date).getTime();"mousedown"===t.type&&n?Ue&&Ue.element===n.element&&Ze&&sn(Ze[0]-t.clientX,Ze[1]-t.clientY)&&i-Ze[2]<=500||(Ue=n,Ze=[t.clientX,t.clientY,i,!1]):"mouseup"===t.type&&n?Ue&&Ue.element===n.element&&Ze&&sn(Ze[0]-t.clientX,Ze[1]-t.clientY)&&!Ze[3]&&(Ue=n,Ze[3]=!0,an(t)):"click"===t.type&&n?(Ue=n,an(t)):Ue=Ze=null}}),v.on("pa-load-note-suggestions",function(){const t=this.closest("form");let e=$(t).data("paNoteSuggestions");if(e&&!e.more)return void ln(t,e);const n=fe.closest(this),i={file:n.file,pset:n.pset},s=We.closest(this);if(s&&s.base_commit&&!s.base_handout){if(s.user&&s.commit){let t=n.lineb;null!==t&&(i.u=s.user,i.line="b"+t,i.commit=s.commit)}}else i.linea=n.linea;e?e.neighborhood>=0&&e.neighborhood<=5?(i.neighborhood=20,i.my_neighborhood=-1):i.neighborhood=-1:(i.neighborhood=5,i.my_neighborhood=20),this.disabled=!0,$.ajax(I("api/linenotesuggest",i),{success:function(e){if(e.ok){e.notelist=e.notelist||[];for(const t of e.notelist){const e=rn(t),n=(t.like||[]).length-(t.dislike||[]).length;t.status=e>0&&n>1?3:e>0?2:0===e&&n>0?1:0===e&&0===n?0:-1===e&&n>=0?-1:-2}e.notelist.sort(on),$(t).data("paNoteSuggestions",e),ln(t,e)}}})}),v.on("pa-use-suggestion",function(){const t=this.closest(".pa-note-suggestion"),e=t.closest("form");this.classList.contains("like")?(cn(t,"like"),e.elements.note.value=Kt.parse(t.getAttribute("data-content"))[1]):(cn(t,"dislike"),t.remove())}),v.on("pa-search-suggestions",function(t){if("input"===t.type){const t=this.nextSibling,e=un(this.value);for(let n=t.firstChild;n;n=n.nextSibling){const t=e&&!e.test(n.getAttribute("data-content"));n.hidden=!!t}}else"keydown"!==t.type||L.modcode(t)&(L.SHIFT|L.ALT)||"Enter"!==L(t)||t.preventDefault()});const dn={0:!1,1:{b:!0},2:{f:!0},3:{i:!0},4:{u:!0},5:{bl:!0},7:{rv:!0},8:{x:!0},9:{s:!0},21:{du:!0},22:{b:!1,f:!1},23:{i:!1},24:{u:!1},25:{bl:!1},27:{rv:!1},28:{x:!1},29:{s:!1},30:{fg:0},31:{fg:1},32:{fg:2},33:{fg:3},34:{fg:4},35:{fg:5},36:{fg:6},37:{fg:7},38:"fg",39:{fg:!1},40:{bg:0},41:{bg:1},42:{bg:2},43:{bg:3},44:{bg:4},45:{bg:5},46:{bg:6},47:{bg:7},48:"bg",49:{bg:!1},90:{fg:8},91:{fg:9},92:{fg:10},93:{fg:11},94:{fg:12},95:{fg:13},96:{fg:14},97:{fg:15},100:{bg:8},101:{bg:9},102:{bg:10},103:{bg:11},104:{bg:12},105:{bg:13},106:{bg:14},107:{bg:15}},hn={b:1,f:2,i:3,u:4,bl:5,rv:7,x:8,s:9,du:21};function pn(t,e){if(1===arguments.length&&(e=t,t=null),!e||"[m"===e||"[0m"===e)return null;let n;n=""===e.charAt(0)?e.substring(2,e.length-1).split(";"):e.split(";");for(let e=0;e<n.length;++e){const i=dn[parseInt(n[e])];if(!1===i)t=null;else if(i)if("object"==typeof i)for(let e in i)!1!==i[e]?(t=t||{})[e]=i[e]:t&&delete t[e];else if("fg"===i||"bg"===i){let s,a,r;if(t=t||{},e+4<n.length&&2===parseInt(n[e+1]))s=parseInt(n[e+2]),a=parseInt(n[e+3]),r=parseInt(n[e+4]),s<=255&&a<=255&&r<=255&&(t[i]=[s,a,r]),e+=4;else if(e+2<n.length&&5===parseInt(n[e+1])){const o=parseInt(n[e+2]);o<=15?t[i]=o:o<=231?(r=(o-16)%6,a=(o-16-r)/6%6,s=(o-16-r-6*a)/36,t[i]=[51*s,51*a,51*r]):o<=255&&(r=Math.round(255*(o-232)/23),t[i]=[r,r,r]),e+=2}}}return t&&$.isEmptyObject(t)?null:t}function fn(t,e){return/^\x1b\[[\d;]*m$/.test(e)?function(t){if(!t)return"[m";const e=[];for(let n in hn)t[n]&&e.push(hn[n]);return t.fg&&("number"==typeof t.fg?e.push(t.fg<8?30+t.fg:90+t.fg-8):e.push(38,2,t.fg[0],t.fg[1],t.fg[2])),t.bg&&("number"==typeof t.bg?e.push(t.bg<8?40+t.bg:100+t.bg-8):e.push(48,2,t.bg[0],t.bg[1],t.bg[2])),"["+e.join(";")+"m"}(pn(pn(null,t),e)):t}function mn(t,e,n){return"#".concat(t<16?0:"",t.toString(16),e<16?0:"",e.toString(16),n<16?0:"",n.toString(16))}function gn(t,e,n){let i=!1;"string"==typeof t&&(n=e,e=t,t=document.createElement("div"),i=!0),n&&n.clear&&(t.removeAttribute("data-pa-terminal-style"),t.removeAttribute("data-pa-outputpart"),t.replaceChildren());let s,a,r=t.getAttribute("data-pa-terminal-style"),o=null,l=null;function c(t,e,n){const i=function(t,e){if("string"==typeof t?t=document.createTextNode(t):t instanceof jQuery&&(t=t[0]),!e||"[m"===e||"string"==typeof e&&!(e=pn(e)))return t;const n=document.createElement("span");for(let t in hn)e[t]&&n.classList.add("ansi"+t);return e.fg&&("number"==typeof e.fg?n.classList.add("ansifg"+e.fg):n.style.color=mn(e.fg[0],e.fg[1],e.fg[2])),e.bg&&("number"==typeof e.bg?n.classList.add("ansibg"+e.bg):n.style.backgroundColor=mn(e.bg[0],e.bg[1],e.bg[2])),n.appendChild(t),n}(e,r);if(null!=n&&""!==n){const e=document.createElement("a");if(e.href=n,e.className="qh","SPAN"===i.nodeName){for(;i.firstChild;)e.appendChild(i.firstChild);i.appendChild(e),t.append(i)}else e.append(i),t.append(e)}else t.append(i)}function u(t){o||(o=document.createDocumentFragment()),o.appendChild(t)}function h(e,i){let s,a,o=!i,d=0;for(o&&(i=document.createElement("span")),/\r/.test(e)&&(e=function(t){const e=/\n$/.test(t);if(e&&t.indexOf("\r")===t.length-1)return t.substring(0,t.length-2)+"\n";let n=r||"[m",i=[];const s=(e?t.substr(0,t.length-1):t).split(/\r/);for(let t=0;t<s.length;++t){const e=[],a=s[t].split(/(\x1b\[[\d;]*m|\x1b\[0?K)/);let r=0,o=null;for(let t=0;t<a.length;t+=2)""!==a[t]&&(e.push(n,a[t]),r+=a[t].length),t+1<a.length&&(a[t+1].endsWith("K")?o=r:n=fn(n,a[t+1]));let l=0;for(;l<i.length&&r>=i[l+1].length;)r-=i[l+1].length,l+=2;for(;l<i.length&&r<i[l+1].length&&null===o;)e.push(i[l],i[l+1].substr(r)),r=0,l+=2;i=e}return i.push(n),e&&i.push("\n"),i.join("")}(e));s=e.match(/^(\x1b\[[\d;]*m|\x1b\[\d*K)([^]*)$/);)r=fn(r,s[1]),e=s[2];((s=e.match(/^([ \t]*)([^:\s]+):(\d+)(?=:)/))||(s=e.match(/^([ \t]*)file "(.*?)", line (\d+)/i))||l&&(s=e.match(l)))&&function(t,e,i,s,a){let o;for(;o=i.match(/^(\x1b\[[\d;]*m|\x1b\[\d*K)([^]*)$/);)r=fn(r,o[1]),i=o[2];let l=pe.by_file(i);if(!l&&n&&n.directory&&(i=n.directory+i,l=pe.by_file(i)),l){e.length&&c(t,e);var u=document.createElement("a");return u.href="#"+l.lineid_anchor("b"+s),u.className="qh pa-goto",u.append(a.substring(e.length).replace(/(?:\x1b\[[\d;]*m|\x1b\[\d*K)/g,"")),c(t,u),!0}return!1}(i,s[1],s[2],s[3],s[0])&&(d=s[0].length,e=e.substr(d));let h,p="";for(;""!==e;){if(h=e,s=e.match(/^(.*?)(\x1b\[[\d;]*m|\x1b\[\d*K|\x1b\]8;;|\x1bc)([^]*)$/)){if(""===s[1]){"]8;;"===s[2]?(a=s[3].match(/^(.*?)(?:[\x1b\x07])([^]*)$/))?(p=a[1],e=a[2]):e="":"c"===s[2]?(t.replaceChildren(),i.replaceChildren(),o||t.appendChild(i),e=s[3]):(r=fn(r,s[2]),e=s[3]);continue}h=s[1]}d+h.length>133||d+h.length==133&&"\n"!==h.charAt(132)?(h=h.substr(0,132-d),c(i,h,p),i.className="pa-rl-continues",o&&u(i),i=document.createElement("span"),o=!0,d=0):(c(i,h,p),d+=h.length),e=e.substr(h.length)}o&&u(i)}n&&n.directory&&(l=new RegExp("^(|.*[/\\s])("+ct(n.directory)+"[^:\\s]+):(\\d+)(?!\\w)")),"string"==typeof e?(s=e.split(/^/m),s.length&&""===s[s.length-1]&&s.pop(),a=s.length&&s[s.length-1].endsWith("\n")):(s=[],a=!0,o=e);let p=t.lastChild,f=null;if(p&&p.lastChild&&d(p.lastChild,"pa-runcursor")&&(f=p.lastChild,p.removeChild(f)),p&&null!==(e=p.getAttribute("data-pa-outputpart"))&&""!==e&&s.length){for(;p.firstChild;)p.removeChild(p.firstChild);s[0]=e+s[0],p.removeAttribute("data-pa-outputpart")}else p&&(s.length||o)&&(p.appendChild(document.createTextNode("\n")),p.removeAttribute("data-pa-outputpart")),p=null;let m,g,b=r;for(let t=0;t<s.length;t=m){for(b=r,g=s[t],m=t+1;!g.endsWith("\n")&&m<s.length;++m)g+=s[m];m==s.length&&a&&(g=g.substring(0,g.length-1)),h(g,t?null:p)}n&&n.cursor&&!t.lastChild&&!o&&u(""),o&&t.appendChild(o);let _=t.childNodes.length;if(_>=4e3){let e=t.firstChild;for(;"DIV"===e.tagName&&"pa-rl-group"===e.className;)e=e.nextSibling,--_;let n=null,i=0;for(;e&&(m=e.nextSibling);)(!n||i>=4e3&&_>=2e3)&&(n=document.createElement("div"),n.className="pa-rl-group",t.insertBefore(n,e),i=0),t.removeChild(e),n.appendChild(e),e=m,++i,--_}if(n&&n.cursor&&(f||(f=document.createElement("span"),f.className="pa-runcursor"),t.lastChild.appendChild(f)),!a&&t.lastChild&&(r=b,t.lastChild.setAttribute("data-pa-outputpart",g)),null!=r?t.setAttribute("data-pa-terminal-style",r):t.removeAttribute("data-pa-terminal-style"),i)return t.innerHTML}function bn(){const t=this.closest(".pa-grade");this.classList.toggle("pa-grade-latest"),this.classList.toggle("pa-grade-earlier"),We.closest(this).update_at(t)}function _n(n,i){const s=n.closest("form"),a=n.getAttribute("data-pa-run-category")||n.value,o=n.closest(".pa-psetinfo"),l=o?o.getAttribute("data-pa-directory"):"",c=document.getElementById("pa-run-"+a),u=c.closest(".pa-runout"),f=$(c).find("pre");let m,g,b,_=i.queueid||null,v=!1,y=null,w=null,k=!1;if(u&&p(u,"hidden"),p(c,"need-run"),x(c,u,!0),d(c,"pa-run-active"))return!0;if(h(c,"pa-run-active"),i.unfold&&c.hasAttribute("data-pa-timestamp")?g=+c.getAttribute("data-pa-timestamp"):i.timestamp&&(g=i.timestamp),g||c.removeAttribute("data-pa-timestamp"),g||!1===i.clear?c.lastChild&&$(c.lastChild).find("span.pa-runcursor").remove():(f[0].replaceChildren(),h(f[0].parentElement,"pa-run-short"),f[0].removeAttribute("data-pa-terminal-style"),$(c).children(".pa-runrange").remove()),c.getAttribute("data-pa-xterm-js")&&"false"!==c.getAttribute("data-pa-xterm-js")&&window.Terminal){p(f[0].parentElement,"pa-run-short"),h(f[0].parentElement,"pa-run-xterm-js");const t=+c.getAttribute("data-pa-columns"),e=+c.getAttribute("data-pa-rows"),n=+c.getAttribute("data-pa-font-size"),s={cols:!t||t<0||t!=t?function(){const t=S("span",{style:"position:absolute"},"0");f.append(t);const e=Math.trunc(f.width()/$(t).width()/1.33);return t.remove(),Math.max(80,Math.min(e,132))}():t,rows:!e||e<0||e!=e?25:e};n&&n>0&&n==n&&(s.fontSize=n),m=new Terminal(s),m.open(f[0]),m.attachCustomKeyEventHandler((C=function(t){Y({write:t})},function(t){if("keydown"===t.type){let e=L(t),n=L.modcode(t);if(1===e.length)if(n&=~L.SHIFT,0===n&&L.printable(t));else if(n===L.CTRL&&e>="a"&&e<="z")e=String.fromCharCode(e.charCodeAt(0)-96);else{if(n===L.META&&"v"==e||n==L.CTRL&&"V"==e)return navigator.clipboard.readText().then(t=>C(t)),void t.preventDefault();e=""}else e="Enter"!==e||n?"Escape"!==e||n?"Backspace"!==e||n?"Tab"!==e||n?"ArrowUp"!==e||n?"ArrowDown"!==e||n?"ArrowRight"!==e||n?"Home"!==e||n?"End"!==e||n?"ArrowLeft"!==e||n?"Delete"!==e||n?"PageUp"!==e||n?"PageDown"!==e||n?"":"[6~":"[5~":"[3~":"OD":"OF":"OH":"OC":"OB":"OA":"\t":"":"":"\r";""!==e&&(C(e),t.preventDefault())}return!1})),i.focus&&m.focus()}var C;function A(){m||!d(c,"pa-run-short")&&!c.hasAttribute("data-pa-runbottom")||requestAnimationFrame(function(){c.scrollHeight>c.clientHeight&&p(c,"pa-run-short"),c.hasAttribute("data-pa-runbottom")&&(c.scrollTop=Math.max(c.scrollHeight-c.clientHeight,0))})}c.hasAttribute("data-pa-opened")||(c.setAttribute("data-pa-opened","true"),m||(c.setAttribute("data-pa-runbottom","true"),c.addEventListener("scroll",function(){requestAnimationFrame(function(){c.scrollTop+c.clientHeight>=c.scrollHeight-10?c.setAttribute("data-pa-runbottom","true"):c.removeAttribute("data-pa-runbottom")})}),A()));let E="",N=null,D=0,F=50,M=null;function T(){m?m.write("[?25l"):c.lastChild&&$(c.lastChild).find(".pa-runcursor").remove()}function j(t){var e;p(c,"pa-run-active"),!1===t||k||(T(),n.hasAttribute("data-pa-run-grade")&&Q(I("api/grade",{psetinfo:e=o}),null,"GET").then(function(t){t&&t.ok&&We.store(e,t)}),i.done_function&&i.done_function(),k=!0),W(-1)}function O(t,e){m?m.write(t,e):(gn(f[0],t,{cursor:!0,directory:l}),e&&Promise.resolve(!0).then(e))}function z(t,e,n){if(null!==E){E+=t;const n=E.indexOf("\n\n");if(n<0)return;N=function(t){const e=/^([\x00-\x7F]*)([\u0080-\u07FF]*)([\u0800-\uD7FF\uE000-\uFFFF]*)((?:[\uD800-\uDBFF][\uDC00-\uDFFF])*)/y;let n=0,i=0;for(;n<t.length;){e.lastIndex=n;const s=t.match(e);if(!s)break;s[1].length&&(n+=s[1].length,i+=s[1].length),s[2].length&&(n+=s[2].length,i+=2*s[2].length),s[3].length&&(n+=s[3].length,i+=3*s[3].length),s[4].length&&(n+=s[4].length,i+=2*s[4].length)}return i}(E.substr(0,n+2));let s=!1===i.clear?"":"c";e&&e.timestamp&&(s+="[38;5;108;3m...started "+r("%l:%M:%S%P %e %b %Y",new Date(1e3*e.timestamp))+"[m\r\n"),t=s+E.substr(n+2),E=null}""!==t&&O(t,n)}function B(n,i){let s,r,o,l,u,f,m=!1;if(M)return;if(0!==n.offset)throw new Error("fuck");let g,b,_,v,y=n.time_factor;{const e=t.site_json(!1,"pa-runspeed-"+a);e&&e[1]>=(new Date).getTime()-864e5?y=e[0]:e&&t.site_json(!1,"pa-runspeed-"+a,null),(y<.1||y>10)&&(y=1)}function x(){b&&(b.value=o,_.textContent=e("%d:%02d.%03d",Math.trunc(o/6e4),Math.trunc(o/1e3)%60,Math.trunc(o)%1e3))}function w(){m||(m=!0,Y({offset:n.end_offset},function(t){t.ok&&t.offset===n.end_offset?(n.data+=t.data,n.end_offset=t.end_offset):t.ok||(n.size=n.end_offset),m=!1,f&&C(f)}))}function k(t){return t<M.length?N+M[t+1]:n.size}function C(t){if(null===t){if(!u)return;t=((new Date).getTime()-r)*y}let e=s;for((e>=M.length||t<M[e])&&(e=0),e+2<M.length&&t>=M[e]&&(e=function(t,e,n){for(;t<e;){const i=t+(e-t>>1&-2);n<=M[i]?e=i:t=i+2}return t}(e,M.length,t));e<M.length&&t>=M[e];)e+=2;e<s&&(E="",s=0),null!==E&&function(){if(null!==E){const t=n.data.indexOf("\n\n");z(n.data.substring(0,t+2),n)}}();let i=k(s),a=k(e);const c=8<<20;if(i+c<a){let t=s;for(;t<e;){const n=t+(e-t>>1&-2);i+c<M[n+1]+N?(e=n,a=k(n)):t=n+2}}if(n.end_offset<n.size){if(a>n.end_offset)return f=t,void w();a>n.end_offset-(1<<20)&&w()}if(o=e<M.length?Math.min(t,M[e]):t,f=t>o?t:null,f){const t=Math.min(i+(4<<20),a);z(n.data.substring(i,t),n,()=>{C(f)}),i=t}z(n.data.substring(i,a),n),A(),x(),s=e,l&&(l=clearTimeout(l)),u&&!f&&(s<M.length?l=setTimeout(C,Math.min(100,(M[s]-(s?M[s-2]:0))/y),null):(g&&h(g,"paused"),T()))}if(M=n.time_data,"string"==typeof M&&(M=function(t){let e=[0,0],n=0;for(;n<t.length;){let i,s=t.indexOf("\n",n+1);s<0&&(s=t.length);const a=t.charCodeAt(n);if((43===a||a>=48&&a<=57)&&(i=t.indexOf(",",n))>=0&&i<s){let r=+t.substring(n,i),o=+t.substring(i+1,s);43===a&&(r+=e[e.length-2]),43===t.charCodeAt(i+1)&&(o+=e[e.length-1]),e.push(r,o)}n=s+1}return e}(M)),M.length>2&&(c.prepend(S("div","pa-runrange",g=S("button",{type:"button",class:"pa-runrange-play"}),b=S("input",{type:"range",class:"pa-runrange-range",min:0,max:M[M.length-2]}),_=S("span","pa-runrange-time"),S("span",{title:"Slow",class:"pa-runrange-speed-slow"},""),v=S("input",{type:"range",class:"pa-runrange-speed",min:"0.1",max:10,step:"0.1"}),S("span",{title:"Fast",class:"pa-runrange-speen-fast"},""))),b.addEventListener("input",function(){u=!1,h(g,"paused"),C(+this.value)},!1),g.addEventListener("click",function(){d(g,"paused")?(p(g,"paused"),u=!0,r=(new Date).getTime(),o<M[M.length-2]&&(r-=o/y),C(null)):(h(g,"paused"),u=!1)},!1),v.addEventListener("input",function(){y=+this.value,t.site(!1,"pa-runspeed-"+a,[y,(new Date).getTime()]),u&&(r=(new Date).getTime()-o/y,C(null))},!1),v.value=y),n={data:n.data,end_offset:n.end_offset,size:n.size||n.end_offset,timestamp:n.timestamp},i)s=M.length,o=M[s-2],u=!1,g&&h(g,"paused"),x();else if(s=0,o=0,r=(new Date).getTime(),u=!0,M.length){if("alternate-screen"===c.getAttribute("data-pa-start")){const t=n.data.indexOf("\n\n"),e=n.data.indexOf("[?1049h"),i=e>t?function(t){let e=0,n=M.length;for(;e<n;){const i=e+(n-e>>1&-2);t<=M[i+1]?n=i:e=i+2}return e}(e-t-2):-1;i>=0&&i<M.length&&(r-=M[i]/y)}C(null)}}let q=0,R={};function P(t){let e=!1;if(t&&t.data)try{let n=JSON.parse(t.data);n&&"object"==typeof n&&null!=n.data&&null!=n.offset&&(n.offset+=N,n.end_offset+=N,null==n.ok&&(n.ok=!0),n.offset<=D?Z(n):Y({write:""}),e=!0)}catch{}e||H()}function H(){y&&(y.close(),y=!1,Y())}function W(t){w&&clearTimeout(w),w=t>=0?setTimeout(U,t):null}function U(){w=null,Y()}function Z(t){if(v&&(O("\r[K"),v=!1),t&&t.onqueue){_=t.queueid;let e=`[38;5;108;3mOn queue, ${t.nahead} ${1==t.nahead?"job":"jobs"} ahead`;if(t.headage){let n=t.headage;n>10&&(n=5*Math.round(n/5+.5)),e+=`, oldest began about ${n} ${1==n?"second":"seconds"} ago`}return O(e+"[m"),A(),v=!0,void W(8e3)}if(function(t){const e=u?u.firstChild:null;if(e&&"H3"===e.tagName){const n=$(e).find(".pa-runstop");if(t&&!n.length){const t=S("button",{class:"btn-danger pa-runstop",type:"button"},"Stop");$(t).click(J).appendTo(e)}else!t&&n.length&&n.remove()}}(t&&(null==t.status||"working"===t.status)&&!t.done),!t||!t.ok){let e="Unknown error";return t&&t.loggedout?e="You have been logged out (perhaps due to inactivity). Please reload this page.":t&&(t.error&&!0!==t.error?e=t.error:t.message&&(e=t.message),1001===t.errorcode&&t.conflict_timestamp&&(b=t.conflict_timestamp)),O("[1;3;31m"+e+"[m\r\n"),A(),j()}if(t.done&&j(!1),t.eventsource&&"working"===t.status&&null==y&&(y=new EventSource(window.siteinfo.base.concat("runevents/v1/",t.eventsource)),y.onmessage=P,y.onerror=H),!g&&t.timestamp&&(g=t.timestamp,c.setAttribute("data-pa-timestamp",t.timestamp)),t.data&&t.offset<D&&(function(t,e){const n=/^([\x00-\x7F]*)([\u0080-\u07FF]*)([\u0800-\uD7FF\uE000-\uFFFF]*)((?:[\uD800-\uDBFF][\uDC00-\uDFFF])*)/y;let i=0;for(;i<t.data.length&&t.offset<e;){n.lastIndex=i;const s=t.data.match(n);if(!s)break;if(s[1].length){const n=Math.min(e-t.offset,s[1].length);i+=n,t.offset+=n}if(s[2].length){const n=Math.min(e-t.offset,2*s[2].length);i+=n/2,t.offset+=n}if(s[3].length){const n=Math.min(e-t.offset,3*s[3].length);i+=n/3,t.offset+=n}if(s[4].length){const n=Math.min(e-t.offset,2*s[4].length);i+=n/2,t.offset+=n}}t.data=t.data.substring(i)}(t,D),t.offset<D))return void W(0);let e;if(t.data&&t.done&&t.end_offset<t.size&&(e=t.data.match(/\x1b\[\?1049l(?:[\r\n]|\x1b\[\?1l|\x1b\[23;0;0t|\x1b>)*$/))&&(t.data=t.data.substring(0,t.data.length-e[0].length)),t.done&&null!=t.time_data&&""===E&&!1!==i.timed)B(t);else{if(null!=t.data&&t.offset===D&&t.end_offset>=D&&(D=t.end_offset,z(t.data,t),F=100),t.result){if(!t.done||t.end_offset<t.size)throw new Error("data.result must only be present on last");null!==E&&z("\n\n",t),z(t.result,t)}t.data||t.result||(F=Math.min(2*F,500)),A(),"old"===t.status?W(2e3):!t.done||t.end_offset<t.size?W(F):(j(),t.timed&&!d(c.firstChild,"pa-runrange")&&!1!==i.timed&&Y({offset:0},K))}}function K(t){--q,t.data&&t.done&&null!=t.time_data&&B(t,!0)}function Y(t,e){if(t&&t.stop&&(R.stop=1),t&&null!=t.write&&(R.write=(R.write||"").concat(t.write)),R.write&&q>0||!R.stop&&null==R.write&&y)return;let n={};s.elements.run||(n.run=a),n.offset=D,t&&null!=t.offset&&(n.offset=t.offset),g?n.check=g:t&&t.stop&&b&&(n.check=b),_&&(n.queueid=_),Object.assign(n,R),delete R.write,delete R.stop,++q,jQuery.ajax(s.getAttribute("action"),{data:$(s).serializeWith(n),type:"POST",cache:!1,dataType:"json",timeout:3e4,success:function(t){--q,(e||Z)(t),R.write&&Y()},error:function(){$(s).find(".ajaxsave61").html("Failed"),p(c,"pa-run-active")}})}function J(){Y({stop:1})}return i.headline&&!1===i.clear&&f[0].firstChild&&O("\r\n\r\n"),i.headline&&O("[1;37m"+i.headline+"[m\r\n"),i.unfold&&c.getAttribute("data-pa-content")&&O(c.getAttribute("data-pa-content")),i.focus&&$(u).scrollIntoView(),c.removeAttribute("data-pa-content"),A(),Y(),!1}function vn(t,e){for(var n=$("#pa-runsettings"),i=n.find(".n").length;n.find("[data-runsetting-num="+i+"]").length;)++i;var s=$('<div class="pa-p" data-runsetting-num="'+i+'"><div class="pa-pt"></div><div class="pa-pv"><input name="n'+i+'" class="uich pa-runconfig ignore-diff n" size="30" placeholder="Name"> &nbsp; <input name="v'+i+'" class="uich pa-runconfig ignore-diff v" size="40" placeholder="Value"></div></div>');t&&(s.find(".n").val(t),s.find(".v").val(e)),n.append(s),t||s.find(".n").focus()}function yn(t){var e,n,i=0,s=this.getTotalLength();if(i!=s){for(;s-i>.5;)if(e=i+(s-i)/2,(n=this.getPointAtLength(e)).x>=t+.25)s=e;else{if(n.x>=t-.25)return n.y;i=e}if((n=this.getPointAtLength(s===e?i:s)).x>=t-.25&&n.x<=t+.25)return n.y}return null}Zt.add_format({format:2,render:function(t){return gn(t)}}),v.on("pa-grade-latest",bn),v.on("pa-grade-earlier",bn),v.on("pa-runner",function(){_n(this,{focus:!0})}),v.on("pa-run-show",function(){const t=this.closest(".pa-runout").id.substring(4),e=document.getElementById("pa-run-"+t);e.hasAttribute("data-pa-timestamp")&&d(e,"need-run")?_n(jQuery(".pa-runner[value='"+t+"']")[0],{unfold:!0}):x(e,document.getElementById("run-"+t))}),v.on("pa-runconfig",function(){"define"===this.name?vn():function(){var t,e,n,i=$("#pa-runsettings .pa-p"),s={};for(t=0;t!=i.length;++t)e=$.trim($(i[t]).find(".n").val()),n=$.trim($(i[t]).find(".v").val()),""!=e&&(s[e]=n);$.ajax(i.closest("form").attr("action"),{data:{runsettings:s},type:"POST",cache:!1,dataType:"json"})}()});const xn={m:2,M:2,z:0,Z:0,l:2,L:2,h:1,H:1,v:1,V:1,c:6,C:6,s:4,S:4,q:4,Q:4,t:2,T:2,a:7,A:7,b:1,B:1};let wn,kn={},Cn=0,An=!1;function En(t){if(t instanceof SVGPathElement&&(t=t.getAttribute("d")),kn[t])return kn[t];for(var e,n,i,s,a,r,o=[],l=0,c=0,u=0,d=0,h=!1,p=0,f=0,m=1,g=function(t){t instanceof SVGPathElement&&(t=t.getAttribute("d")),t=t.split(/([a-zA-Z]|[-+]?(?:\d+\.?\d*|\.\d+)(?:[Ee][-+]?\d+)?)/);var e,n=1,i=t.length;return function(){for(var s,a=null;n<i;){if((s=t[n])>="A"){if(a)break;a=[s],e=s,"m"!==s&&"M"!==s&&"z"!==s&&"Z"!==s||(e="m"===s||"z"===s?"l":"L")}else{if(!a&&e)a=[e];else if(!a||a.length===xn[a[0]]+1)break;a.push(+s)}n+=2}return a}}(t);s=g();)if("b"!==(a=s[0])&&"B"!==a)if("z"!==a&&"Z"!==a){if(1==xn[a]&&(1==s.length?s=["L"]:"h"===a?s=["l",s[1],0]:"H"===a?s=["L",s[1],c]:"v"===a?s=["l",0,s[1]]:"V"===a&&(s=["L",l,s[1]])),(a=s[0])>="a"&&!p)for(e="a"!==a?1:6;e<s.length;e+=2)s[e]+=l,s[e+1]+=c;else if(a>="a")for("a"===a&&(s[3]+=p),e="a"!==a?1:6;e<s.length;e+=2)n=s[e],i=s[e+1],s[e]=l+n*m+i*f,s[e+1]=c+n*f+i*m;for(a=s[0]=a.toUpperCase();s.length<xn[a]+1;)s.push(u,d);"S"===a?(n=i=0,r&&"C"===r[0]&&(n=l-r[3],i=c-r[4]),s=["C",l+n,c+i,s[1],s[2],s[3],s[4]],a="C"):"T"===a&&(n=i=0,r&&"Q"===r[0]&&(n=l-r[1],i=c-r[2]),s=["Q",l+n,c+i,s[1],s[2]],a="Q"),h||"M"===a||(0!==o.length&&"Z"!==o[o.length-1][0]&&o.push(["M"]),h=!0),"M"===a?(u=s[1],d=s[2],h=!1):"L"===a?o.push(["L",l,c,s[1],s[2]]):"C"===a?o.push(["C",l,c,s[1],s[2],s[3],s[4],s[5],s[6]]):"Q"===a?o.push(["C",l,c,l+2*(s[1]-l)/3,c+2*(s[2]-c)/3,s[3]+2*(s[1]-s[3])/3,s[4]+2*(s[2]-s[4])/3,s[3],s[4]]):(1==++An&&R("bad normalize "+a),o.push(s)),r=s,l=s[s.length-2],c=s[s.length-1]}else r=o.length?o[o.length-1]:null,h&&(l==u&&c==d||o.push(["L",l,c,u,d]),o.push(["Z"]),h=!1),l=u,c=d;else p="b"===a?p+s[1]:s[1],m=Math.cos(p),f=Math.sin(p);return Cn>=1e3&&(kn={},Cn=0),kn[t]=o,++Cn,o}function $n(t,e,n){if(n&&!function(t,e,n){function i(t,i,s,a){return t-e[0]>=n||e[0]-s>=n||i-e[1]>=n||e[1]-a>=n}if("clientX"in e){var s=t.getBoundingClientRect(),a=e[0]-e.clientX,r=e[1]-e.clientY;if(s&&i(s.left+a,s.top+r,s.right+a,s.bottom+r))return!1}for(var o,l,c,u,d=En(t),h=0;h!==d.length;++h){var p=d[h];if("L"===p[0])o=Math.min(p[1],p[3]),l=Math.min(p[2],p[4]),c=Math.max(p[1],p[3]),u=Math.max(p[2],p[4]);else{if("C"!==p[0]){if("Z"===p[0]||"M"===p[0])continue;return!0}o=Math.min(p[1],p[3],p[5],p[7]),l=Math.min(p[2],p[4],p[6],p[8]),c=Math.max(p[1],p[3],p[5],p[7]),u=Math.max(p[2],p[4],p[6],p[8])}if(!i(o,l,c,u))return!0}return!1}(t,e,n.distance))return n;var i,s,a,r,o=t.getTotalLength(),l=((r=t)instanceof SVGPathElement&&(r=r.getAttribute("d")),kn[r]?kn[r].length:r.replace(/[^A-DF-Za-df-z]+/g,"").length),c=Math.max(o/l/8,4),u=n?(n.distance+.01)*(n.distance+.01):1/0;function d(n){var a=t.getPointAtLength(n),r=e[0]-a.x,o=e[1]-a.y,l=r*r+o*o;return l<u&&(i=[a.x,a.y],s=n,u=l),a}if(l>20){var h,p,f=function(t,e){var n=En(t);function i(t,n,i,s){var a=e[0]<t?t-e[0]:e[0]>i?e[0]-i:0,r=e[1]<n?n-e[1]:e[1]>s?e[1]-s:0;return Math.max(a,r)}var s,a,r=1/0,o=-1/0,l=24;for(s=0;s!==n.length;++s)"L"===(a=n[s])[0]?(r=Math.min(r,a[1],a[3]),o=Math.max(o,a[1],a[3])):"C"===a[0]&&(r=Math.min(r,a[1],a[3],a[5],a[7]),o=Math.max(o,a[1],a[3],a[5],a[7]));r-=l,o+=l;var c,u,d,h,p,f=Math.max(Math.ceil((o-r)/l),1),m=new Array(f+1);for(m.fill(1/0),s=0;s!==n.length;++s){if("L"===(a=n[s])[0])c=Math.min(a[1],a[3]),u=Math.min(a[2],a[4]),d=Math.max(a[1],a[3]),h=Math.max(a[2],a[4]);else{if("C"!==a[0])continue;c=Math.min(a[1],a[3],a[5],a[7]),u=Math.min(a[2],a[4],a[6],a[8]),d=Math.max(a[1],a[3],a[5],a[7]),h=Math.max(a[2],a[4],a[6],a[8])}for(p=i(c,u,d,h),c=Math.floor((c-r)/l),d=Math.ceil((d-r)/l);c<=d;)m[c]=Math.min(m[c],p),++c}for(s=0;s!==m.length;++s)m[s]<1/0&&(m[s]=m[s]*m[s]);return m.xmin=r,m.xmax=o,m.width=l,m.point=e,m}(t,e),m=f.xmin,g=f.width;for(a=0;a<o;)h=d(a),f[p=Math.floor((h.x-m)/g)]>u&&f[p-1]>u&&f[p+1]>u?a+=g:a+=c}else for(a=0;a<o;a+=c)d(a);d(o);do{(a=s-c/2)>0&&d(a),(a+=c)<o&&d(a),c/=2}while(c>.5);return i&&(i.distance=Math.sqrt(u),i.pathNode=t,i.pathLength=s),i&&(!n||i.distance<=n.distance+.01)?i:n}class Sn{constructor(){this.is=[]}lower(t){for(var e=this.is,n=0,i=e.length;n<i;){var s=n+2*(i-n>>2);if(e[s]>t)i=s;else{if(!(t>e[s+1]))return s;n=s+2}}return n}contains(t){var e=this.lower(t);return e<this.is.length&&t>=this.is[e]}overlaps(t,e){var n=this.lower(t);return n<this.is.length&&e>=this.is[n]}add(t,e){var n=this.is,i=this.lower(t);(i>=n.length||t<n[i])&&n.splice(i,0,t,t);for(var s=i;s+2<n.length&&e>=n[s+2];)s+=2;s!==i&&n.splice(i+1,s-i),n[i+1]=Math.max(n[i+1],e)}clear(){this.is=[]}}function Nn(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}class Dn{constructor(t,e,n){const i=$(t);let s="all";n.indexOf("extension")>=0?s="extension":n.indexOf("noextra")>=0&&(s="noextra");const a=e.series[s]||e.series.all,r=a.min();let o=r<0?r-1:0;e.entry&&"letter"===e.entry.type&&(o=Math.min(65,r<0?r:Math.max(r-5,0))),this.min=o,this.max=a.max(),e.maxtotal&&(this.max=Math.max(this.max,e.maxtotal)),this.min==this.max&&(o=this.min=this.min-1,this.max+=1),this.total=e.maxtotal,this.cutoff=a.cutoff,this.svg=Nn("svg"),this.gg=Nn("g"),this.gx=Nn("g"),this.gy=Nn("g"),this.xl=this.xt=!0,this.yl=this.yt="pdf"!==n.substring(0,3),this.tw=i.width(),this.th=i.height(),this.svg.setAttribute("preserveAspectRatio","none"),this.svg.setAttribute("width",this.tw),this.svg.setAttribute("height",this.th),this.svg.setAttribute("overflow","visible"),this.svg.appendChild(this.gg),this.gx.setAttribute("class","pa-gg-axis pa-gg-xaxis"),this.svg.appendChild(this.gx),this.gy.setAttribute("class","pa-gg-axis pa-gg-yaxis"),this.svg.appendChild(this.gy),this.maxp=0,this.hoveranno=null,this.hoveron=!1,i.html(this.svg);const l=Nn("text");l.appendChild(document.createTextNode("888")),this.gx.appendChild(l);var c=l.getBBox();if(this.xdw=c.width/3,this.xdh=c.height,this.gx.removeChild(l),this.xlw=this.xdw*(this.max>0?Math.floor(Math.log10(this.max))+1:1),this.mt=Math.ceil(Math.max(this.yl?this.xdh/2:0,2)),this.mr=Math.ceil(this.xl?this.xlw/2:0),this.mb=(this.xt?5:0)+(this.xl?this.xdh+3:0),this.yl){const t=this.th-this.mt-Math.max(this.mb,Math.ceil(this.xdh/2));if(t>this.xdh){var u=i.hasClass("pa-grgraph-min-yaxis");this.yfmt=u?"%.0r%%":"%.0r";const e=t/this.xdh;this.ymax=100,this.ylu=e>15?10:e>5?25:e>3?50:100,this.ml=5+(this.yt?5:0)+(u?4.2:3)*this.xdw,i.hasClass("pa-grgraph-min-yaxis")||(this.yltext=Nn("text"),this.yltext.appendChild(document.createTextNode("% of grades")),this.gy.appendChild(this.yltext),(c=this.yltext.getBBox()).width<=.875*t?this.ml+=.5*this.xdw+this.xdh:(this.gy.removeText(this.yltext),this.yltext=null)),this.mb=Math.max(this.mb,Math.ceil(this.xdh/2))}else this.yl=!1,this.ml=0,this.mt=2}else this.ml=this.yt?5:0;this.xl&&(this.ml=Math.max(this.ml,Math.ceil(this.xdw/2))),this.gw=this.tw-this.ml-this.mr;var d=this.gh=this.th-this.mt-this.mb;const h=this.gw/Math.max(this.max-this.min,.001);if(this.xax=function(t){return(t-o)*h},this.yax=function(t){return d-t*d},this.unxax=function(t){return t/h+o},this.unyax=function(t){return-(t-d)/d},e.entry&&e.entry.type){const t=Te.find(e.entry.type);t&&t.tics&&(this.xtics=t.tics.call(t))}this.max-this.min>900?this.xfmt="%.0r":this.max-this.min>10?this.xfmt="%.1r":this.xfmt="%.3r",this.gg.setAttribute("transform",`translate(${this.ml},${this.mt})`),this.gx.setAttribute("transform",`translate(${this.ml},${this.mt+this.gh+(this.xt?2:-5)})`),this.gy.setAttribute("transform",`translate(${this.ml+(this.yt?-2:5)},${this.mt})`),this.hlcurve=null,this.hlcurve_series=null,this.hlcurve_priority=null,this.hlcurve_ucdf=null}#t(){const t=Math.floor(Math.log10(this.max))+1,e=this.xdw*(t+.5),n=this.gw/e,i=Math.pow(10,Math.max(0,t-2)),s=(this.max-this.min)/i;let a;a=n>4*s&&i>1?i/2:n>2*s?i:n>s*(i<=1?.75:1)?2*i:i>1&&n>.6*s?2.5*i:n>.3*s?5*i:10*i;const r=[];let o=Math.floor(this.min/a)*a,l=!1;for(;o<this.max+a;){let t=o,n=this.xl;if(this.total&&(t>this.total&&t-a<this.total&&!l&&(t=this.total,o-=a),t==this.total&&(l=!0)),o+=a,t<this.min)continue;t>this.max&&(t=this.max);const i=this.xax(t);if(r.push("M",i,",0v5"),(this.total&&t!=this.total&&Math.abs(i-this.xax(this.total))<e||t!=this.max&&t!=this.total&&Math.abs(i-this.xax(this.max))<e)&&(n=!1),n){const e=Nn("text");e.appendChild(document.createTextNode(t)),e.setAttribute("x",i),e.setAttribute("y",this.xdh+3),this.gx.appendChild(e)}}if(this.xt){const t=Nn("path");t.setAttribute("d",r.join("")),t.setAttribute("fill","none"),t.setAttribute("stroke","black"),this.gx.appendChild(t)}}#e(){let t=new Sn,e=new Sn,n=[];for(let i=0;i!==this.xtics.length;++i){let s=this.xtics[i];if(s.x<this.min||s.x>this.max)continue;let a=this.xax(s.x);if((s.notic||!e.contains(a))&&(s.notic||(n.push("M",a,",0v5"),e.add(a-3,a+3)),this.xl&&s.text)){let e=this.xdw*(s.label_space||s.text.length+.5)*.5;if(!t.overlaps(a-e,a+e)){const n=Nn("text");n.appendChild(document.createTextNode(s.text)),n.setAttribute("x",a),n.setAttribute("y",this.xdh+3),this.gx.appendChild(n),e=this.xdw*(s.text.length+.5)*.5,t.add(a-e,a+e)}}}if(this.xt){const t=Nn("path");t.setAttribute("d",n.join("")),t.setAttribute("fill","none"),t.setAttribute("stroke","black"),this.gx.appendChild(t)}}xaxis(){this.xtics?this.#e():this.#t()}yaxis(){const t=[];let n=0;for(;n<=this.ymax&&this.yl;){const i=Nn("text");i.appendChild(document.createTextNode(e(this.yfmt,n))),i.setAttribute("x",-8),i.setAttribute("y",this.yax(n/this.ymax)+.25*this.xdh),this.gy.appendChild(i),t.push("M-5,",this.yax(n/this.ymax),"h5"),n+=this.ylu}if(this.yt){const e=Nn("path");e.setAttribute("d",t.join("")),e.setAttribute("fill","none"),e.setAttribute("stroke","black"),this.gy.appendChild(e)}this.yltext&&(this.yltext.setAttribute("transform","translate("+(-this.ml+this.xdh)+","+this.yax(.5)+") rotate(-90)"),this.yltext.setAttribute("text-anchor","middle"))}container(){return this.svg.closest(".pa-grgraph")}#n(t,e,n,i){const s=Nn("path");return s.setAttribute("d",t),s.setAttribute("fill","none"),s.setAttribute("class",e),this.gg.appendChild(s),null==i&&(i=0),(null==this.hlcurve_priority||this.hlcurve_priority<=i)&&(this.hlcurve=s,this.hlcurve_series=n,this.hlcurve_priority=i,this.hlcurve_ucdf=null),s}append_cdf(t,e,n){const i=t.cdf,s=[],a=1/t.n,r=this.cutoff||0,o=this.min;let l=0;if(r&&i.length>0&&i[0]>o){const t=Nn("path"),n=Math.max(o,i[0]-.5);t.setAttribute("d",`M${this.xax(o)},${this.yax(0)}L${this.xax(n)},${this.yax(r)}`),t.setAttribute("fill","none"),t.setAttribute("class",e+" pa-gg-cutoff"),this.gg.appendChild(t)}for(;l<i.length;l+=2){if(0!==s.length){const t=Math.max(o,i[l]-Math.min(1,i[l]-i[l-2])/2);s.push(`H${this.xax(t)}`)}else s.push(`M${this.xax(Math.max(o,i[l]-.5))},${this.yax(r)}`);s.push(`V${this.yax(i[l+1]*a)}`)}return 0!==s.length&&s.push(`H${this.xax(Math.max(this.max,i[i.length-2]))}`),this.#n(s.join(""),e,t,n)}append_pdf(t,e,n){if(0===t.maxp)return null;const i=[],s=t.kde,a=.9/this.maxp,r=this.xax,o=this.yax;let l=null;this.cutoff&&t.series.cdf.length>0&&(l=this.xax(t.series.cdf[0]));const c=[0,0,0,0],u=[0,0,0,0],d=[0,0,0,0],h=[0,0,0,0],p=1e-6;function f(t){const e=(t+2)%4,n=(t+3)%4,s=(t+1)%4;let a=c[n],r=u[n],o=c[t],l=u[t];if(d[n]>p){let i=2*h[n]+3*d[n]*d[t]+h[t],s=3*d[n]*(d[n]+d[t]);a=(a*i-c[e]*h[t]+c[t]*h[n])/s,r=(r*i-u[e]*h[t]+u[t]*h[n])/s}if(d[s]>p){let e=2*h[s]+3*d[s]*d[t]+h[t],i=3*d[s]*(d[s]+d[t]);o=(o*e-c[s]*h[t]+c[n]*h[s])/i,l=(l*e-u[s]*h[t]+u[n]*h[s])/i}i.push(`C${a},${r} ${o},${l} ${c[t]},${u[t]}`)}for(let p=0;p!==s.length;++p){const m=r(this.min+p*t.binwidth),g=o(s[p]*a);if(0===p)i.push(`M${m},${g}`),c[3]=c[0]=m,u[3]=u[0]=g;else{const a=(p+3)%4,r=p%4;c[r]=m,u[r]=g;const o=c[a]-m,b=u[a]-g;if(h[r]=Math.sqrt(o*o+b*b),d[r]=Math.sqrt(h[r]),p>1&&(f(a),null!=l&&c[a]>l&&(this.#n(i.join(""),e+" pa-gg-cutoff",t.series,n),i.splice(0),i.push(`M${c[a]},${u[a]}`),l=null)),p===s.length-1){const t=(p+1)%4;c[t]=m,u[t]=g,h[t]=0,d[t]=0,f(r)}}}return this.#n(i.join(""),e,t.series,n)}remove_if(t){let e=this.gg.firstChild;for(;e;){const n=e.nextSibling;t.call(e)&&this.gg.removeChild(e),e=n}}highlight(t,e,n){if(!this.hlcurve||!this.hlcurve_series.cdfu)return null;const i=d(this.hlcurve,"pa-gg-pdf"),s=this.hlcurve_series.cdf,a=this.hlcurve_series.cdfu,r=[];let o,l,c,u,p,f,m;for(o=i?.9/(this.maxp*t.n):1/t.n,l=o*this.gh,c=u=0;c!==s.length;c+=2){for(m=0;u!==s[c+1];++u)e(a[u],t)&&++m;m&&(p=this.xax(s[c]),f=i?yn.call(this.hlcurve,p):this.yax(s[c+1]*o),null!=f&&r.push(`M${p},${f}v${m*l}`))}if(!r.length)return null;const g=Nn("path");return g.setAttribute("d",r.join("")),g.setAttribute("fill","none"),g.setAttribute("class",n),this.gg.appendChild(g),h(this.gg,"pa-gg-has-hl"),g}typed_annotation(t){const e=Nn("circle");return e.setAttribute("class","pa-gg-mark hl-"+(t||"main")),e.setAttribute("r",t&&"main"!==t?3.5:5),e}star_annotation(t,e,n,i){null==e&&(e=Math.PI/2),null==n&&(n=5);var s=Nn("path");s.setAttribute("class",i);for(var a=["M"],r=Math.cos,o=Math.sin,l=Math.PI/n,c=0;c<2*n;++c)a.push(t[1&c]*r(e),",",t[1&c]*o(e),c?" ":"L"),e+=l;return a.push("z"),s.setAttribute("d",a.join("")),s}annotate(t,e,n){if(!this.hlcurve)return!1;let i=this.xax(t),s=yn.call(this.hlcurve,i);if(null===s&&this.cutoff){const e=this.yax(0);s=e+(this.yax(this.cutoff)-e)*((t-this.min)/(this.hlcurve_series.cdf[0]-this.min))}return null!==s&&((e=e||this.typed_annotation()).setAttribute("transform",`translate(${i},${s})`),this.gg.insertBefore(e,n||null),!0)}user_x(t){let e=this.hlcurve_ucdf;if(!e){if(!this.hlcurve_series||!this.hlcurve_series.cdfu)return;const t=this.hlcurve_series.cdf,n=this.hlcurve_series.cdfu;this.hlcurve_ucdf=e={};let i=0;for(let s=0;s!==n.length;++s){for(;s>=t[i+1];)i+=2;e[n[s]]=t[i]}}return e[t]}highlight_users(){if(!this.hlcurve_series||!this.hlcurve_series.cdfu)return;this.last_highlight=this.last_highlight||{};const t=this.container().attributes,e={};for(let n=0;n!==t.length;++n)if(t[n].name.startsWith("data-pa-highlight")){let i;i="data-pa-highlight"===t[n].name?"main":t[n].name.substring(18),e[i]=t[n].value,this.last_highlight[i]=this.last_highlight[i]||""}for(let t in this.last_highlight){var n=e[t]||"";if(this.last_highlight[t]===n)continue;const r={},o=n.split(/\s+/);for(const t of o)""!==t&&(r[t]=1);for(var i,s=this.gg.firstChild,a="pa-gg-mark hl-"+t;s&&(!d(s,"pa-gg-mark")||s.className.animVal<a);)s=s.nextSibling;for(;s&&s.className.animVal===a;){i=s.nextSibling;const t=+s.getAttribute("data-pa-uid");r[t]?r[t]=2:this.gg.removeChild(s),s=i}for(const e in r){if(1!==r[e])continue;const n=this.user_x(e);if(null!=n){const i=this.typed_annotation(t);i.setAttribute("data-pa-uid",e),this.annotate(n,i,s)}}this.last_highlight[t]=n}}hover(){const t=this;function e(e){t.#i(this,e)}this.svg.addEventListener("mouseenter",e,!1),this.svg.addEventListener("mousemove",e,!1),this.svg.addEventListener("mouseleave",e,!1)}#i(t,n){let i={distance:20},s=this.xfmt;if("mousemove"!==n.type&&(this.hoveron="mouseleave"!==n.type),this.hoveron){const t=function(t,e){var n,i=t.ownerSVGElement||t;if(i.createSVGPoint)(n=i.createSVGPoint()).x=e.clientX,n.y=e.clientY,n=n.matrixTransform(t.getScreenCTM().inverse());else{var s=t.getBoundingClientRect();n={x:e.clientX-s.left-t.clientLeft,y:e.clientY-s.top-t.clientTop}}var a=[n.x,n.y];return a.clientX=e.clientX,a.clientY=e.clientY,a}(this.svg,n),e=this.gg.querySelectorAll(".pa-gg-pdf, .pa-gg-cdf");for(var a of(t[0]-=this.ml,t[1]-=this.mt,e))i=$n(a,t,i);if(i.pathNode){const t=Fn(this.gg.querySelectorAll(".pa-gg-mark.hl-main"),i,36)||Fn(this.gg.querySelectorAll(".pa-gg-mark:not(.hl-main)"),i,25);t&&(i=t,"%.0r"!==s&&"%.1f"!==s||(s="%.2r"))}}if(!i.pathNode)return void(this.hoveranno&&this.#s());const r=this.hoveranno||this.#a();r[0].setAttribute("transform",`translate(${i[0]},${i[1]})`),r[1].setAttribute("transform",`translate(${i[0]},0)`),r[3].setAttribute("x",i[0]),r[3].firstChild.data=e(s,this.unxax(i[0]));var o=r[3].getBBox();let l,c,u;if(r[2].setAttribute("x",i[0]-o.width/2-2),r[2].setAttribute("width",o.width+4),i.pathNode.hasAttribute("data-pa-uid")&&(l=t.closest("form").pa__ptconf)&&(c=l.uidmap[i.pathNode.getAttribute("data-pa-uid")])&&(u=l.render_tooltip_name(c))?(r[4].firstChild.data=u,r[4].setAttribute("x",i[0]),r[4].setAttribute("y",i[1])):r[4].firstChild.data="",this.yl){const t=this.unyax(i[1]);this.cutoff&&t<this.cutoff!==r[8]&&((r[8]=t<this.cutoff)?(r[5].setAttribute("visibility","hidden"),r[6].setAttribute("visibility","hidden"),r[7].setAttribute("visibility","hidden")):(r[5].removeAttribute("visibility"),r[6].removeAttribute("visibility"),r[7].removeAttribute("visibility"))),r[5].setAttribute("transform",`translate(0,${i[1]})`),r[7].setAttribute("y",i[1]+.25*this.xdh),r[7].firstChild.data=e(this.yfmt,t*this.ymax),o=r[7].getBBox(),r[6].setAttribute("x",-o.width-10),r[6].setAttribute("y",i[1]-(this.xdh+2)/2),r[6].setAttribute("width",o.width+4)}}#a(){const t=this.hoveranno=[this.star_annotation([4,10],null,null,"pa-gg-hover-mark")];this.gg.appendChild(t[0]);let e=Nn("path");return e.setAttribute("d","M0,0v5"),e.setAttribute("fill","none"),e.setAttribute("stroke","black"),this.gx.appendChild(e),t.push(e),e=Nn("rect"),e.setAttribute("class","pa-gg-hover-box"),e.setAttribute("y",5),e.setAttribute("height",this.xdh+1.5),e.setAttribute("rx",3),this.gx.appendChild(e),t.push(e),e=Nn("text"),e.appendChild(document.createTextNode("")),e.setAttribute("class","pa-gg-hover-text"),e.setAttribute("y",this.xdh+3),this.gx.appendChild(e),t.push(e),e=Nn("text"),e.appendChild(document.createTextNode("")),e.setAttribute("class","pa-gg-anno-name"),e.setAttribute("text-anchor","end"),e.setAttribute("dx",-8),this.gg.appendChild(e),t.push(e),this.yl&&(e=Nn("path"),e.setAttribute("d","M-5,0h5"),e.setAttribute("fill","none"),e.setAttribute("stroke","black"),this.gy.appendChild(e),t.push(e),e=Nn("rect"),e.setAttribute("class","pa-gg-hover-box"),e.setAttribute("height",this.xdh+1),e.setAttribute("rx",3),this.gy.appendChild(e),t.push(e),e=Nn("text"),e.appendChild(document.createTextNode("")),e.setAttribute("class","pa-gg-hover-text"),e.setAttribute("x",-8),this.gy.appendChild(e),t.push(e),this.cutoff&&t.push(!1)),t}#s(){const t=this.hoveranno;this.gg.removeChild(t[0]),this.gx.removeChild(t[1]),this.gx.removeChild(t[2]),this.gx.removeChild(t[3]),this.gg.removeChild(t[4]),this.yl&&(this.gy.removeChild(t[5]),this.gy.removeChild(t[6]),this.gy.removeChild(t[7])),this.hoveranno=null}}function Fn(t,e,n){let i=null;for(const s of t){const t=s.getAttribute("transform").match(/^translate\(([-+\d.]+),([-+\d.]+)\)$/);if(t){const a=+t[1]-e[0],r=+t[2]-e[1],o=a*a+r*r;o<n&&(i=[+t[1],+t[2]],i.pathNode=s,n=o)}}return i&&(i.distance=Math.sqrt(n)),i}class Mn{n;cdf;cdfu;mean;median;stddev;cutoff;constructor(t){t&&(this.n=t.n,this.cdf=t.cdf,this.cdfu=t.cdfu||null,this.mean=t.mean||null,this.median=t.median||null,this.stddev=t.stddev||null,this.cutoff=t.cutoff||null)}static from_sorted_array(t){const e=[];let n=-2,i=0;for(const s of t)++i,n<0||e[n]!==s?(e.push(s,i),n+=2):e[n+1]=i;return new Mn({n:i,cdf:e})}check(){this.cdf||this.#r(),(0===this.n?this.cdf.length>0:this.cdf[this.cdf.length-1]!==this.n)&&this.#r(),this.cdfu&&this.cdfu.length!==this.n&&this.#r();for(let t=0;t!==this.cdf.length;t+=2)(this.cdf[t+1]<=0||t>0&&this.cdf[t+1]<=this.cdf[t-1]||t>0&&this.cdf[t]<=this.cdf[t-2])&&this.#r()}#r(){throw new Error}min(){return this.n>0?this.cdf[0]:0}max(){return this.n>0?this.cdf[this.cdf.length-2]:0}#o(t){const e=this.cdf;let n=0,i=e.length;for(;n+2<i;){const s=n+(i-n>>1&-2);e[s]>t?i=s:n=s}return n}#l(t){const e=this.cdf;let n=0,i=e.length;for(;n+2<i;){const s=n+(i-n>>1&-2);s>0&&e[s-1]<=t?n=s:i=s}return n}count_at(t){const e=this.#o(t);return 0===this.n||t<this.cdf[e]?0:this.cdf[e+1]}quantile(t){if(0===this.n)return 0;const e=t*(this.n-1),n=0|e,i=this.#l(n);return e===n||n<0||n>this.n-1||n+1<this.cdf[i+1]?this.cdf[i]:this.cdf[i]+(e-n)*(this.cdf[i+2]-this.cdf[i])}#c(t){const e=new Mn;e.n=t,this.cdfu&&(e.cdfu=this.cdfu.slice(0,t));const n=t>0&&this.n>0?this.#l(t-1)+2:0;return e.cdf=this.cdf.slice(0,n),n>0&&e.n<e.cdf[n-1]&&(e.cdf[n-1]=e.n),e}#u(){if(0===this.n)return void(this.mean=this.median=this.stddev=null);let t=0,e=this.cdf[0],n=this.cdf[1],i=0,s=0;const a=this.n;for(let r=0;r!==a;++r){for(;r===n;)t+=2,e=this.cdf[t],n=this.cdf[t+1];i+=e,s+=e*e}this.mean=i/a,this.median=this.quantile(.5),this.stddev=a>1?Math.sqrt((s-i*i/a)/(a-1)):0}filter(t){let e=null,n=this.n,i=0,s=0;for(let a=0;a!==n;++a){for(;this.cdf[i+1]===a;)i+=2;const n=this.cdf[i],r=this.cdfu?this.cdfu[a]:null;t(n,r)?e&&(++e.n,this.cdfu&&e.cdfu.push(r),0!==s&&n===e.cdf[s-2]||(e.cdf.push(n,e.n),s+=2),e.cdf[s-1]=e.n):e||(e=this.#c(a),s=e.cdf.length)}return e?(e.#u(),e):this}}class Tn{series;kde;maxp;binwidth;constructor(t,e,n,i){const s=e.max,a=e.min,r=(s-a)*n,o=1/r;function l(t){return t>=-r&&t<=r?.75*o*(1-(t*=o)*t):0}const c=[];for(let t=0;t!==i+1;++t)c.push(0);let u=t.cdf;if(t.cutoff&&u.length>0){const e=Math.floor(u[u.length-1]*t.cutoff);if(e>0){const t=[0,0],n=(u[0]-a)/e;for(let i=a,s=0,r=0;s!==e;i+=n,++s){const e=Math.floor(i);t[r]===e?t[r+1]=s:(t.push(e,s),r+=2)}t.push(...u),u=t}}const d=(s-a)/i,h=1/d;for(let t=0;t<u.length;t+=2){const e=u[t+1]-(0===t?0:u[t-1]);let n=Math.floor((u[t]-a-r)*h);const s=Math.ceil((u[t]-a+r)*h);for(;n<s;){const s=Math.max(-1,Math.min(i+1,n));s>=0&&s<=i&&(c[s]+=l(n*d-u[t]+a)*e),++n}}let p=0;if(t.n){const e=1/t.n;for(let t=0;t!==i+1;++t)c[t]*=e,p=Math.max(p,c[t])}this.series=t,this.kde=c,this.maxp=p,this.binwidth=d}}class Ln{constructor(t){this.pset=t.pset,this.psetid=t.psetid,this.maxtotal=t.maxtotal||null,this.entry=t.entry||null,this.series={};for(let e in t.series)this.series[e]=new Mn(t.series[e])}}function jn(){const e=this,n=e.pa__gradedata;if(!n)return h(e,"hidden"),void $(e).removeData("paGradeGraph").off("redrawgraph");p(e,"hidden");const i=e.closest(".pa-psetinfo"),s=e.closest("form"),a=s?s.pa__ptconf:null,r=!i||i.hasAttribute("data-pa-user-extension"),o=function(e){const n=e.getAttribute("data-pa-gg-type");let i=n;if(i||(i=t(!0,"pa-gg-type")),!i){let e=t(!1,"pa-gg-type");if(e&&"{"===e[0])try{e=JSON.parse(e),"string"==typeof e.type&&"number"==typeof e.at&&e.at>=(new Date).getTime()-72e5&&(i=e.type)}catch{}}const s=e.getAttribute("data-pa-gg-types").split(" ");return i&&"default"!==i||(i=s[0]),s.indexOf(i)<0&&(i="pdf"===i.substring(0,3)?s[1]:s[0]),i!==n&&(e.setAttribute("data-pa-gg-type",i),p(e,n),h(e,i)),i}(e),l="all"===o.substring(0,3),c=o.indexOf("-extension")>=0||l&&r&&n.extension,u=o.indexOf("-noextra")>=0||l&&n.series.noextra&&!c;let d=$(e).find(".pa-plot");d.length||(d=$(e));const f=new Dn(d[0],n,o);if(e.pa__gradegraph=f,f.total&&f.total<f.max){let t=document.createElementNS("http://www.w3.org/2000/svg","line");t.setAttribute("x1",f.xax(f.total)),t.setAttribute("y1",f.yax(0)),t.setAttribute("x2",f.xax(f.total)),t.setAttribute("y2",f.yax(1)),t.setAttribute("class","pa-gg-anno-total"),f.gg.appendChild(t)}let m=null;a&&a.has_hidden&&(m=n.series.all.filter((t,e)=>{const n=a.uidmap[e];return n&&!n.hidden}));const g=Math.ceil((f.max-f.min)/2),b=.08,_={};"pdf-extension"===o?_.extension=new Tn(n.series.extension,f,b,g):"pdf-noextra"===o?_.noextra=new Tn(n.series.noextra,f,b,g):"pdf"===o&&(_.main=new Tn(n.series.all,f,b,g)),m&&o.startsWith("pdf")&&(_.filtered=new Tn(m,f,b,g));for(let t in _)f.maxp=Math.max(f.maxp,_[t].maxp);m&&o.startsWith("pdf")&&f.append_pdf(_.filtered,"pa-gg-pdf pa-gg-filtered"),"pdf-noextra"===o?f.append_pdf(_.noextra,"pa-gg-pdf pa-gg-noextra"):"pdf"===o?f.append_pdf(_.main,"pa-gg-pdf"):"pdf-extension"===o&&f.append_pdf(_.extension,"pa-gg-pdf pa-gg-extension"),m&&!o.startsWith("pdf")&&f.append_cdf(m,"pa-gg-cdf pa-gg-filtered"),("cdf-noextra"===o||"all"===o&&n.series.noextra)&&f.append_cdf(n.series.noextra,"pa-gg-cdf pa-gg-noextra"),"cdf"!==o&&"all"!==o||f.append_cdf(n.series.all,"pa-gg-cdf",1),("cdf-extension"===o||"all"===o&&n.series.extension&&r)&&f.append_cdf(n.series.extension,"pa-gg-cdf pa-gg-extension");const v=i?i.pa__gradesheet:null,y=v?v.grade_total(u&&!l):null;null!=y&&f.annotate(y),f.xaxis(),f.yaxis(),e.hasAttribute("data-pa-highlight")&&f.highlight_users(),f.hover(),$(e).find(".statistics").each(function(){const t=f.last_curve_series,e=[];t&&t.mean&&e.push("mean "+t.mean.toFixed(1)),t&&t.median&&e.push("median "+t.median.toFixed(1)),t&&t.stddev&&e.push("stddev "+t.stddev.toFixed(1));const n=[e.join(", ")];if(t&&null!=y){const e=t.count_at(y);t.cutoff&&e<t.cutoff*t.n?n.push(""+Math.round(100*t.cutoff)+" %ile"):n.push(Math.round(Math.min(Math.max(1,100*e/t.n),99))+" %ile")}n.length?(p(this,"hidden"),this.innerHTML=n.join("  ")):(h(this,"hidden"),this.innerHTML="")}),$(e).find(".pa-grgraph-type").each(function(){const t=[];o.startsWith("cdf")?t.push("CDF"):o.startsWith("pdf")&&t.push("PDF"),c&&!l&&t.push("ext"),u&&!l&&t.push("no EC"),0===t.length?this.lastChild&&1===this.lastChild.nodeType&&"pa-grgraph-subtype"===this.lastChild.className&&this.lastChild.remove():(this.lastChild&&1===this.lastChild.nodeType&&"pa-grgraph-subtype"===this.lastChild.className||this.append(S("span","pa-grgraph-subtype")),this.lastChild.textContent="("+t.join(", ")+")")}),f.highlight_users(),$(e).off("redrawgraph").on("redrawgraph",jn)}function On(t){t=t.replace(/^[^#]*/,"");let e,n=/([^#=/]+)[=/]?([^/]*)/g,i={};for(;e=n.exec(t);)i[e[1]]=decodeURIComponent(e[2].replace(/\+/g," "));return i}function zn(t){const e=On(location.hash);for(let n in t)null===t[n]||void 0===t[n]?delete e[n]:e[n]=t[n];const n=function(t){const e=[];for(var n in t)null===t[n]||void 0===t[n]||""===t[n]?e.push(n):e.push(n+"="+encodeURIComponent(t[n]).replace(/%20/g,"+"));return e.sort(),e.length?"#"+e.join("/"):""}(e);n!==location.hash&&wn(location.origin+location.pathname+location.search+n)}function Bn(){return d(document.body,"want-grgraph-hash")}function In(t,e,n){const i="data-pa-highlight"+("main"===e?"":"-"+e);n=n||"",$(t).find(".pa-grgraph").each(function(){const t=this.getAttribute(i)||"",s=this;t===n||"main"!==e&&"course"===this.getAttribute("data-pa-pset")||(n?this.setAttribute(i,n):this.removeAttribute(i),window.requestAnimationFrame(function(){const t=s.pa__gradegraph;t&&t.highlight_users()}))})}function qn(t,e){const n={},i={};let s,a=!1;for(let e of t.match(/[-\d.]+/g)||[])n[e]=!0;if($(".js-grgraph-highlight-course").each(function(){const t=this.getAttribute("data-pa-highlight-range")||"90-100",e=this.getAttribute("data-pa-highlight-type")||"h00";if(i[e]=i[e]||[],this.checked=!!n[t]){let n=t.match(/^([-+]?(?:\d+\.?\d*|\.\d+))-([-+]?(?:\d+\.?\d*|\.\d))(\.?)$/);if(n)i[e].push(+n[1],+n[2]+(n[3]?1e-5:0)),a=!0;else{if(!(n=t.match(/^([-+]?(?:\d+\.?\d*|\.\d+))-$/)))throw new Error("bad range");i[e].push(+n[1],1/0),a=!0}}}),a)if(s=function(){let t=null;return $(".pa-grgraph[data-pa-pset=course]").each(function(){const e=this.pa__gradedata;if(e&&e.series.all&&e.series.all.cdfu)return t=e.series.all,!1}),t}())for(let t in i){const e=i[t],n=[];if(e.length){for(let t=0;t!==s.cdf.length;t+=2)for(let i=0;i!==e.length;i+=2)if(s.cdf[t]>=e[i]&&s.cdf[t]<e[i+1]){const e=t?s.cdf[t-1]:0;Array.prototype.push.apply(n,s.cdfu.slice(e,s.cdf[t+1]));break}n.sort()}In(document.body,t,n.join(" "))}else setTimeout(function(){qn(On(location.hash).hr||"",e+1)},8<<Math.max(e,230));else for(let t in i)In(document.body,t,"")}function Rn(t){const e=On(t);In(document.body,"main",e.hs||""),$("input[type=checkbox].js-grgraph-highlight").prop("checked",!1);for(let t of(e.hs||"").match(/\d+/g)||[])$("tr[data-pa-uid="+t+"] input[type=checkbox].js-grgraph-highlight").prop("checked",!0);qn(e.hr||"",0),$(".js-grgraph-highlight-course").prop("checked",!1);for(let t of(e.hr||"").match(/[-\d.]+/g)||[])$('.js-grgraph-highlight-course[data-pa-highlight-range="'+t+'"]').prop("checked",!0)}v.on("js-grgraph-flip",function(){const e=this.closest(".pa-grgraph"),n=(e.getAttribute("data-pa-gg-types")||"").split(/ /),i=e.getAttribute("data-pa-gg-type");let s=n.indexOf(i);s>=0&&(s=(s+(d(this,"prev")?n.length-1:1))%n.length,e.setAttribute("data-pa-gg-type",n[s]),t(!0,"pa-gg-type",n[s]),t(!1,"pa-gg-type",{type:n[s],at:(new Date).getTime()}),jn.call(e))}),wn="pushState"in window.history?function(t){var e;return history.state||(e={href:location.href},$(document).trigger("collectState",[e]),history.replaceState(e,document.title,e.href)),t&&(e={href:t},$(document).trigger("collectState",[e]),history.pushState(e,document.title,e.href)),!0}:function(){return!1},v.on("change.js-grgraph-highlight",function(){const t=this.getAttribute("data-range-type"),e=this.closest("form");e.hasAttribute("data-pa-grgraph-hl-scheduled-"+t)||(e.setAttribute("data-pa-grgraph-hl-scheduled-"+t,""),queueMicrotask(()=>function(t,e){const n=[];for(let i of t.querySelectorAll("input[type=checkbox]")){let t;i.checked&&i.getAttribute("data-range-type")===e&&(t=i.closest("tr"))&&t.hasAttribute("data-pa-uid")&&n.push(+t.getAttribute("data-pa-uid"))}n.sort((t,e)=>t-e),Bn()?(zn({hs:n.length?n.join(" "):null}),In(document.body,"main",n.join(" "))):In(t,"main",n.join(" ")),t.removeAttribute("data-pa-grgraph-hl-scheduled-"+e)}(e,t)))}),v.on("js-grgraph-highlight-course",function(){const t=[];$(".js-grgraph-highlight-course").each(function(){this.checked&&t.push(this.getAttribute("data-pa-highlight-range"))}),Bn()&&zn({hr:t.length?t.join(" "):null}),qn(t.join(" "),0)}),Bn()&&($(window).on("popstate",function(t){const e=(t.originalEvent||t).state;e&&e.href&&Rn(e.href)}).on("hashchange",function(){Rn(location.href)}),$(function(){Rn(location.href)})),Te.add("checkbox",{text:function(t){return null==t||0===t||!1===t?"":t===(this.max||1)||!0===t?"":""+t},simple_text:Te.basic_text,tcell:function(t){return null==t||0===t||!1===t?"":t===(this.max||1)||!0===t?"":""+t},mount_edit:function(t,e){return Pn.finish_mount_edit(this,S("span","pa-gradewidth",S("input",{type:"checkbox",class:"uic uich pa-gradevalue ml-0 pa-fresh",name:this.key,id:e,value:this.max,disabled:this.disabled})))},update_edit:function(t,e,n){const i=null==e||""===e||0===e||this&&e===this.max,s=t.firstChild.firstChild;i||"checkbox"!==s.type?i&&"checkbox"!==s.type&&n.reset&&Pn.recheckbox(s):Pn.uncheckbox(s),"checkbox"===s.type?(s.checked=!!e,s.indeterminate=!!n.mixed):s.value===e||!n.reset&&$(s).is(":focus")||(s.value=""+e)},justify:"center",parse_search:function(t,e){const n=function(t){if(!1===t||!0===t)return t;if(0===t||1===t)return 1===t;if("string"!=typeof t)return null;const e=/^(?:(y|yes|1|true|t|on)|(n|no|0|false|f|off))$/.exec(t);return e?!!e[1]:null}(t);if(null!==n)return t=>t.grades[e]>0===n}});class Pn{static uncheckbox(t){const e=Pe.closest(t);"checkbox"===t.type&&(t.value=t.checked?e.max:""),t.type="text",p(t,"ml-0"),h(t,"pa-gradewidth"),p(t,"uic"),d(t,"uich")&&h(t,"uii");const n=t.closest(".pa-pv");$(n).find(".pa-grade-uncheckbox").remove(),$(n).find('input[name^="'+t.name+':"]').addClass("hidden")}static recheckbox(t){const e=t.value.trim(),n=Pe.closest(t);t.type="checkbox",t.checked=""!==e&&"0"!==e,t.value=n.max,h(t,"ml-0"),p(t,"pa-gradewidth"),p(t,"uii"),d(t,"uich")&&h(t,"uic"),$(t.closest(".pa-pv")).find(".pa-gradedesc").append(' <button type="button" class="qo ui pa-grade-uncheckbox" tabindex="-1">#</button>')}static finish_mount_edit(t,e){const n=new DocumentFragment;return n.append(e," ",S("span","pa-gradedesc","of "+t.max+" ",S("button",{type:"button",class:"link x ui pa-grade-uncheckbox",tabindex:-1},"#"))),n}}v.on("pa-grade-uncheckbox",function(){$(this.closest(".pa-pv")).find(".pa-gradevalue").each(function(){Pn.uncheckbox(this),this.focus(),this.select()})});const Hn={98:"A+",95:"A",92:"A-",88:"B+",85:"B",82:"B-",78:"C+",75:"C",72:"C-",68:"D+",65:"D",62:"D-",50:"F"};function Wn(t){let e,n;if(t.target===this&&"mouseout"===t.type)e=-1;else{if(!("checkbox"===t.target.type&&(n=t.target.name.indexOf(":"))>=0))return;e=+t.target.name.substring(n+1)}for(let t=this.firstChild;t;t=t.nextSibling)if("checkbox"===t.type&&(n=t.name.indexOf(":"))>=0){const i=+t.name.substring(n+1);f(t,"pa-hover",i<=e)}}function Un(t){let e=""===t?"":" pa-checkbox-mark";return{text:function(e){return null==e||0===e?"":e>0&&Math.abs(e-Math.round(e))<.05?t.repeat(Math.round(e)):""+e},simple_text:Te.basic_text,tcell:function(e){return null==e||0===e||!1===e?"":e>0&&Math.abs(e-Math.round(e))<.05?t.repeat(Math.round(e)):""+e},tcell_width:function(){return 1.5*this.max},mount_edit:function(n,i){const s=document.createElement("input");s.type="hidden",s.className="uich pa-gradevalue pa-fresh",s.name=this.key;const a=document.createElement("span");a.className="pa-gradewidth",a.append(s),a.addEventListener("mouseover",Wn),a.addEventListener("mouseout",Wn);for(let n=0;n<this.max;++n){const s=document.createElement("input");s.type="checkbox",s.className="ui js-multicheckbox-grade ml-0"+e,s.name=this.key+":"+n,s.value=1,s.disabled=this.disabled,e&&s.setAttribute("data-pa-mark",t),n===this.max-1&&(s.id=i),a.append(s)}return Pn.finish_mount_edit(this,a)},update_edit:function(t,e,n){const i=null==e||""===e||0===e||e>=0&&(!this||e<=this.max)&&Math.abs(e-Math.round(e))<.05,s=t.firstChild.firstChild;i||"hidden"!==s.type?i&&"hidden"!==s.type&&n.reset&&Pn.recheckbox(s):Pn.uncheckbox(s),s.value!==e&&(s.value=e);const a=s.name+":",r=Math.round(e||0);$(t).find("input[type=checkbox]").each(function(){if(this.name.startsWith(a)){const t=+this.name.substring(a.length);this.checked=t<r,this.indeterminate=!!n.mixed}})},justify:"left"}}Te.add("letter",{text:t=>null==t?"":Hn[t]||""+t,mount_edit:function(t,e){return Te.basic_mount_edit.call(this,t,e,{max_text:"letter grade"})},justify:"left",tics:()=>{const t=[];for(let e in Hn)1===Hn[e].length&&t.push({x:e,text:Hn[e]});for(let e in Hn)2===Hn[e].length&&t.push({x:e,text:Hn[e],label_space:5});for(let e in Hn)2===Hn[e].length&&t.push({x:e,text:Hn[e].substring(1),label_space:2,notic:!0});return t}}),Te.add("checkboxes",Un("")),Te.add("stars",Un("")),Te.add("poops",Un("")),v.on("js-multicheckbox-grade",function(){const t=this.name.indexOf(":"),e=this.name.substring(0,t),n=this.name.substring(t+1),i=this.closest("form").elements[e],s=this.checked?+n+1+"":n;i.value!==s&&(i.value=s,$(i).trigger("change"))}),Te.add("select",{initialize:function(){this.object_options=null;for(const t of this.options)"object"==typeof t&&(this.object_options=this.object_options||[],this.object_options.push(t))},text:function(t){if(null==t)return"";if(this.object_options)for(const e of this.options)if(e.value==t)return""+(e.title||e.value);return""+t},simple_text:Te.basic_text,mount_edit:function(t,e){const n=document.createElement("select");n.className="uich pa-gradevalue pa-fresh",n.name=this.key,n.id=e,n.disabled=this.disabled;const i=document.createElement("option");i.value="",i.append("None"),n.append(i);for(const t of this.options){const e=document.createElement("option");"object"==typeof t?(e.value=t.value,e.append(t.title||t.value)):(e.value=t,e.append(t)),n.append(e)}const s=document.createElement("span");return s.className="select",s.append(n),s},update_edit:function(t,e,n){const i=this.simple_text(e),s=t.firstChild.firstChild;if(C(s,i),s.value=i,n.reset&&n.mixed){if(""!==s.options[0].value){const t=document.createElement("option");t.value="",t.append("Mixed"),s.insertBefore(t,s.firstChild)}s.selectedIndex=0}else""!==i&&""===s.options[0].value&&s.remove(0)},configure_column:function(t){return(t=Te.basic_configure_column.call(this,t)).className+=" gt-el",t},tcell_width:function(t){let e=0;for(const t of this.options){let n="object"==typeof t?t.title||t.value:t;e=Math.max(e,n.toString().length)}return Math.max(Te.basic_tcell_width.call(this,t),Math.floor(1.25*Math.min(e,10))/2)},justify:"left",sort:"forward"}),Te.add("markdown",{text:function(t){return null==t?"":""+t},mount_show:function(t,e){t.id=e,h(t,"pa-textv"),h(t,"pa-gradevalue")},mount_edit:function(t,e){h(t,"pa-textv");const n=document.createElement("span");n.append("Markdown styling and LaTeX math supported  ");const i=document.createElement("a");i.href="",i.className="ui js-toggle-gc-markdown-preview",i.tabIndex=-1,i.append("Preview");const s=document.createElement("p");s.className="pa-preview-notice",s.append(n,i);const a=document.createElement("textarea");a.className="uich uii pa-gradevalue need-autogrow pa-fresh",a.name=this.key,a.id=e,a.disabled=this.disabled;const r=new DocumentFragment;return r.append(s,a),r},update_show:function(t,e,n){return null==e||""===e?t.replaceChildren():this.answer?n.gradesheet.show_text_as_diff(t,e,`/g/${this.key}`):d(t.parentElement,"pa-markdown")?Ht(t,1,e):Ht(t,0,e),null===t.firstChild},justify:"left",sort:"forward",type_tabular:!1}),v.on("js-toggle-gc-markdown-preview",function(){const t=this.closest(".pa-pv").querySelector("textarea");if(t.hidden)t.parentElement.removeChild(t.previousSibling),t.hidden=!1,t.focus(),this.textContent="Preview",this.previousSibling.hidden=!1;else{const e=document.createElement("div"),n=document.createElement("hr"),i=document.createElement("hr"),s=document.createElement("div");e.className="pa-preview",n.className=i.className="pa-preview-border",s.className="pa-dr",e.append(n,s,i),t.parentElement.insertBefore(e,t),t.hidden=!0,Ht(s,1,t.value),this.textContent="Edit",this.previousSibling.hidden=!0}});const Zn="%Y-%m-%d %H:%M";function Kn(t,e){let n,i;return t.timeout_entry&&e&&(n=e.entries[t.timeout_entry])&&null!=(i=n.value_in(e))?i:t.timeout}function Yn(t,e,n){if(e&&e.pa__tmto&&(clearTimeout(e.pa__tmto),delete e.pa__tmto),e&&e.pa__tmsticky&&!n)e.pa__tmsticky.parentElement.remove(),delete e.pa__tmsticky;else if(e&&!e.pa__tmsticky&&n){const n=e.closest(".pa-gsection");if(n){const i=document.createElement("div"),s=document.createElement("div");i.className="pa-gnote pa-timermark-sticky",i.setAttribute("data-pa-grade",t.key),s.className="pa-timermark-alert",i.appendChild(s),n.parentElement.insertBefore(i,n),e.pa__tmsticky=s}}}function Jn(t){const n=(new Date).getTime(),i=Math.round(t.deadline-n/1e3),s=[t.start_at_text];if(i>630)s[0]=s[0].concat(" (",o(60*Math.ceil(i/60))," left)");else if(i>300)s[0]=s[0].concat(" (",o(i)," left)");else if(i>=-599){const t=document.createElement("strong");t.className="overdue",t.textContent="(".concat(o(Math.abs(i)),i<0?" over)":" left)"),s[0]+=" ",s.push(t)}else s[0]=s[0].concat(" (",o(60*-Math.ceil(i/60))," over)");if(t.tmelt.replaceChildren(...s),t.stelt){let n;n=i>630?o(60*Math.ceil(i/60))+" left":i>=0?e("%d:%02d left",Math.floor(i/60),i%60):i>-600?e("%d:%02d over",Math.floor(-i/60),-i%60):o(60*Math.floor(-i/60))+" over",t.stelt.replaceChildren(n),f(t.stelt,"urgent",i<=600&&i>-900)}let a;a=i>660||i<=-600?60*Math.floor((i-1)/60):i>630?630:Math.floor(i-.1);let r=1e3*(t.deadline-a)-490-n;r<=0&&(r+=1e3),t.tmelt.pa__tmto=setTimeout(Jn,r,t)}function Xn(t,e){h(t,"pa-textv");const n=document.createElement("textarea");return n.className="uich uii pa-gradevalue need-autogrow pa-fresh","shorttext"===this.type&&n.setAttribute("rows",1),n.name=this.key,n.id=e,n.disabled=this.disabled,n}function Vn(t,e,n){null==e||""===e?t.replaceChildren():this.answer?n.gradesheet.show_text_as_diff(t,e,`/g/${this.key}`):Ht(t,0,e)}function Gn(t){const e=(t=t||{}).near||t.anchor||window,n=S("form",{enctype:"multipart/form-data","accept-charset":"UTF-8",class:t.form_class||null}),i=S("div",{class:"modal",role:"dialog",hidden:!0},S("div",{class:"modal-dialog".concat(e===window?" modal-dialog-centered":"",t.className?" "+t.className:""),role:"document"},S("div","modal-content",n)));t.action&&(t.action instanceof HTMLFormElement?(n.setAttribute("action",t.action.action),n.setAttribute("method",t.action.method)):(n.setAttribute("action",t.action),n.setAttribute("method",t.method||"post")),"post"!==n.getAttribute("method")||/post=/.test(n.getAttribute("action"))||/^(?:[a-z][-a-z0-9+.]*:|\/\/)/i.test(n.getAttribute("action"))||n.prepend(S("input",{type:"hidden",name:"post",value:siteinfo.postvalue})));for(const e of["minWidth","maxWidth","width"])null!=t[e]&&$(i.firstChild).css(e,t[e]);let s,a;function r(){p(document.body,"modal-open"),document.body.removeEventListener("keydown",o),document.activeElement&&i.contains(document.activeElement)&&document.activeElement.blur(),$pa.tooltip.close(),$(i).find("textarea, input").unautogrow(),$(n).trigger("closedialog"),i.remove(),s&&s.focus({preventScroll:!0})}function o(t){"Escape"!==L(t)||0!==L.modcode(t)||d(i,"hidden")||E(n)||(r(),t.preventDefault())}$(i).on("click",function(t){0===t.button&&(t.target===i&&!E(n)||"BUTTON"===t.target.nodeName&&"cancel"===t.target.name)&&r()}),document.body.appendChild(i),document.body.addEventListener("keydown",o);const l={show:function(){const t=document.activeElement;return $(i).awaken(),function(t,e){for(At.close(),t.jquery&&(t=t[0]);!d(t,"modal-dialog");)t=t.childNodes[0];const n=t.parentNode;if(n.hidden=!1,h(document.body,"modal-open"),!d(t,"modal-dialog-centered")){var i=$(e).geometry(),s=$(window).geometry(),a=$(n).offset(),r=(i.top+i.bottom-t.offsetHeight)/2;r=Math.max(s.top+5,Math.min(s.bottom-5-t.offsetHeight,r))-a.top,t.style.top=r+"px";var o=(i.right+i.left-t.offsetWidth)/2;o=Math.max(s.left+5,Math.min(s.right-5-t.offsetWidth,o))-a.left,t.style.left=o+"px"}queueMicrotask(function(){for(const e of t.querySelectorAll(".want-focus"))if(e.offsetWidth>0)return void Qn(e);for(const e of t.querySelector("form").elements)if("hidden"!==e.type&&!d(e,"btn-danger")&&!d(e,"no-focus")&&e.offsetWidth>0)return void Qn(e)})}(i,e),t&&document.activeElement!==t&&(s=t),$pa.tooltip.close(),l},append:function(...t){for(const e of t)null!=e&&n.append(e);return l},append_actions:function(...t){a||n.appendChild(a=S("div","popup-actions"));for(const e of t)"Cancel"===e?a.append(S("button",{type:"button",name:"cancel"},"Cancel")):null!=e&&a.append(e);return l},on:function(...t){return $(n).on(...t),l},find:function(t){return $(i).find(t)},querySelector:function(t){return n.querySelector(t)},querySelectorAll:function(t){return n.querySelectorAll(t)},form:function(){return n},show_errors:function(t,e){$(n).find(".msg-error, .feedback, .feedback-list").remove();const i=[];for(const s of t.message_list||[]){const t=s.field&&n.elements[s.field];(t?Gt.append_item_near(t,s):e&&s.field)||i.push(s)}i.length&&$(n).find("h2").after(Gt.render_alert(i))},close:r};return l}function Qn(t){if(t.jquery&&(t=t[0]),t.focus(),!t.hotcrp_ever_focused){if(t.select&&d(t,"want-select"))t.select();else if(t.setSelectionRange)try{t.setSelectionRange(t.value.length,t.value.length)}catch{}t.hotcrp_ever_focused=!0}}function ti(t,e,n,i){const s=e[n.uid],a=t.uidmap[n.uid],r=[].concat(a.grades||[]);a.assign(n);let o=0;for(let t of a.grades||[])null!=t&&""!==t&&++o;a.ngrades=o;for(let e of t.col)0!==((e.refreshable||0)&i)&&e.td.call(e,s.childNodes[e.index],a,{oldgrades:r})}function ei(){f(this.closest(".pa-pv"),"pa-grade-changed",this.hasAttribute("data-pa-unmixed")||A(this))}function ni(t){if("click"===t.type&&!t.shiftKey){const t=this.checked;let e=this.closest("label");for(;e=e.nextSibling;){const n=e.firstChild.firstChild;if(n.classList.contains("pa-gdialog-section"))break;n.checked=t}}}function ii(t,...e){return S("label","checki",S("span","checkc",S("input",t)),...e)}function si(t){return S("div","popup-actions",S("button",{type:"button",class:"btn btn-primary",name:t},"Save"))}function ai(t,e,n,i){let s,a,r,o=t.gradesheet,l=function(t){const e={};for(;t;)t.getAttribute("data-pa-uid")&&(e[t.getAttribute("data-pa-uid")]=t),t=t.nextSibling;return e}(n.tBodies[0].firstChild);function c(t){s.find(".has-error").removeClass("has-error"),t.ok?s.find(".pa-messages").html(""):(s.find(".pa-messages").html(function(t,e){if("string"==typeof e&&(e=""===e?[]:[e]),0===e.length)return[];const n=document.createElement("div");n.className="msg msg-".concat("error");for(let t=0;t!==e.length;++t){const i=document.createElement("p");i.append(e[t]),n.append(i)}return n}(0,lt(t.error))),t.errf&&s.find(".pa-gradevalue").each(function(){t.errf[this.name]&&h(this,"has-error")}))}function u(e){let n=!1,i={};if(s.find(".pa-gradevalue").each(function(){if((this.hasAttribute("data-pa-unmixed")||A(this))&&!this.indeterminate){let t,e=this.name,s=o.entries[e];t="checkbox"===this.type?this.checked?this.value:"":$(this).val();for(let n of r)i[n.uid]=i[n.uid]||{grades:{},oldgrades:{}},i[n.uid].grades[e]=t,i[n.uid].oldgrades[e]=s.value_in(n);n=!0}}),e=e||function(){s.close()},n)if(1===r.length)Q(I("=api/grade",t.url_gradeparts(r[0])),i[r[0].uid]).then(function(n){c(n),n.ok&&(ti(t,l,n,1),e())});else{for(let t of r)t.grade_commit?(i[t.uid].commit=t.grade_commit,i[t.uid].commit_is_grade=1):t.commit&&(i[t.uid].commit=t.commit);Q(I("=api/multigrade",{pset:t.key}),{us:JSON.stringify(i)}).then(function(n){if(c(n),n.ok){for(let e of n.us)ti(t,l,e,1);e()}})}else e()}function d(){const t=this.getAttribute("data-pa-spos");u(function(){f([t])})}function f(e){r=[];for(let n=0;n!==e.length;++n)r.push(t.smap[e[n]]);t.render_gdialog_users(s.find("h3")[0],r),1===r.length&&function(t){let e,i=n.tBodies[0].firstChild;for(;i&&i.getAttribute("data-pa-spos")!=t._spos;)i=i.nextSibling;for(e=i;e&&(e===i||!e.hasAttribute("data-pa-spos"));)e=e.previousSibling;for(s.find("button[name=prev]").attr("data-pa-spos",e?e.getAttribute("data-pa-spos"):"").prop("disabled",!e).removeClass("hidden"),e=i;e&&(e===i||!e.hasAttribute("data-pa-spos"));)e=e.nextSibling;s.find("button[name=next]").attr("data-pa-spos",e?e.getAttribute("data-pa-spos"):"").prop("disabled",!e).removeClass("hidden")}(r[0]),s.find(".pa-grade").each(function(){let t=this.getAttribute("data-pa-grade"),e=o.entries[t],n=e.value_order_in(o),i=r[0].grades[n],s={reset:!0,mixed:!1};if(1===r.length)s.gradesheet=r[0],s.autograde=e.autovalue_in(r[0]);else for(let t=1;t!==r.length;++t){let e=r[t].grades[n];if(!(e===i||null==e&&""===i||""===e&&null==i)){i=null,s.mixed=!0;break}}e.update_at(this,i,s)})}function m(t){let e;!t.ctrlKey||"n"!==t.key&&"p"!==t.key||!(e=s.find("button[name="+("n"===t.key?"next":"prev")+"]"))||e[0].disabled?"Return"===t.key||"Enter"===t.key?(u(null),t.stopImmediatePropagation(),t.preventDefault()):"Esc"===t.key||"Escape"===t.key?(t.stopImmediatePropagation(),t.preventDefault(),s.close()):"Backspace"===t.key&&this.hasAttribute("placeholder")&&this.closest(".pa-gradelist")&&g.call(this):(d.call(e[0]),t.stopImmediatePropagation(),t.preventDefault())}function g(){p(this,"has-error"),this.hasAttribute("placeholder")&&(this.setAttribute("data-pa-unmixed",1),this.removeAttribute("placeholder"),ei.call(this))}function b(){const t=s.find(".pa-gradelist")[0];if(!t.firstChild){const e=We.closest(t);for(const n of e.value_entries())n.readonly||t.appendChild(n.render(e,1))}s.find(".pa-gdialog-tab").addClass("hidden"),t.classList.remove("hidden"),p(a.elements.bsubmit,"hidden"),p(a.elements.clearauto,"hidden")}function _(){const e=s.find(".pa-gdialog-settings")[0],n={};for(let t of r)n[t.uid]={uid:t.uid};if("save-gvis"===this.name){let t;$(e).find(".pa-gvis").each(function(){this.checked&&!this.indeterminate&&(t=JSON.parse(this.value))});for(let e of r)n[e.uid].scores_visible=t}else if("save-grader"===this.name&&"clear"===a.elements.gradertype.value)for(let t of r)n[t.uid].gradercid=0;else if("save-grader"===this.name&&"previous"===a.elements.gradertype.value)for(let t of r)n[t.uid].gradercid="previous";else if("save-grader"===this.name){let t=[],i=[],s=0;if($(e).find(".pa-grader").each(function(){this.checked&&!this.indeterminate&&(t.push(+this.name.substring(6)),i.push(1),++s)}),s)for(let e of r){let a=Math.floor(Math.random()*s),r=0;for(;a>=i[r];)a-=Math.max(i[r],0),++r;if(n[e.uid].gradercid=t[r],s-=Math.min(i[r],1),--i[r],s<=0)for(r in s=0,i)++i[r],s+=Math.max(i[r],0)}}else if("save-repo"===this.name){const t=a.elements.clearrepo.checked,e=a.elements.adoptoldrepo.checked;for(let i of r)t&&(n[i.uid].clearrepo=!0),e&&(n[i.uid].adoptoldrepo=!0)}else if("save-dropped"===this.name){const t=a.querySelectorAll(".pa-dropped:checked");if(1!==t.length)return;for(let e of r)n[e.uid].dropped="true"===t[0].value}this.disabled=!0;const i=[];for(let t of r)i.push(n[t.uid]);const o=document.createElement("progress");o.max=i.length,o.className="float-right",this.after(o);let u=0;!function e(){const n=i.slice(u,u+16);u+=n.length,Q(I("=api/gradesettings",{pset:t.key}),{us:JSON.stringify(n)},{timeout:2e4}).then(function(n){if(c(n),o.value=u,n.ok&&n.us)for(let e of n.us)ti(t,l,e,3);n.ok&&u<i.length?e():s.close()})}()}function v(){const t=s.find(".pa-gdialog-settings")[0];$(t).find(".pa-gvis").prop("checked",!1).prop("indeterminate",!1),this.checked=!0}function y(){const t=s.find(".pa-gdialog-settings")[0];$(t).find(".pa-dropped").prop("checked",!1).prop("indeterminate",!1),$(t).find("button[name=save-dropped]").prop("disabled",!1),this.checked=!0}function x(){const t=s.find(".pa-gdialog-settings")[0],e=this;$(t).find(".pa-grader:indeterminate").each(function(){e!==this&&this.indeterminate&&(this.checked=!1),this.indeterminate=!1}),this.checked?t.closest("form").elements.gradertype.value="set":setTimeout(function(){0===$(t).find(".pa-grader:checked").length&&(t.closest("form").elements.gradertype.value="clear")},0)}s=Gn({className:"modal-dialog-wide"}).append(S("h2","pa-home-pset",t.title+" Grades"),S("h3","gdialog-userids hidden"),S("div","pa-messages"),S("div","nav-pills",S("button",{type:"button",class:"btn btn-primary no-focus is-mode",name:"mode-values"},"Values"),S("button",{type:"button",class:"btn no-focus is-mode",name:"mode-settings"},"Settings")),S("div","pa-gdialog-tab pa-gradelist is-modal"),S("div","pa-gdialog-tab pa-gdialog-settings hidden")).append_actions(S("button",{type:"button",name:"bsubmit",class:"btn-primary"},"Save"),"Cancel",S("span","btnbox btnl",S("button",{type:"button",name:"prev",class:"btnl"},"<"),S("button",{type:"button",name:"next",class:"btnl"},">")),S("button",{type:"button",name:"clearauto",class:"btnl"},"Clear autogrades")),a=s.form(),h(a,"pa-psetinfo"),a.pa__gradesheet=t.gradesheet,b(),s.on("click",".pa-gdialog-section",ni),s.on("change blur",".pa-gradevalue",ei),s.on("input change",".pa-gradevalue",g),s.on("keydown",m),s.on("keydown","input, textarea, select",m),s.find("button[name=bsubmit]").on("click",function(){u(null)}),s.find("button[name=clearauto]").on("click",function(){const e={},n={};for(const e of t.gradesheet.value_entries())n[e.key]=null;for(let t of r){const i=e[t.uid]={};t.grade_commit?(i.commit=t.grade_commit,i.commit_is_grade=1):t.commit&&(i.commit=t.commit),i.autogrades=n}Q(I("=api/multigrade",{pset:t.key}),{us:JSON.stringify(e)}).then(function(e){if(c(e),e.ok){for(let n of e.us)ti(t,l,n,1);s.close()}})}),s.find("button[name=prev], button[name=next]").on("click",d),s.find("button.is-mode").on("click",function(){s.find(".nav-pills button").removeClass("btn-primary"),"mode-settings"===this.name?function(){const e=s.find(".pa-gdialog-settings")[0],n=e.closest("form");e.firstChild||function(e){const n=1===r.length?"radio":"checkbox";e.append(S("fieldset",null,S("legend",null,"Grade visibility"),S("div","multicol-3",ii({name:"gvis",value:"true",type:n,class:"uic pa-gvis"},"Visible"),ii({name:"gvis",value:"false",type:n,class:"uic pa-gvis"},"Hidden"),ii({name:"gvis",value:"null",type:n,class:"uic pa-gvis"},"Default ("+(t.scores_visible?"visible":"hidden")+")")),si("save-gvis")));const i=S("div","checki mt-1 multicol-3");for(let t=0;t!==siteinfo.pc.__order__.length;++t){const e=siteinfo.pc.__order__[t],n=siteinfo.pc[e];i.append(ii({name:"grader"+e,value:"1",type:"checkbox",class:"uic js-range-click pa-grader","data-range-type":"grader"},n.name,S("span","ct small dim")))}e.append(S("fieldset","mt-3",S("legend",null,"Grader"),ii({name:"gradertype",value:"clear",type:"radio",class:"uic"},"Clear"),ii({name:"gradertype",value:"set",type:"radio",class:"uic"},"Set grader"),i,si("save-grader"))),t.gitless||e.append(S("fieldset","mt-3",S("legend",null,"Repository"),ii({name:"clearrepo",value:1,type:"checkbox",class:"uic"},"Clear repository"),t.has_older_repo?ii({name:"adoptoldrepo",value:1,type:"checkbox",class:"uic"},"Adopt previous repository"):null,si("save-repo"))),siteinfo.user.is_admin&&e.append(S("fieldset","mt-3",S("legend",null,"Enrollment"),S("div","multicol-2",ii({name:"dropped",value:"false",type:n,class:"uic pa-dropped"},"Enrolled"),ii({name:"dropped",value:"true",type:n,class:"uic pa-dropped"},"Dropped")),si("save-dropped"))),$(e).on("click","button",_),$(e).on("click",".pa-grader",x),$(e).on("click",".pa-gvis",v),$(e).on("click",".pa-dropped",y)}(e);const i={},o={},l={},c={};for(let t of r){t.scores_visible_pinned?t.scores_visible?i.true=(i.true||0)+1:i.false=(i.false||0)+1:i.null=(i.null||0)+1;const e=t.gradercid||0;o[e]=(o[e]||0)+1;const n=t.dropped?"true":"false";c[n]=(c[n]||0)+1}for(let e of t.smap)if(e){const t=e.gradercid||0;l[t]=(l[t]||0)+1}$(e).find("input").prop("checked",!1).prop("indeterminate",!1);for(let t in i)$(e).find(".pa-gvis[value="+t+"]").prop("checked",!!i[t]).prop("indeterminate",i[t]&&i[t]!==r.length);$(e).find("input[name=gradertype][value="+((o[0]||0)===r.length?"clear":"set")+"]").prop("checked",!0);for(let t in o)if(0!=t){const e=n.elements["grader"+t];e.checked=!0,e.indeterminate=o[t]!==r.length}$(e).find(".pa-grader").each(function(){const t=+this.name.substring(6),e=o[t]||0,n=l[t]||0;this.closest(".checki").lastChild.textContent=n&&e===n?" (".concat(n,")"):n?" (".concat(e,"/",n,")"):""});for(let t in c)$(e).find(".pa-dropped[value="+t+"]").prop("checked",!!c[t]).prop("indeterminate",c[t]&&c[t]!==r.length);c.true&&c.false&&$(e).find("button[name=save-dropped]").prop("disabled",!0),s.find(".pa-gdialog-tab").addClass("hidden"),e.classList.remove("hidden"),h(a.elements.bsubmit,"hidden"),h(a.elements.clearauto,"hidden")}():b(),this.classList.add("btn-primary")}),s.find("button[name=prev], button[name=next]").prop("disabled",!0).addClass("hidden"),f(e),i&&a.elements[i]&&(h(a.elements[i],"want-focus"),h(a.elements[i],"want-select")),s.show()}function ri(t){if("click"===t.type&&!t.shiftKey){const t=this.checked;let e=this.closest("label");for(;e=e.nextSibling;){const n=e.firstChild.firstChild;if(n.classList.contains("pa-gdialog-section"))break;n.checked=t}}}function oi(t,e){if(!t)return"~~~";let n,i=[];if(n=(t=t.replace(/\([^)]+\)|:.*$|becau?se.*$/gm,"").toUpperCase()).match(/^((?:\d+|[A-Z])(?:[\s,]+(?:AND\s+)?(?:\d+|[A-Z]))*)(?!\w)/m))i=n[1].replace(/[,\s]+(?:AND\s+)?/g," ").split(" ");else if((n=t.matchAll(/^(\d+|[A-Z])(?!\w)/gm)).length)for(const t of n)i.push(t[1]);let s=[];for(const t of i)""===t||e&&!e[t]||s.push(t);return 0===s.length?"?":s.sort().join(" ")}Te.add("timermark",{text:function(t){return null==t||0===t?"":r(Zn,t)},simple_text:Te.basic_text,tcell:function(t){return null==t||0===t?"":r(Zn,t)},tcell_width:10,make_compare:function(t){const e=t.gidx;return function(t,n){const i=t.grades&&t.grades[e],s=n.grades&&n.grades[e];if(""===i||null==i||0==i||""===s||null==s||0==s){if(""!==i&&null!=i&&0!=i)return-1;if(""!==s&&null!=s&&0!=s)return 1}else{if(i<s)return-1;if(i>s)return 1}return t._sort_user.localeCompare(n._sort_user)}},mount_show:function(t,e){t.id=e,h(t,"pa-gradevalue")},update_show:function(t,e,n){const i=n.gradesheet;if(null==e||0===e)t.textContent="";else{let n=[r(Zn,e)];if(i&&(i.student_timestamp||0)>e){const t=r(Zn,i.student_timestamp),s=i.student_timestamp-e,a=Kn(this,i);if(a&&s>a+120){n[0]=n[0].concat("  ",t," ");const e=document.createElement("strong");e.className="overdue",e.textContent="("+o(s)+" later)",n.push(e)}else n[0]=n[0].concat("  ",t," (",o(s)," later)")}t.replaceChildren(...n)}return!1},mount_edit:function(t){p(t,"pa-gradevalue");const e=document.createElement("button");e.type="button",e.className="ui js-timermark hidden mr-2",e.name=this.key+":b",e.value=1,e.disabled=this.disabled,e.append(this.label||"Press to start");const n=new DocumentFragment;if(n.append(e),siteinfo.user.is_pclike){const t=document.createElement("button");t.type="button",t.className="ui js-timermark hidden mr-2",t.name=this.key+":r",t.value=0,t.disabled=this.disabled,t.append("Reset"),n.append(t)}const i=document.createElement("span");i.className="pa-timermark-result hidden";const s=document.createElement("input");return s.type="hidden",s.className="uich pa-gradevalue pa-fresh",s.name=this.key,n.append(i,s),n},unmount:function(t){Yn(this,t.querySelector(".pa-timermark-result"),!1),t.remove()},update_edit:function(t,e,n){const i=n.gradesheet;let s=Kn(this,i);t.querySelectorAll(".js-timermark").forEach(function(t){t.classList.toggle("hidden",!e!=("1"===t.value))});const a=t.querySelector(".pa-timermark-result");a.classList.toggle("hidden",!e&&!s),Yn(this,a,!0);let l=r(Zn,e);e&&s&&e+s+600>+document.body.getAttribute("data-now")?Jn({deadline:e+s+ +document.body.getAttribute("data-time-skew"),start_at_text:l,timeout:s,tmelt:a,stelt:a.pa__tmsticky}):e?(i&&(i.student_timestamp||0)>e&&(l=l.concat(" (updated ",o(i.student_timestamp-e)," later at ",r(Zn,i.student_timestamp),")")),a.textContent=l):s&&(a.textContent="Time once started: "+o(s))},justify:"left",sort:"forward"}),v.on("js-timermark",function(){const t=this.name.indexOf(":"),e=this.name.substring(0,t),n=this.closest("form").elements[e];n.value=this.value,$(n).trigger("change")}),Te.add("text",{mount_show:function(t,e){t.id=e,h(t,"pa-textv"),h(t,"pa-gradevalue")},mount_edit:Xn,update_show:Vn,justify:"left",sort:"forward",type_tabular:!1}),Te.add("shorttext",{mount_show:function(t,e){t.id=e,h(t,"pa-gradevalue")},mount_edit:Xn,update_show:Vn,justify:"left",sort:"forward",type_tabular:!1}),v.on("js-gdialog",function(){const t=this.closest("form"),e=t.pa__ptconf,n=e.users_in(t,e.CHECKED_USERS);if(0===n.length)alert("Select one or more students first");else{const i=[];for(const t of n)i.push(t._spos);ai(e,i,t.querySelector("table.gtable"))}}),v.on("js-ptable-diff",function(){const t=this.closest("form"),e=t.pa__ptconf;!function(t,e){let n,i,s=t.gradesheet;function a(){const t=[];for(const n of e)t.push(n.uid);return t.join(" ")}function r(){d(i.elements["mode-diff"],"btn-primary")?function(){const e=i.elements.diff.value,n={pset:t.key,anonymous:t.anonymous?1:"",users:a()};if("other"===e&&i.elements.otherdiff.value)n.files=i.elements.otherdiff.value.trim();else if(e.startsWith("file:")&&e.length>5)n.file=e.substring(5);else if(e.startsWith("grade:")&&e.length>6){const t=s.entries[e.substring(6)];t.landmark_range_file?(n.file=t.landmark_range_file,n.lines=t.landmark_range_first+"-"+t.landmark_range_last):n.grade=t.key}q("diffmany",n)}():d(i.elements["mode-gradesheet"],"btn-primary")?function(){const e=n.find(".pa-gdialog-gradesheet input"),i=[];for(let t=0;t!==e.length;++t)e[t].checked&&i.push(s.entries[e[t].name]);if(0===i.length)alert("No grades selected.");else{const e={pset:t.key,anonymous:t.anonymous?1:"",users:a()};1===i.length&&i[0].landmark_range_file&&(e.file=i[0].landmark_range_file,e.lines=i[0].landmark_range_first+"-"+i[0].landmark_range_last),e.grade=i[0].key;for(let t=1;t!==i.length;++t)e.grade+=" "+i[t].key;q("diffmany",e)}}():function(){if("copyemails"===(i.elements.report.value||"default")){const t=[];for(const n of e){let e="";null!=n.first&&null!=n.last?e=n.first.concat(" ",n.last):null!=n.first?e=n.first:null!=n.last&&(e=n.last),""!==e&&/^[-A-Z a-z]*$/.test(e)?t.push(e.concat(" <",n.email,">")):""!==e?(e=e.replace(/"/g,'\\"'),t.push('"'.concat(e,'" <',n.email,">"))):t.push(n.email)}navigator.clipboard.writeText(t.join(", ")),n.close()}else q("report",{pset:t.key,anonymous:t.anonymous?1:"",users:a(),report:i.elements.report.value||"default"})}()}function o(t){"Return"===t.key||"Enter"===t.key?(r(),t.stopImmediatePropagation(),t.preventDefault()):"Esc"!==t.key&&"Escape"!==t.key||(t.stopImmediatePropagation(),t.preventDefault(),n.close())}function l(){const e=n.find(".pa-gdialog-diff")[0];if(!e.firstChild){const n=[];n.push(S("label","checki",S("span","checkc",S("input",{type:"radio",name:"diff",value:"all",checked:!0})),S("strong",null,"Full diffs")));let i=" mt-2";for(const e of t.diff_files)n.push(S("label","checki"+i,S("span","checkc",S("input",{type:"radio",name:"diff",value:"file:"+e})),e)),i="";i=" mt-2";for(const t of s.order){const e=s.entries[t];e.collate&&(n.push(S("label","checki"+i,S("span","checkc",S("input",{type:"radio",name:"diff",value:"grade:"+e.key})),e.title_node)),i="")}if(!t.gitless){const t=S("input",{type:"text",name:"otherdiff",size:"30",class:"ml-2"});n.push(S("label","checki mt-2",S("span","checkc",S("input",{type:"radio",name:"diff",value:"other"})),"Diffs in ",t)),t.addEventListener("input",function(){this.closest("label").querySelector("input[type=radio]").click()})}e.replaceChildren(...n)}n.find(".pa-gdialog-tab").addClass("hidden"),e.classList.remove("hidden"),i.elements.bsubmit.textContent="Show diffs"}n=Gn({className:"modal-dialog-wide"}).append(S("h2","pa-home-pset",t.title+" Diffs"),S("h3","gdialog-userids hidden"),S("div","pa-messages"),S("div","nav-pills",S("button",{type:"button",class:"btn btn-primary no-focus is-mode",name:"mode-diff"},"Diff"),S("button",{type:"button",class:"btn no-focus is-mode",name:"mode-gradesheet"},"Gradesheet"),S("button",{type:"button",class:"btn no-focus is-mode",name:"mode-report"},"Reports")),S("div","pa-gdialog-tab pa-gdialog-diff is-modal"),S("div","pa-gdialog-tab pa-gdialog-gradesheet multicol-3 hidden"),S("div","pa-gdialog-tab pa-gdialog-report hidden")).append_actions(S("button",{type:"button",name:"bsubmit",class:"btn-primary"},"Save"),"Cancel"),i=n.form(),h(i,"pa-psetinfo"),i.pa__gradesheet=t.gradesheet,l(),n.on("click",".pa-gdialog-section",ri),n.on("keydown",o),n.on("keydown","input, textarea, select",o),$(i.elements.bsubmit).on("click",r),n.find("button.is-mode").on("click",function(){n.find(".nav-pills button").removeClass("btn-primary"),"mode-report"===this.name?function(){const e=n.find(".pa-gdialog-report")[0];if(!e.firstChild){const n=[];n.push(S("label","checki",S("span","checkc",S("input",{type:"radio",name:"report",value:"default",checked:!0})),"Grades")),n.push(S("label","checki",S("span","checkc",S("input",{type:"radio",name:"report",value:"nameemail"})),"Name and email")),t.gitless||(n.push(S("label","checki",S("span","checkc",S("input",{type:"radio",name:"report",value:"git"})),"Git information")),n.push(S("label","checki",S("span","checkc",S("input",{type:"radio",name:"report",value:"githistory"})),"Git history")));for(const e of t.reports)n.push(S("label","checki",S("span","checkc",S("input",{type:"radio",name:"report",value:e.key})),e.title));n.push(S("label","checki",S("span","checkc",S("input",{type:"radio",name:"report",value:"copyemails"})),"Copy emails to clipboard")),e.replaceChildren(...n)}n.find(".pa-gdialog-tab").addClass("hidden"),e.classList.remove("hidden"),i.elements.bsubmit.textContent="Download"}():"mode-gradesheet"===this.name?function(){const t=n.find(".pa-gdialog-gradesheet")[0];if(!t.firstChild){const e=[];let n=!1;for(const t of s.order){const i=s.entries[t],a=n&&"section"!==i.type?"checki ml-4":"checki",r="section"===i.type?" pa-gdialog-section":"";e.push(S("label",a,S("span","checkc",S("input",{type:"checkbox",name:i.key,class:"uic js-rage-click"+r,"data-range-type":"mge"})),i.title_node)),n=n||"section"===i.type}t.replaceChildren(...e)}n.find(".pa-gdialog-tab").addClass("hidden"),t.classList.remove("hidden"),i.elements.bsubmit.textContent="Edit gradesheet"}():l(),this.classList.add("btn-primary")}),n.show()}(e,e.users_in(t,e.SOME_USERS))}),v.on("js-ptable-run",function(){let t,e,n,i=this.closest("form"),s=i.pa__ptconf;function a(){if(e.elements.runner.value){const t=e.elements.runner.value+(e.elements.ifneeded.checked?".ifneeded":""),i=[],a={pset:s.key,run:t,runmany:1},r={};for(const t of n)i.push(s.ukey(t));const o=i.join(" ");o.length<=160?a.users=o:r.users=o,e.elements.selectcommits.checked&&(a.commitq=e.elements.commitq.value),function(t,e,n){const i=document.createElement("form");i.setAttribute("method","post"),i.setAttribute("enctype","multipart/form-data"),i.setAttribute("accept-charset","UTF-8"),i.action=I("=run",e),n=n||{____empty____:1};for(let t in n){const e=document.createElement("input");e.type="hidden",e.name=t,e.value=n[t],i.appendChild(e)}document.body.appendChild(i),i.submit()}(0,a,r)}else t.close()}!function(){n=s.users_in(i,s.SOME_USERS);const r=S("div","mt-1 multicol-2");for(let t in s.runners)r.append(S("label","checki",S("span","checkc",S("input",{type:"radio",name:"runner",value:t})),s.runners[t]));t=Gn().append(S("h2","pa-home-pset",s.title+" Commands"),S("h3","gdialog-userids"),S("div","pa-messages"),r,S("label","checki mt-2",S("span","checkc",S("input",{type:"checkbox",name:"ifneeded"})),"Use prerecorded runs when available"),S("label","checki mt-2 has-fold foldc",S("span","checkc",S("input",{type:"checkbox",name:"selectcommits",class:"uic js-foldup","data-fold-target":"#U"})),"Select commits",S("span","fx",": ",S("input",{type:"text",name:"commitq",placeholder:"grading",class:"ml-1"})))).append_actions(S("button",{type:"button",name:"run",class:"btn-primary"},"Run"),"Cancel"),s.render_gdialog_users(t.querySelector("h3"),n),e=t.form(),$(e.elements.run).on("click",a),t.show()}()}),v.on("pa-cluster-diff",function(){const t=We.closest(this),e=this.closest(".pa-psetinfo"),n=this.getAttribute("data-pa-grade");if(!t||!e||!n)return;const i=t.xentry(n);if(!i)return;const s=[];let a=0,r=!1,o=null;for(let t=e.firstElementChild;t;t=t.nextElementSibling){if(!d(t,"pa-psetinfo")){s.length||(o=t);continue}const e=We.closest(t),n=+t.getAttribute("data-pa-index");s.push({element:t,value:i.value_in(e),index:n,sorted:!1}),a=Math.max(a,n),r=r||0===n}if(r)for(const t of s)0===t.index&&(++a,t.index=a,t.element.setAttribute("data-pa-index",a));let l=this.getAttribute("data-pa-clustering"),c="";const u=l.indexOf(":");u>=0&&(c=l.substring(u+1),l=l.substring(0,u)),"none"===l?function(t){const e=new Intl.Collator("en-US",{numeric:!0});t.sort((t,n)=>{const i=t.element.id,s=n.element.id;return i&&s?e.compare(i,s):t.index-n.index})}(s):"multiple-choice"===l?function(t,e){let n=null;if(e&&/^[A-Z]$/.test(e)){n={};for(let t="A";t<=e;t=String.fromCharCode(t.charCodeAt(0)+1))n[t]=!0}else if(e&&/^\d+$/.test(e)){n={};for(let t=1;t<=+e;++t)n[t]=!0}else if(e&&/^[-\d,]+$/.test(e)){n={};for(const t of e.split(/,/)){const e=t.indexOf("-");if(e>0){const i=+t.substring(e+1);for(let s=+t.substring(0,e);s<=i;++s)n[s]=!0}else t&&(n[+t]=!0)}}for(const e of t)e.multiple_choice=oi(e.value,n);t.sort((t,e)=>{const n=t.multiple_choice,i=e.multiple_choice;return n!==i?n<i?-1:1:t.index<e.index?-1:1})}(s,c):function(t){t.sort((t,e)=>{const n=(t.value||"").length,i=(e.value||"").length;return n!==i?n<i?1:-1:t.index<e.index?-1:1})}(s),o=o.nextElementSibling;for(const t of s)t.element!==o?e.insertBefore(t.element,o):o=o.nextElementSibling});const li=new WeakMap;let ci,ui,di,hi,pi;function fi(){p(this,"pinnable");let t=this;if("CODE"===t.tagName&&"PRE"===t.parentElement.tagName&&(t=t.parentElement),!t.closest(".pa-gsection"))return;const e=S("div","pa-pinnable");for(const t of this.attributes)("title"===t.name||t.name.startsWith("data-pa-"))&&e.setAttribute(t.name,t.value);t.parentElement.replaceChild(e,t),e.append(t,S("button",{type:"button",class:"ui pa-pinnable-pin"},""))}function mi(t){ci=this,ui=ci.getBoundingClientRect(),di=t.clientX,hi=t.clientY,t.dataTransfer.dropEffect="move",t.dataTransfer.effectAllowed="move",t.dataTransfer.setData("application/x-pa-dragging-pinnable","N/A"),t.dataTransfer.setDragImage(this,di-ui.x,hi-ui.y),document.body.addEventListener("dragover",gi),document.body.addEventListener("drop",bi)}function gi(t){t.preventDefault()}function bi(t){ci.style.left=t.clientX-di+ui.x+"px",ci.style.top=t.clientY-hi+ui.y+"px"}function _i(){document.body.removeEventListener("dragover",gi),document.body.removeEventListener("drop",bi)}function vi(t){ci=this.parentElement,pi=this.getAttribute("data-pa-resize"),ui=ci.getBoundingClientRect(),di=t.clientX,hi=t.clientY,t.dataTransfer.dropEffect="move",t.dataTransfer.effectAllowed="move",t.dataTransfer.setData("application/x-pa-dragging-pinnable","N/A"),t.dataTransfer.setDragImage(this,di-ui.x,hi-ui.y),document.body.addEventListener("dragover",yi),t.stopImmediatePropagation()}function yi(t){if(t.preventDefault(),"l"===pi){const e=Math.min(ui.x+t.clientX-di,ui.right-20);ci.style.left=e+"px",ci.style.width=ui.right-e+"px"}else if("r"===pi){const e=Math.max(ui.right+t.clientX-di,ui.x+20);ci.style.width=e-ui.x+"px"}else if("t"===pi){const e=Math.min(ui.y+t.clientY-hi,ui.bottom-40);ci.style.top=e+"px",ci.style.height=ui.bottom-e+"px"}else if("b"===pi){const e=Math.max(ui.bottom+t.clientY-hi,ui.y+40);ci.style.height=e-ui.y+"px"}}function xi(){document.body.removeEventListener("dragover",yi)}function wi(t){p(t,"pinned");const e=li.get(t);e&&(e.style.opacity=""),t.closest(".pa-pinnable-fixed").remove(),li.delete(t)}v.on("pa-pinnable-pin",function(){const t=this.parentElement;if(d(t,"pinned"))return void wi(t);const e=t.cloneNode(!0);h(e,"pinned");for(const t of e.querySelectorAll("img"))t.draggable=!1;let n=t.parentElement,i=n,s=S("div","pa-pinned",e);for(;!d(n,"pa-gsection");){for(let t of n.classList)"pa-pdesc"===t||"pa-dr"===t||t.startsWith("format")?h(s,t):"pa-grade"===t&&(i=n);n=n.parentElement}const a=t.getBoundingClientRect();s.style.position="fixed",s.style.top=a.y+"px",s.style.left=a.x+"px",s.style.width=a.width+"px",s.style.height=a.height+"px",s.draggable=!0,s.addEventListener("dragstart",mi),s.addEventListener("dragend",_i),s.addEventListener("dblclick",()=>wi(e)),h(s,"pa-pinnable-fixed"),n.appendChild(s),t.style.opacity=.2,li.set(e,t);let r="";if(n.hasAttribute("data-pa-grade")){const e=We.closest(t),s=e?e.xentry(n.getAttribute("data-pa-grade")):null,a=e&&i!==n?e.xentry(i.getAttribute("data-pa-grade")):null;s&&s.title&&(r=s.title.replace(/\s*\([\d.]+ points?\)\s*$/,"")),a&&a.title&&!t.getAttribute("title")&&(r+=(r?"  ":"")+a.title.replace(/\s*\([\d.]+ points?\)\s*$/,""))}if(t.getAttribute("title")&&(r+=(r?"  ":"")+t.getAttribute("title")),""!==r){const t=S("div","pa-pinnable-title");Ht(t,"f",r),s.append(t);const e=t.getBoundingClientRect();s.style.height=a.height+e.height+"px"}for(const t of["l","r","t","b"]){const e=S("div","pa-pinnable-resize-"+t);e.setAttribute("data-pa-resize",t),e.draggable=!0,s.append(e),e.addEventListener("dragstart",vi),e.addEventListener("dragend",xi)}});class ki{type;precedence;flags;subtype;constructor(t,e,n,i){this.type=t,this.precedence=e,this.flags=n,this.subtype=i}static get UNARY(){return 1}static get ALLOW_SUBTYPE(){return 2}static get SUBTYPE(){return 4}static get UNNAMED(){return 8}static get NOT(){return 16}static get AND(){return 32}static get OR(){return 64}static get XOR(){return 128}get unary(){return!!(1&this.flags)}get allow_subtype(){return!!(4&this.flags)}make_subtype(t){return new ki(this.type,this.precedence,-3&this.flags|4,t)}}const Ci=/[\s()[\]{}]/y;class Ai{#d;#h;static#p;constructor(t){this.#d=null!=t?t:{},this.#h=null}define(t,e){this.#d[t]=e,this.#h=null}lookup(t){const e=this.#d[t];if(e)return e;const n=t.indexOf(":");if(n<0)return null;const i=this.#d[t.substring(0,n)];if(!i||!i.allow_subtype)return null;const s=i.make_subtype(t.substring(n+1));return this.#d[t]=s,s}get regex(){if(null!==this.#h)return this.#h;let t="";const e=[],n=[];for(const[i,s]of Object.entries(this.#d))if(!(12&s.flags))if(/^[-!"#$%&'()*+,./:;<=>?@[\\\]^_`{|}~]+$/.test(i))1===i.length?t+=ct(i,!0):e.push(ct(i));else{let t=ct(i);s.allow_subtype&&(t+="(?::\\w+)?"),n.push(t)}return""!==t&&e.push("["+t+"]"),0!==n.length&&e.push("(?:"+n.join("|")+")(?=[\\s\\(\\)\\[\\]\\{\\}]|$)"),this.#h=new RegExp(e.join("|"),"y"),this.#h}static safe_terminator(t,e=0){return Ci.lastIndex=e,Ci.test(t)}static get simple_operators(){if(null!=this.#p)return this.#p;const t=new ki("not",8,17),e=new ki("space",7,40),n=new ki("and",6,32),i=new ki("xor",5,128),s=new ki("or",4,64);return this.#p=new Ai({"(":new ki("(",0,33),")":new ki(")",0,1),NOT:t,"-":t,"!":t,SPACE:e,AND:n,"&&":n,XOR:i,"^^":i,OR:s,"||":s}),this.#p}static simple_operator(t){return this.simple_operators.#d[t]}}class Ei{kword;text;info;kwpos1;pos1;pos2;op;child;parent;empty;static make_simple(t,e,n=null){const i=new Ei;return i.text=t,i.kwpos1=i.pos1=e,i.pos2=e+t.length,i.parent=n,i.empty=""===t,i}static make_keyword(t,e,n,i,s,a=null){const r=new Ei;return r.kword=""===t?null:t,r.text=e,r.kwpos1=n,r.pos1=i,r.pos2=s,r.parent=a,r.empty=null===r.kword&&""===e,r}static make_op_start(t,e,n,i){const s=new Ei;return s.op=t,t.unary?(s.kwpos1=s.pos1=e,s.pos2=n,s.child=[],s.parent=i,s.empty=!0):(s.kwpos1=s.pos1=i.pos1,s.pos2=n,s.child=[i],s.parent=i.parent,s.empty=i.empty),s}static combine(t,...e){const n=new Ei;n.op=Ai.simple_operator(t),n.child=e,n.empty=!0;for(const t of e)if(!t.empty){n.empty=!1;break}return n}get is_complete(){return!this.op||this.child.length>(this.op.unary?0:1)}get is_incomplete_paren(){return this.op&&"("===this.op.type&&0===this.child.length}unquoted_text(){return Ni.unquote(this.text)}complete(t){this.is_complete||(this.pos2=t,this.child.push(Ei.make_simple("",t)));const e=this.parent;return e?(e.child.push(this),e.pos2=this.pos2,e.empty=e.empty&&this.empty,e):this}complete_paren(t,e){let n=this,i=n.op&&"("===n.op.type&&0===n.child.length;for(;!n.op||"("!==n.op.type||i;)n=n.complete(t),i=!1;return n.pos2=e,0===n.child.length&&n.child.push(Ei.make_simple("",e)),n}flattened_children(){if(!this.op||this.op.unary)return this.child||[];const t=[];for(const e of this.child)e.op&&e.op.type===this.op.type&&e.op.subtype===this.op.subtype?Array.push.prototype.apply(t,...e.flattened_children()):e.empty||t.push(e);return t}unparse(t,e=""){let n;if(!this.op)return n=this.kword?`${this.kword}:${this.text}`:this.text,n.length>40&&(n=n.substring(0,32)+"..."),`${e}@${this.kwpos1} ${n}`;n=t?this.pos2-this.kwpos1>40?t.substring(this.kwpos1,this.kwpos1+16)+"..."+t.substring(this.pos2-16,this.pos2):t.substring(this.kwpos1,this.pos2):"",""!==n&&(n=` <<${n}>>`);const i=[`${e}[[${this.op.type}]] @${this.kwpos1}${n}\n`],s=e+"  ";for(const e of this.child)i.push(e.unparse(t,s));return i.join("")}prepare_simple(t,...e){if(this.op)for(const n of this.child)n.prepare_simple(t,...e);else t(this,...e)}evaluate_simple(t){let e;if(this.op)if(32&this.op.flags){e=!0;for(const n of this.child)e=e&&(n.empty||n.evaluate_simple(t))}else if(64&this.op.flags){e=!1;for(const n of this.child)e=e||!n.empty&&n.evaluate_simple(t)}else if(128&this.op.flags){e=!1;for(const n of this.child)!n.empty&&n.evaluate_simple(t)&&(e=!e)}else{if(!(16&this.op.flags))throw new Error("unknown operator");{const n=this.child[0];e=!n||n.empty||!n.evaluate_simple(t)}}else e=t(this);return e}}const $i=/\s+/y,Si=/[_a-zA-Z0-9][-_.a-zA-Z0-9]*(?=:)/y;class Ni{#f;pos;#m;last_pos=0;constructor(t,e=0,n=null){this.#f=t,this.pos=e,this.#m=null!=n?n:t.length,!(this.#m<t.length)||Ai.safe_terminator(t,this.#m)||0!==this.#m&&Ai.safe_terminator(t,this.#m-1)||(this.#f=t.substring(0,this.#m)),this.#g(0)}empty(){return this.pos>=this.#m}rest(){return this.#f.substring(this.pos,this.#m)}set_pos(t){return this.pos=this.last_pos=t,this}#g(t){this.last_pos=this.pos=Math.min(this.pos+t,this.#m),$i.lastIndex=this.pos,$i.test(this.#f)&&(this.pos=Math.min($i.lastIndex,this.#m))}shift_keyword(){if(Si.lastIndex=this.pos,!Si.test(this.#f)||Si.lastIndex>=this.#m)return"";const t=this.#f.substring(this.pos,Si.lastIndex);return this.#g(t.length+1),t}shift_past(t){this.#g(t.length)}skip_whitespace(){return this.#g(0),this.pos<this.#m}shift_balanced_parens(t=null,e=!1){const n=this.pos,i=Ni.span_balanced_parens(this.#f,n,t,e);return this.#g(i-n),this.#f.substring(n,this.last_pos)}match(t){return t.lastIndex=this.pos,t.exec(this.#f)}test(t){return t.lastIndex=this.pos,t.test(this.#f)?t.lastIndex:-1}starts_with(t){const e=this.pos+t.length;return e<=this.#m&&this.#f.substring(this.pos,e)===t}#b(t){const e=this.pos,n=this.test(t.regex);return n<0||n>this.#m?null:(this.#g(n-e),t.lookup(this.#f.substring(e,n)))}static span_balanced_parens(t,e=0,n=null,i=!1){n=null!=n?n:" \n\r\t\v\f";let s="",a="",r=0,o=i?-1:e,l=t.length;for(;e<l;){let i=t.charAt(e);if(""===a&&!r&&""!==n&&n.indexOf(i)>=0)break;if(""!==i&&""!==i||(i='"'),r)"\\"===i&&e+1<l?++e:'"'===i&&(r=0);else if("("===i)s+=a,a=")";else if("["===i)s+=a,a="]";else if("{"===i)s+=a,a="}";else if(")"===i||"]"===i||"}"===i)if(e===o)++o;else{let t;do{t=a;const e=s.length-1;e>=0?(a=s.substring(e),s=s.substring(0,e)):a=s=""}while(i!==t&&""!==t);if(""===t)break}else'"'===i&&(r=1);++e}return e}static split_balanced_parens(t){const e=[];if(""!==t){const n=new Ni(t);for(;n.skip_whitespace();)e.push(n.shift_balanced_parens())}return e}parse_expression(t=null,e="SPACE",n=2048){t=null!=t?t:Ai.simple_operators;let i=null,s=0,a=0;for(;!this.empty();){let r=this.pos,o=this.#b(t),l=this.last_pos;if(!(o||i&&i.is_complete)){const t=this.pos,e=this.shift_keyword();r=this.pos;const n=this.shift_balanced_parens(null,!0);l=this.last_pos,i=Ei.make_keyword(e,n,t,r,l,i);continue}if(o&&")"===o.type){if(0===s)continue;i=i.complete_paren(r,l),--s}else{if((!o||o&&o.unary&&i&&i.is_complete)&&(o=t.lookup(s>0?"SPACE":e),this.set_pos(r),l=r),!o.unary)for(i&&!i.is_incomplete_paren||(i=Ei.make_simple("",r,i));i.parent&&i.parent.op.precedence>=o.precedence;)i=i.complete(r);if(a>=n)return null;i=Ei.make_op_start(o,r,l,i),"("===o.type&&++s,++a}}if(i){let t;for(;(t=i.complete(this.last_pos))!==i;)i=t}return i}static unquote(t){return t.startsWith('"')?(t=t.substring(1,t.length-(t.endsWith('"')&&t.length>1?1:0))).replace(/\\([\\"])/g,"$1"):t}}function Di(t,e){return null!=t.first&&null!=t.last?e?t.last.concat(", ",t.first):t.first.concat(" ",t.last):null!=t.first?t.first:null!=t.last?t.last:""}function Fi(t){return t.__nickname||(t.nick?t.__nickname=t.nick:t.nicklen||t.lastpos?t.__nickname=t.name.substr(0,t.nicklen||t.lastpos-1):t.__nickname=t.name),t.__nickname}function Mi(t){return t?"number"==typeof t?t>=1&&t<=20&&Math.floor(t)===t?String.fromCharCode(9311+t):t.toString():1===t.length&&t>="A"&&t<="Z"?String.fromCharCode(9333+t.charCodeAt(0)):t:""}function Ti(t,e){return t._sort_user.localeCompare(e._sort_user)}function Li(t,e){const n=t.gradercid?siteinfo.pc[t.gradercid]:null,i=e.gradercid?siteinfo.pc[e.gradercid]:null,s=n&&Fi(n)||"~~~",a=i&&Fi(i)||"~~~";return s!=a?s<a?-1:1:0}function ji(t){const e=document.createElement("strong");return e.className="err",e.append(t),e}function Oi(t){"A"===t.target.tagName&&t.target.classList.contains("pa-user")&&("mouseenter"===t.type?At.enter(t.target,"pa-ptable-user"):At.leave(t.target))}class zi{id;key;title;gitless;gitless_grades;has_older_repo;disabled;visible;scores_visible;frozen;anonymous;has_nonanonymous;overridable_anonymous;flagged_commits;sort;no_sort;checkbox;grades;need_total;total_key;runners;diff_files;reports;requested_columns;col;pincol;colmap;data;mode;smap;uidmap;input_timeout;has_hidden;constructor(t,e){this.id=t.id,this.key=t.key,this.title=t.title,this.gitless=!!t.gitless,this.gitless_grades=!!t.gitless_grades,this.has_older_repo=!!t.has_older_repo,this.disabled=!!t.disabled,this.visible=!!t.visible,this.scores_visible=!!t.scores_visible,this.frozen=!!t.frozen,this.anonymous=this.original_anonymous=!!t.anonymous,this.has_nonanonymous=!this.anonymous||t.has_nonanonymous,this.overridable_anonymous=this.anonymous&&t.overridable_anonymous,this.flagged_commits=t.flagged_commits,this.sort={f:this.flagged_commits?"at":"name",last:!1,rev:1,u:"name"},this.no_sort=t.no_sort,this.checkbox=!!t.checkbox,this.grades=t.grades,this.need_total=!!t.need_total,this.total_key=t.total_key,this.runners=t.runners||[],this.diff_files=t.diff_files||[],this.reports=t.reports||[],this.requested_columns=t.col||null,this.col=[],this.pincol=[],this.colmap={},this.data=e,this.mode=0,this.smap=[null],this.uidmap=[],this.has_hidden=!1,this.input_timeout=null}set_gradesheet(t){this.gradesheet=t,this.in_total_indexes=[],this.answer_indexes=[];for(let e=0;e!==t.value_order.length;++e){const n=t.entries[t.value_order[e]];n.answer?this.answer_indexes.push(e):n.in_total&&n.key!==this.total_key&&this.in_total_indexes.push(e)}}add_column(t){t.index=this.col.length,this.col.push(t),this.colmap[t.name]=this.colmap[t.name]||t,t.pin&&(t.pin_index=this.pincol.length,this.pincol.push(t))}get columns(){return this.col}get pinned_columns(){return this.pincol}columns_in(t){return t.classList.contains("gtable-left-pin")?this.pincol:this.col}column_index_in(t,e){const n=this.colmap[t];if(!n)return-1;const i=e.classList.contains("gtable-left-pin")?"pin_index":"index";return null!=n[i]?n[i]:-1}ukey(t){return this.anonymous&&t.anon_user||t.user||""}url_gradeparts(t){const e={u:this.ukey(t),pset:this.key};let n;return t.pset&&(n=siteinfo.psets[t.pset])&&(e.pset=n.urlkey),!t.commit||t.is_grade&&!this.flagged_commits?t.grade_commit&&(e.commit=t.grade_commit,e.commit_is_grade=1):e.commit=t.commit,e}href(t){return I("pset",this.url_gradeparts(t))}make_student_ae(t){const e=document.createElement("a");return e.href=I("index",{u:this.ukey(t)}),e.className="track",e}make_pset_ae(t){const e=document.createElement("a");return e.href=this.href(t),e.className="pa-user track"+(t.dropped?" gt-dropped":""),e}render_username_td(t,e){const n=this.make_pset_ae(e);this.anonymous&&e.anon_user?n.append(e.anon_user):this.sort.email&&e.email?n.append(e.email):e.user&&n.append(e.user),t.replaceChildren(n)}render_user_td(t,e){const n=this.make_pset_ae(e),i=this.sort;this.anonymous&&e.anon_user?n.append(e.anon_user):"email"===i.u&&e.email?n.append(e.email):"name"===i.u?n.append(Di(e,i.last)||e.email):n.append(e.user),t.replaceChildren(n)}render_display_name(t,e,n){const i=n&&this.anonymous?e.anon_user||"?":Di(e,this.sort.last)||e.email;if(n){const n=this.make_pset_ae(e);n.textContent=i,t.replaceChildren(n)}else t.replaceChildren(i)}render_tooltip_name(t){return t?this.anonymous&&t.anon_user?t.anon_user:"email"===this.sort.u&&t.email?t.email:"name"===this.sort.u?Di(t,!1)||t.email:t.user:"???"}render_checkbox_name(t){let e=this.anonymous&&t.anon_user||t.user;return"s:"+encodeURIComponent(e).replace(/\./g,"%2E")}render_table_row(t,e){this.mode=e;const n=document.createElement("tr");n.className="gt",n.setAttribute("data-pa-spos",t._spos),t.uid&&n.setAttribute("data-pa-uid",t.uid),2&e&&n.classList.add("kfade"),1&e&&(n.classList.add("gtrow-partner"),n.setAttribute("data-pa-partner",1));const i=2&e?this.pincol:this.col;for(const e of i){const i=document.createElement("td");e.td.call(e,i,t),n.appendChild(i)}return n}tbody_rowmap(t){if(t.pa__rowmap)return t.pa__rowmap;const e=t.pa__rowmap={rows:[],users:new WeakMap};e.rows.length=this.smap.length,e.rows.fill(null);for(let n=t.firstChild;n;n=n.nextSibling){const t=n.getAttribute("data-pa-spos");t&&(e.rows[+t]=n,e.users.set(n,this.smap[t]))}return e}render_gdialog_users(t,e){if(e.length===this.data.length||0===e.length)h(t,"hidden");else{p(t,"hidden");let n=0,i=[],s=20===e.length?20:19;for(;n<s&&n<e.length;)i.push(this.render_tooltip_name(e[n])),++n;n<e.length&&i.push("(".concat(e.length-n," more)")),t.replaceChildren(i.join(", "))}}push(t){t._spos=this.smap.length,t.hidden=!1,this.smap.push(t),t.uid>0&&(t.uid>=this.uidmap.length&&(this.uidmap.length=t.uid+1),this.uidmap[t.uid]=t)}user_row_checkbox(t){const e=d(t.parentElement.parentElement,"gtable-left-pin"),n=this.colmap.checkbox[e?"pin_index":"index"];return null!=n?t.children[n].firstChild:null}get ALL_USERS(){return 0}get CHECKED_USERS(){return 1}get SOME_USERS(){return 2}users_in(t,e){const n=t.querySelector("table.gtable > tbody"),i=this.tbody_rowmap(n),s=this.colmap.checkbox.index,a=[],r=[];for(let t=n.firstChild;t;t=t.nextSibling){const n=i.users.get(t);n&&(a.push(n),e&&t.children[s].firstChild.checked&&r.push(n))}return 2===e?r.length>0?r:a:1===e?r:a}}function Bi(t){let e=t.target;for(;e!==this&&"TH"!==e.tagName&&"BUTTON"!==e.tagName&&"A"!==e.tagName;)e=e.parentElement;const n=function(t){if("TH"===t.tagName?!t.hasAttribute("data-pa-sort"):"BUTTON"!==t.tagName||!t.classList.contains("js-switch-anon"))return null;const e=t.closest("form").pa__ptconf,n=Object.assign({},e.sort);if("BUTTON"===t.tagName)return e.overridable_anonymous?(n.deblind?delete n.deblind:n.deblind=(new Date).getTime()/1e3,n):null;const i=t.getAttribute("data-pa-sort");if(i!==n.f){n.f=i;const t=e.colmap[i];n.rev=t&&t.sort_forward?1:-1,"name"===i?n.u="name":"name2"===i?n.u=e.anonymous?"user":"name":"email"===i?n.u="email":"username"===i&&(e.anonymous&&!e.has_nonanonymous||!n.email?n.u="user":n.u="email")}else n.rev=-n.rev,1===n.rev&&("name"===i?n.last=!n.last:e.anonymous&&!e.has_nonanonymous||("name2"===i?n.last=!n.last:"username"===i?n.email?(n.u="user",delete n.email):(n.u="email",n.email=!0):"user"===i&&("name"===n.u?(n.last=!n.last,n.last||(n.u="email")):"email"===n.u?n.u="user":n.u="name")));return n}(e);n&&e.closest("form").dispatchEvent(new CustomEvent("sortchange",{bubbles:!0,cancelable:!0,detail:{sort:n}}))}function Ii(t){let e=t.target;for(;e!==this&&"TD"!==e.tagName;)e=e.parentElement;if("TD"!==e.tagName)return;let n=0;for(let t=e.parentElement.firstChild;t!==e;t=t.nextSibling)++n;const i=e.closest("form").pa__ptconf,s=i.col[n].ge,a=e.closest("tr");!s||s.readonly||!a.hasAttribute("data-pa-spos")||t.shiftKey||t.ctrlKey||ai(i,[+a.getAttribute("data-pa-spos")],e.closest("table"),s.key)}function qi(){const t=this.closest("form").pa__ptconf,e=t.tbody_rowmap(this),n=[];for(let i=this.firstChild;i;i=i.nextElementSibling){const s=e.users.get(i);if(!s||s.hidden)continue;let a,r="~"+encodeURIComponent(t.ukey(s));t.flagged_commits&&s.pset&&(a=siteinfo.psets[s.pset])&&(r=r.concat("/pset/",a.urlkey),s.commit&&(r=r.concat("/",s.commit))),n.push(r)}event.detail.hotlist={pset:t.flagged_commits?null:t.key,items:n}}function Ri(t){let e;if(!window.IntersectionObserver||t.rows.length<=10||!(e=t.closest(".gtable-container-2")))return null;const n=e.parentElement.parentElement,i=document.createElement("table");i.className=t.className,i.classList.add("gtable-top-pin"),i.classList.remove("gtable"),i.style.width=t.style.width,i.appendChild(t.tHead.cloneNode(!0));const s=t.tHead.getBoundingClientRect(),a=n.getBoundingClientRect(),r=e.getBoundingClientRect();if(t.style.marginTop=-s.height-.5+"px",t.tHead.style.visibility="hidden",!d(n.firstChild,"gtable-container-headers")){const t=document.createElement("div");t.className="gtable-container-headers",t.style.marginLeft=r.left-a.left+"px",t.scrollLeft=e.scrollLeft,n.prepend(t),e.addEventListener("scroll",function(t){return function(){t.scrollLeft=this.scrollLeft,d(t.lastChild,"gtable-left-pin")&&(t.lastChild.style.left=this.scrollLeft+"px")}}(t),{passive:!0})}const o=n.firstChild;return d(i,"gtable-left-pin")&&(i.style.left=o.scrollLeft+"px"),o.append(i),i.tHead.addEventListener("click",Bi),i}function Pi(t,e){if(e.overridable_anonymous){const e=document.createElement("button");e.type="button",e.className="q n js-switch-anon",e.append("[anon]"),t.append(" ",e)}else if(e.original_anonymous){const e=document.createElement("span");e.className="n",e.append("[anon]"),t.append(" ",e)}}function Hi(t,e,n){const i=document.createElement("tr");let s,a=0;i.className="gtable-headrow gt k0";for(const e of t){const t=document.createElement("th");if(t.scope="col",(e.compare||e.make_compare)&&(t.className="plsortable",t.setAttribute("data-pa-sort",e.name)),e.th.call(e,t),n){let n=e.tw;"number"!=typeof n&&(n=n.call(e)),null==s&&(s=parseFloat(window.getComputedStyle(document.documentElement).fontSize)),n*=s,null==e.left&&(e.left=a),e.width=n,t.style.width=n+"px",a+=n}i.appendChild(t)}const r=document.createElement("thead");return r.append(i),r}let Wi=0,Ui=[];function Zi(){Wi=0;for(const t of Ui)p(t,"update");Ui=[]}const Ki={rownumber:{th:function(t){t.classList.add("gt-rownumber")},td:function(t){t.className="gt-rownumber"},tw:function(){return.75*Math.ceil(Math.log10(Math.max(this.ptconf.data.length,1)))}},checkbox:{th:function(t){t.classList.add("gt-checkbox");const e=document.createElement("input");e.type="checkbox",e.className="uic js-range-click is-range-group ignore-diff",e.ariaLabel="Select all",e.setAttribute("data-range-type","s61"),t.appendChild(e)},td:function(t,e){if(1&this.ptconf.mode)return;t.className="gt-checkbox";let n=document.createElement("input");n.type="checkbox",n.value=1,2&this.ptconf.mode?(n.className="uic js-range-click",n.setAttribute("data-range-type","s61o")):(n.name=this.ptconf.render_checkbox_name(e),n.className=this.className||"uic js-range-click papsel",n.setAttribute("data-range-type","s61")),t.appendChild(n)},tw:2,pin:!0},flagcheckbox:{th:function(t){t.className="gt-checkbox"},td:function(t,e){if(this.ptconf.mode)return;t.className="gt-checkbox";let n=document.createElement("input");n.type="checkbox",n.name="s:"+e._spos,n.value=1,n.className=this.className||"uic js-range-click papsel",n.setAttribute("data-range-type","s61"),t.appendChild(n)},tw:2,pin:!0},pset:{th:function(t){t.classList.add("gt-pset","l"),t.append("Pset")},td:function(t,e){t.className="gt-pset";let n=document.createElement("a");n.href=this.ptconf.href(e),n.classname="track";const i=siteinfo.psets[e.pset];n.append((i?i.urlkey:`<#${e.pset}>`)+(e.commit?"/"+e.commit.substr(0,7):"")),t.append(n)},tw:8,sort_forward:!0,compare:function(t,e){if(t.pset!=e.pset){const n=siteinfo.psets[t.pset],i=siteinfo.psets[e.pset];if(n&&i)return n.pos<i.pos?-1:1}return t.pos<e.pos?-1:1}},user:{th:function(t){let e=t.firstChild;e||(t.classList.add("gt-user","l"),t.appendChild(e=document.createElement("span")),e.className="heading",Pi(t,this.ptconf)),this.ptconf.anonymous||"user"===this.ptconf.sort.u?e.replaceChildren("Username"):"email"===this.ptconf.sort.u?e.replaceChildren("Email"):e.replaceChildren("Name")},td:function(t,e){t.className="gt-user",this.ptconf.render_user_td(t,e)},tw:14,pin:!0,sort_forward:!0,compare:!0,refreshable:2},username:{th:function(t){let e=t.firstChild;e||(t.classList.add("gt-username","l"),t.appendChild(e=document.createElement("span")),e.className="heading",Pi(t,this.ptconf)),this.ptconf.anonymous||!this.ptconf.sort.email?e.replaceChildren("Username"):e.replaceChildren("Email")},td:function(t,e){t.className="gt-username",this.ptconf.render_username_td(t,e)},tw:12,pin:!0,sort_forward:!0,compare:!0,refreshable:2},name:{th:function(t){t.classList.add("gt-name","l"),t.replaceChildren("Name")},td:function(t,e){t.className="gt-name",this.ptconf.render_display_name(t,e,!1)},tw:14,sort_forward:!0,compare:!0,refreshable:2},name2:{th:function(t){let e=t.firstChild;e||(t.classList.add("gt-name2","l"),t.appendChild(e=document.createElement("span")),e.className="heading",Pi(t,this.ptconf)),this.ptconf.anonymous?e.replaceChildren("Username"):e.replaceChildren("Name")},td:function(t,e){t.className="gt-name2",this.ptconf.render_display_name(t,e,!0)},tw:14,sort_forward:!0,compare:!0,refreshable:2},at:{th:function(t){t.classList.add("gt-at","l"),t.replaceChildren("Flagged")},td:function(t,e){t.className="gt-at",e.at&&t.append(r("%#e %b %#k:%M",e.at))},tw:8,sort_forward:!0,compare:function(t,e){return t.at!=e.at?t.at<e.at?-1:1:t.pos<e.pos?-1:1}},extension:{th:function(t){t.classList.add("gt-extension"),t.replaceChildren("X?")},td:function(t,e){t.className="gt-extension",e.x&&t.append("X")},tw:2,sort_forward:!0,compare:function(t,e){return t.x!=e.x?t.x?-1:1:Ti(t,e)}},year:{th:function(t){t.classList.add("gt-year"),t.replaceChildren("Yr")},td:function(t,e){t.className="gt-year c",t.replaceChildren(Mi(e.year))},tw:2,sort_forward:!0,compare:function(t,e){return t.year!=e.year?t.year&&e.year?typeof t.year!=typeof e.year?"number"==typeof t.year?-1:1:t.year<e.year?-1:1:t.year?-1:1:Ti(t,e)}},grader:{th:function(t){t.classList.add("gt-grader","l"),t.replaceChildren("Grader")},td:function(t,e){t.className="gt-grader",e.gradercid&&siteinfo.pc[e.gradercid]?t.replaceChildren(Fi(siteinfo.pc[e.gradercid])):e.gradercid&&t.replaceChildren("???")},tw:6,sort_forward:!0,compare:function(t,e){return Li(t,e)||Ti(t,e)},refreshable:2},latehours:{th:function(t){t.classList.add("gt-latehours","r"),t.title="Late",t.replaceChildren("")},td:function(t,e){t.className="gt-latehours r",t.replaceChildren(e.late_hours||"")},tw:2.5,compare:function(t,e){return t.late_hours!=e.late_hours?(t.late_hours||0)-(e.late_hours||0):Ti(t,e)},refreshable:1},notes:{th:function(t){t.classList.add("gt-notes"),t.replaceChildren("")},td:function(t,e){t.className="gt-notes c";let n=e.scores_visible?"":"";e.grade_commit&&e.grade_commit===e.commit&&this.ptconf.flagged_commits&&(n+="G"),e.grade_status<0&&(n+=""),e.has_notes&&(n+=""),e.has_nongrader_notes&&!this.ptconf.flagged_commits&&(n+="+"),t.replaceChildren(n)},tw:2,refreshable:1},total:{th:function(t){t.classList.add("gt-total","r"),t.replaceChildren("Tot")},td:function(t,e){t.className="gt-total r",t.replaceChildren(null!=e.total?e.total+"":"")},compare:function(t,e){if(null==t.total||null==e.total){if(null!=t.total)return 1;if(null!=e.total)return-1}else if(t.total!=e.total)return t.total<e.total?-1:1;return-Ti(t,e)},tw:3.5,refreshable:1},grade:{th:function(t){t.classList.add(...this.className.split(/\s+/)),t.title=this.ge.title_text,t.replaceChildren(this.ge.abbr())},td:function(t,e,n){const i=e.grades[this.gidx];var s;t.className=this.className,e.autogrades&&null!=e.autogrades[this.gidx]&&e.autogrades[this.gidx]!==i&&(t.className+=" gt-highlight"),n&&n.oldgrades&&n.oldgrades[this.gidx]!==i&&(t.className+=" update",s=t,1===++Wi&&setTimeout(Zi,0),Ui.push(s)),t.replaceChildren(this.ge.tcell(i))},tw:function(){const t=.5*this.ge.abbr().length+1.5;return Math.max(t,this.ge.tcell_width())},refreshable:1},ngrades:{th:function(t){t.classList.add("gt-ngrades","r"),t.replaceChildren("#G")},td:function(t,e){t.className="gt-ngrades r",t.replaceChildren(e.ngrades?e.ngrades+"":"")},tw:2,sort_forward:!0,compare:function(t,e){return t.ngrades!==e.ngrades?t.ngrades<e.ngrades?-1:1:-Ti(t,e)},refreshable:1},repo:{th:function(){},td:function(t,e){if(t.className="gt-repo",!e.repo)return;const n=document.createElement("a");this.ptconf.anonymous?(n.className="ui pa-anonymized-link",n.href="",n.setAttribute("data-pa-link",e.repo)):(n.className="track",n.href=e.repo),n.append("repo"),t.replaceChildren(n),e.repo_broken&&t.append(" ",ji("broken")),e.repo_unconfirmed&&t.append(" ",ji("unconfirmed")),e.repo_too_open&&t.append(" ",ji("open")),e.repo_handout_old&&t.append(" ",ji("handout")),e.repo_partner_error&&t.append(" ",ji("partner")),e.repo_sharing&&t.append(" ",ji("sharing"))},tw:10},conversation:{th:function(t){t.classList.add("gt-conversation","l"),t.replaceChildren("Flag")},td:function(t,e){t.className="gt-conversation l",e.conversation?t.append(e.conversation):e.conversation_pfx&&t.append(e.conversation_pfx+"")},compare:function(t,e){const n=t.conversation||t.conversation_pfx||"",i=e.conversation||e.conversation_pfx||"";return""===n||""===i?n===i?0:""===n?1:-1:n.localeCompare(i)},sort_forward:!0,tw:20}};function Yi(t,e,n){const i=[];for(let s=0;s!==e.length;++s){const a=e[s],r=t.column_index_in(n,a);r>=0&&i.push({table:a,index:r})}return i}function Ji(t,e,...n){for(const i of n){const n=t.colmap[i];for(const s of Yi(t,e,i)){const e=s.table,i=s.index;if(e.tBodies.length>0)for(let s=e.tBodies[0].firstChild;s;s=s.nextSibling){const e=s.getAttribute("data-pa-spos");if(e){const a=t.smap[e],r=s.children[i];n.td.call(n,r,a)}}n.th.call(n,e.tHead.firstChild.children[i])}}}function Xi(t){"s61"===t.detail.rangeType&&$(this).find(".js-gdialog").prop("disabled",!t.detail.newState)}function Vi(t){const e=document.createElement("tr");e.className="gt-boring";const n=document.createElement("td");return n.colSpan=t.rows[0].childNodes.length,n.appendChild(document.createElement("hr")),e.appendChild(n),e}function Gi(t,e,n){const i=e.tBodies[0],s=e.classList.contains("gtable-left-pin")?2:0,a=["k0","k1"],r=i.firstChild&&t.tbody_rowmap(i);let o=!1,l=1,c=i.firstChild;for(const u of n){for(u.boringness!==o&&!1!==o&&(c&&"gt-boring"===c.className?c=c.nextSibling:i.insertBefore(Vi(e),c)),o=u.boringness;c&&"gt-boring"===c.className;){const t=c;c=c.nextSibling,i.removeChild(t)}let n=!1;for(const e of u.partners?[u,...u.partners]:[u]){let o;r&&(o=r.rows[e._spos])||(o=t.render_table_row(e,u===e?s:1|s),r&&(r.rows[e._spos]=o,r.users.set(o,e))),o!==c?i.insertBefore(o,c):c=c.nextSibling,o.classList.remove(a[1&(1^l)]),o.classList.add(a[1&l]),o.hidden=e.hidden,n=n||!o.hidden}n&&++l}}function Qi(n){const i=this,s=$(i);let a,r,o,l=$(i),c=null,u=null,m=null,g=null,b=-1,_=n.data;function v(){for(var t=[],e=0;e!==_.length;++e)t.push(n.ukey(_[e]));a.value=t.join(" ")}function y(){const t=o.rownumber.index;let e=0;for(let n=i.tBodies[0].firstChild;n;n=n.nextSibling)d(n,"gt")&&!n.hidden&&(++e,n.children.item(t).textContent=e+".")}function x(t){let n="";return 8&b&&t.anon_user?n=t.anon_user+" ":1&b&&(n=Di(t,!(2&~b))+" "),4&b&&t.email?n+=t.email:n+=t.user||"",null!=t.pset&&(n+=e(" %5s",t.pset)),null!=t.at&&(n+=e(" %.11g",t.at)),n.toLowerCase()}function w(){let t=n.sort.f;!function(){const t=n.anonymous?8:"name"===n.sort.u?1|(n.sort.last?2:0):"email"===n.sort.u?4:0;if(t!==b){b=t;for(var e=0;e!==_.length;++e)_[e]._sort_user=x(_[e])}}();let e=o[t];e&&e.compare&&!0!==e.compare?_.sort(e.compare):e&&e.make_compare?_.sort(e.make_compare(n.sort,e.subtype||null)):("name"!==t&&"name2"!==t||n.anonymous)&&"user"!==t?"gradestatus"===t?_.sort(function(t,e){const n=t.scores_visible;return n!==e.scores_visible?n?-1:1:t.has_notes!=e.has_notes?t.has_notes?-1:1:Li(t,e)||Ti(t,e)}):n.sort.email&&!n.anonymous?(t="username",_.sort(function(t,e){var n=(t.email||"").toLowerCase(),i=(e.email||"").toLowerCase();return n!==i?""===n||""===i?""===n?1:-1:n<i?-1:1:Ti(t,e)})):("name2"!==t&&(t="username"),_.sort(Ti)):_.sort(Ti),n.sort.rev<0&&_.reverse(),_.sort(function(t,e){return t.boringness!==e.boringness?t.boringness-e.boringness:0})}function k(){const t=this.getAttribute("data-range-type");if("s61"===t&&u||"s61o"===t){const e="s61"===t,s=this.closest("tr"),a=(e?u:i).rows[s.rowIndex],r=n.user_row_checkbox(a);r.checked!==this.checked&&r.click()}}function C(){const t=r[r.length-1];let e=t.left+t.width;n.anonymous&&(o.name&&(e-=o.name.width),o.year&&(e-=o.year.width)),l.each(function(){d(this,"gtable-left-pin")||(this.style.width=e+"px")})}function A(){l.children("thead").find(".plsortable").removeClass("plsortactive plsortreverse"),l.children("thead").find("th[data-pa-sort='"+n.sort.f+"']").addClass("plsortactive").toggleClass("plsortreverse",n.sort.rev<0)}function E(e){const s=n.sort,r=e.detail.sort;if(n.sort=r,n.overridable_anonymous&&r.deblind!=s.deblind){n.anonymous=!r.deblind,l.toggleClass("gt-anonymous",!!n.anonymous),C(),l.children("tbody").find("input.gt-check").each(function(){const t=n.smap[this.parentNode.parentNode.getAttribute("data-pa-spos")];this.setAttribute("name",n.render_checkbox_name(t))});const t=i.closest("form").elements.anonymous;t&&(t.value=n.anonymous?"1":"0")}r.last!==s.last||r.deblind!=s.deblind?Ji(n,l,"name","name2","username","user"):r.u!==s.u&&Ji(n,l,"username","user"),w(),Gi(n,i,_),u&&Gi(n,u,_),o.rownumber&&y(),A(),a&&v(),t.site(!0,"pa-pset"+n.id+"-table",JSON.stringify(r))}!function(){let e=n.sort,s=t.site(!0,"pa-pset"+n.id+"-table");if(s)try{s=JSON.parse(s),s&&"object"==typeof s&&(e=n.sort=s,delete e.override_anonymous)}catch{}if(e.f&&/^\w+$/.test(e.f)||(e.f="name"),1!==e.rev&&-1!==e.rev&&(e.rev=1),n.overridable_anonymous||delete e.deblind,e.deblind){let i=(new Date).getTime()/1e3;"number"==typeof e.deblind&&e.deblind+3600>i?e.deblind=i:delete e.deblind,t.site(!0,"pa-pset"+n.id+"-table",JSON.stringify(e))}e.deblind&&(n.anonymous=!1),g=n.grades?new We(n.grades):new We({order:[]}),g.scores_visible=n.scores_visible,n.set_gradesheet(g);let l=-1,c=!1,u=n.scores_visible;for(let t=0;t!==_.length;++t){const e=_[t]=g.make_child().assign(_[t]);e.dropped?e.boringness=2:e.emptydiff||!e.grade_commit&&!e.commit&&!n.gitless_grades||e.grade_status<0?e.boringness=1:e.boringness=0;let i=0;if(e.grades)for(let t of n.in_total_indexes)null!=e.grades[t]&&""!==e.grades[t]&&++i;e.ngrades=i,-1===l?l=i:l>=0&&l!==i&&(!e.boringness||i>0)&&(l=-2),c=c||!!e.late_hours,u=u||e.scores_visible_pinned||e.grade_status<0}const d=-2===l;if(n.requested_columns)r=n.requested_columns;else{r=["rownumber"],n.checkbox&&r.push(n.flagged_commits?"flagcheckbox":"checkbox"),n.flagged_commits&&(r.push("pset"),r.push("at")),r.push("user","extension","year","grader"),c&&r.push("latehours"),n.flagged_commits&&r.push("conversation"),(n.flagged_commits||!n.gitless_grades||u)&&r.push("notes"),n.need_total&&r.push("total");let t=n.gradesheet;for(let e=0;e!==t.value_order.length;++e){const i=t.entries[t.value_order[e]];r.push(i.configure_column({type:"grade",name:"/g/"+i.key,gidx:e,gkey:i.key,ptconf:n}))}d&&r.push("ngrades"),n.gitless||r.push("repo")}for(let t of r)"string"==typeof t&&(t={type:t,name:t}),Object.assign(t,Ki[t.type]),t.ptconf=n,n.add_column(t);r=n.col,o=n.colmap,i.closest("form")&&(a=document.createElement("input"),a.type="hidden",a.name="slist",i.after(a))}(),function(){const t=s.hasClass("want-gtable-fixed"),e=Hi(r,0,!0);f(i,"gt-anonymous",!!n.anonymous),i.appendChild(e),f(i,"gt-useemail",!!n.sort.email),t&&(C(),p(i,"want-gtable-fixed"),h(i,"gtable-fixed"));const d=document.createElement("tbody");d.className="has-hotlist",i.appendChild(d),n.no_sort||(w(),A());for(const t of _){n.push(t);for(const e of t.partners||[])n.push(e)}Gi(n,i,_),o.rownumber&&y(),a&&v(),s.find("tbody").on("click","input[type=checkbox]",k),c=Ri(i),l=l.add(c),t&&window.IntersectionObserver&&i.closest(".gtable-container-2")&&function(){let t=0;for(;t!==r.length&&!r[t].pin;)++t;var e=$('<div style="position:absolute;left:0;top:0;bottom:0;width:'+(r[t].left-10)+'px;pointer-events:none"></div>').prependTo(s.parent())[0],a=!1,o=!1,c=new IntersectionObserver(function(t){for(let n of t)n.target===e?o=n.isIntersecting:a=n.isIntersecting;!a||o&&!u||(o||u||function(){const t=n.pinned_columns;let e=0;for(const n of t)e+=n.width;u=document.createElement("table"),u.className="gtable-left-pin user-gtable gtable-fixed new",u.style.width=e+24+"px",u.appendChild(Hi(t,0,!0)),u.appendChild(document.createElement("tbody")),u.tHead.firstChild.classList.add("kfade");let a=i.rows[0],r=u.rows[0];for(let e=0;e!==t.length;++e)r.childNodes[e].className=a.childNodes[t[e].index].className;const o=document.createElement("div");o.className="gtable-container-left-pin",o.appendChild(u),i.parentNode.prepend(o),u.tHead.addEventListener("click",Bi),$(u).find("tbody").on("click","input[type=checkbox]",k),Gi(n,u,_),m=Ri(u),s.find("input[data-range-type=s61]:checked").each(k),u.addEventListener("mouseenter",Oi,!0),u.addEventListener("mouseleave",Oi,!0),queueMicrotask(function(){p(u,"new"),m&&p(m,"new")}),l=l.add(u).add(m)}(),f(u.parentElement,"hidden",o),m&&f(m,"hidden",o))});c.observe(e),c.observe(i.parentElement)}()}(),function(){const t=i.closest("form");i.tBodies[0].addEventListener("pa-hotlist",qi),i.tBodies[0].addEventListener("click",Ii),i.addEventListener("mouseenter",Oi,!0),i.addEventListener("mouseleave",Oi,!0),i.tHead.addEventListener("click",Bi),t.addEventListener("rangechange",Xi),t.addEventListener("sortchange",E)}()}function ts(t){const e=["k0","k1"];let n=1,i=null,s=!1;for(let a=t.firstChild;a;a=a.nextElementSibling)if("gt-boring"!==a.className){if(!a.hidden){if(!1===s){s=null;for(let t=a.firstChild,e=0;t;t=t.nextSibling,++e)"gt-rownumber"===t.className&&(s=e)}null!==s&&(a.children.item(s).textContent=n+"."),a.classList.remove(e[1&(1^n)]),a.classList.add(e[1&n]),a.classList.contains("gtrow-partner")||++n,i&&(i.hidden=!1,i=null)}}else a.hidden=!0,i=n>1?a:null}let es,ns;At.add_builder("pa-ptable-user",function(){let t=this.closest("tr").getAttribute("data-pa-spos"),e=this.closest("form").pa__ptconf,n=e.smap[t];return{content:new Promise(t=>{const i=document.createElement("div"),s=e.anonymous&&n.anon_user;if(i.className="d-flex align-items-center",n.imageid&&!s){const t=e.make_student_ae(n),s=document.createElement("img");s.className="pa-tinyface",s.src=I("face",{u:n.user,imageid:n.imageid}),t.append(s),i.append(t)}const a=document.createElement("div");i.append(a);const r=e.make_student_ae(n);if(r.className+=" font-weight-bold",r.append(s?n.anon_user:n.user),a.append(r),n.x?a.append(" (X)"):!s&&n.year&&a.append(" "+Mi(n.year)),a.append(document.createElement("br")),!s){const t=Di(n,!1);if(""!==t){const i=e.make_student_ae(n);i.className="q",i.append(t),a.append(i,document.createElement("br"))}n.email&&a.append(n.email,document.createElement("br"))}t(i)}),delay:400,className:"gray small ml-2",dir:"w",noDelayClass:"pa-ptable-user"}});const is={grade:(t,e)=>"no"===t?(t,e)=>e.grade_status<0||!e.grade_status&&e.emptydiff:"yes"===t?(t,e)=>e.grade_status>0:"user"===t?(t,e)=>1===e.grade_status:"none"===t?(t,e)=>!e.grade_status:(e.push({status:2,message:"<0>Expected `grade:no`, `grade:yes`, `grade:user`, or `grade:none`"}),()=>!1),grader:(t,e)=>{if("any"===t)return(t,e)=>!!e.gradercid;if("none"===t)return(t,e)=>!e.gradercid;const n=new RegExp(ct(Ni.unquote(t)),"i"),i=[];for(const t in siteinfo.pc){const e=siteinfo.pc[t];n.test(Fi(e))&&i.push(+t)}return 1===i.length?(t,e)=>e.gradercid===i[0]:i.length>1?(t,e)=>i.includes(e.gradercid):(e.push({status:2,message:`<0>\`${t}\` matches no graders`}),()=>!1)},year:(t,e)=>{if(!/^(?:(?:\d+[-]\d+|[a-zA-Z\d]+)(?=,\w|$),?)+$/.test(t))return e.push({status:2,message:"<0>Bad `year`"}),()=>!1;t=t.toUpperCase();const n=[];for(const e of t.matchAll(/(\w+)[-]?(\w*)/g))e[2]?n.push(+e[1],+e[2]):/^\d+$/.test(e[1])?n.push(+e[1],null):n.push(e[1],null);return(t,e)=>{if(!e.year)return!1;const i="number"==typeof e.year;for(let t=0;t!==n.length;t+=2)if(null===n[t+1]?e.year===n[t]:i&&e.year>=n[t]&&e.year<=n[t+1])return!0;return!1}},is:(t,e)=>"x"===t||"X"===t?(t,e)=>!!e.x:"college"===t?(t,e)=>!e.x:"dropped"===t?(t,e)=>!!e.dropped:(e.push({status:2,message:"<0>Expected `is:x`, `is:college`, or `is:dropped`"}),()=>!1)},ss={any:t=>()=>null!=ns.grades[t],none:t=>()=>null==ns.grades[t],eq:(t,e)=>()=>ns.grades[t]==e,ne:(t,e)=>()=>ns.grades[t]!=e,gt:(t,e)=>()=>ns.grades[t]>e,ge:(t,e)=>()=>ns.grades[t]>=e,lt:(t,e)=>()=>ns.grades[t]<e,le:(t,e)=>()=>ns.grades[t]<=e};function as(t){const e=t.match(/^(<=?|>=?|==?|!=?||||(?=[\d.]))\s*(\d+\.?\d*|\.\d+)$/);if(!e)return null;const n=+e[2];return"="===e[1]|"=="===e[1]||""===e[1]?{op:"eq",value:n}:"!"===e[1]||"!="===e[1]||""===e[1]?{op:"ne",value:n}:"<"===e[1]?{op:"lt",value:n}:"<="===e[1]||""===e[1]?{op:"le",value:n}:">"===e[1]?{op:"gt",value:n}:{op:"ge",value:n}}function rs(t,e){t.user_data=function(t,e,n){let i=t.kword,s=t.text;if(!i){if(""===s||"*"===s||"ANY"===s||"ALL"===s)return()=>!0;let e=s.match(/^([a-zA-Z][-_a-zA-Z0-9]*)((?:<=?|>=?|==?|!=?|||)[^<>=!]*)$/);if(!e)return function(t){const e=new RegExp(ct(t),"i");return()=>es.anonymous?e.test(ns.anon_user):e.test(ns.first)||e.test(ns.last)||e.test(ns.email)||e.test(ns.user)}(t.unquoted_text());i=e[1],s=e[2]}const a=is[i];if(a)return a(s,n);const r=e.gradesheet,o=new Intl.Collator(void 0,{usage:"search",sensitivity:"accent"});let l=null,c=[];for(let t=0;t!==r.value_order.length;++t){const e=r.entries[r.value_order[t]];if(e.key===i){l=e;break}0!==o.compare(e.title_text,i)&&0!==o.compare(e.abbr(),i)||c.push(e)}if(l||1!==c.length||(l=c[0]),l)return function(t,e,n,i){const s=e.value_order_in(t);if("any"===n)return ss.any(s);if("none"===n)return ss.none(s);const a=e.gc.parse_search&&e.gc.parse_search.call(e,n,s,i);if(a)return()=>a(ns);const r=as(n);return r?ss[r.op](s,r.value):(i.push({status:2,message:`<0>Search comparison \`${n}\` not understood`}),null)}(r,l,s,n);if(("tot"===i||"total"===i)&&e.need_total){const t=as(s);if(t){const e="eq"===(u=t.op)?(t,e)=>t==e:"ne"===u?(t,e)=>t!=e:"lt"===u?(t,e)=>t<e:"le"===u?(t,e)=>t<=e:"gt"===u?(t,e)=>t>e:"ge"===u?(t,e)=>t>=e:()=>!1;return(n,i)=>e(i.total,t.value)}}var u;return n.push({status:2,message:`<0>Search \`${i}\` not understood`}),null}(t,es,e)}function os(t){return!!t.user_data&&t.user_data(t,ns)}function ls(t){const e=t.closest("form"),n=e.pa__ptconf;if(n.input_timeout=null,d(t,"js-ptable-search-api"))return function(t,e){$.ajax(I("api/search",{q:t.value,anonymous:e.anonymous?1:0}),{method:"GET",cache:!1,dataType:"json",success:function(n){if(!n.ok)return;const i=[];e.has_hidden=!1;for(const t of e.smap){if(!t)continue;const s=!n.uids.includes(t.uid);t.hidden!==s&&(i.push(t),t.hidden=s),s&&(e.has_hidden=!0)}cs(e,t.form,i)}})}(t,n);let i=new Ni(t.value).parse_expression();if(!i||i.op||i.kword||i.text||(i=null),At.close_under(t),es=n,i){const e=[];i.prepare_simple(rs,e),e.length>0&&At.enter(t,{content:Gt.render_list(e),className:"gray"})}const s=[];n.has_hidden=!1;for(const t of n.smap){if(!t)continue;ns=t;const e=!!i&&!i.evaluate_simple(os);t.hidden!==e&&(s.push(t),t.hidden=e),e&&(n.has_hidden=!0)}es=null,cs(n,e,s)}function cs(t,e,n){if(n.length){for(const i of e.querySelectorAll("table.user-gtable > tbody")){const e=t.tbody_rowmap(i);for(const t of n){const n=e.rows[t._spos];n&&(n.hidden=t.hidden)}ts(i);const s=i.parentElement.tHead.querySelector(".js-range-click");s&&v.trigger.call(s,"js-range-click","updaterange")}$(e).find(".pa-grgraph").trigger("redrawgraph")}}v.on("js-ptable-search",function(t){let e=this.closest("form").pa__ptconf,n=300;"keydown"===t.type&&"Enter"===L(t)&&(t.preventDefault(),n=0),e.input_timeout&&clearTimeout(e.input_timeout),e.input_timeout=setTimeout(ls,n,this)}),v.on("js-pset-gconfig",function(){let t,e,n=this.closest("form").pa__ptconf;function i(){const t=e.elements.state.value;f(e.elements.frozen.parentElement,"invisible","disabled"===t||"hidden"===t),f(e.elements.anonymous.parentElement,"invisible","disabled"===t)}function s(){$.ajax(I("=api/psetconfig",{pset:n.key}),{method:"POST",data:$(e).serializeWith({}),success:function(){location.hash="#"+n.key,location.reload()}})}!function(){let a;t=Gn().append(S("h2","pa-home-pset",n.title+" Settings"),S("div","pa-messages"),S("div","d-grid-1 grid-gap-2",S("span","select",S("select",{name:"state"},S("option",{value:"disabled"},"Disabled"),S("option",{value:"hidden"},"Hidden"),S("option",{value:"visible"},"Visible without grades"),S("option",{value:"scores_visible"},"Visible with grades"))),S("span","select",S("select",{name:"frozen"},S("option",{value:"no"},"Student updates allowed"),S("option",{value:"yes"},"Submissions frozen"))),S("span","select",S("select",{name:"anonymous"},S("option",{value:"no"},"Open grading"),S("option",{value:"yes"},"Anonymous grading"))))).append_actions(S("button",{type:"button",name:"bsubmit",class:"btn-primary"},"Save"),"Cancel"),e=t.form(),a=n.disabled?"disabled":n.visible?n.scores_visible?"scores_visible":"visible":"hidden",e.elements.state.value=a,e.elements.state.setAttribute("data-default-value",a),e.elements.state.addEventListener("change",i),i(),a=n.frozen?"yes":"no",e.elements.frozen.value=a,e.elements.frozen.setAttribute("data-default-value",a),a=n.anonymous?"yes":"no",e.elements.anonymous.value=a,e.elements.anonymous.setAttribute("data-default-value",a),t.find("button[name=bsubmit]").on("click",s),t.show()}()});const us=/[\0-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,ds=/[\0-\x1F\x7F-\x9F]/,hs=/[ \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000]/,ps=/[!-#%-\*,-\/:;\?@\[-\]_\{\}\xA1\xA7\xAB\xB6\xB7\xBB\xBF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061D-\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u09FD\u0A76\u0AF0\u0C77\u0C84\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166E\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1B7D\u1B7E\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205E\u207D\u207E\u208D\u208E\u2308-\u230B\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4F\u2E52-\u2E5D\u3001-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]|\uD800[\uDD00-\uDD02\uDF9F\uDFD0]|\uD801\uDD6F|\uD802[\uDC57\uDD1F\uDD3F\uDE50-\uDE58\uDE7F\uDEF0-\uDEF6\uDF39-\uDF3F\uDF99-\uDF9C]|\uD803[\uDEAD\uDF55-\uDF59\uDF86-\uDF89]|\uD804[\uDC47-\uDC4D\uDCBB\uDCBC\uDCBE-\uDCC1\uDD40-\uDD43\uDD74\uDD75\uDDC5-\uDDC8\uDDCD\uDDDB\uDDDD-\uDDDF\uDE38-\uDE3D\uDEA9]|\uD805[\uDC4B-\uDC4F\uDC5A\uDC5B\uDC5D\uDCC6\uDDC1-\uDDD7\uDE41-\uDE43\uDE60-\uDE6C\uDEB9\uDF3C-\uDF3E]|\uD806[\uDC3B\uDD44-\uDD46\uDDE2\uDE3F-\uDE46\uDE9A-\uDE9C\uDE9E-\uDEA2\uDF00-\uDF09]|\uD807[\uDC41-\uDC45\uDC70\uDC71\uDEF7\uDEF8\uDF43-\uDF4F\uDFFF]|\uD809[\uDC70-\uDC74]|\uD80B[\uDFF1\uDFF2]|\uD81A[\uDE6E\uDE6F\uDEF5\uDF37-\uDF3B\uDF44]|\uD81B[\uDE97-\uDE9A\uDFE2]|\uD82F\uDC9F|\uD836[\uDE87-\uDE8B]|\uD83A[\uDD5E\uDD5F]/;function fs(t){return Array.prototype.slice.call(arguments,1).forEach(function(e){e&&Object.keys(e).forEach(function(n){t[n]=e[n]})}),t}function ms(t){return Object.prototype.toString.call(t)}function gs(t){return"[object Function]"===ms(t)}function bs(t){return t.replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}const _s={fuzzyLink:!0,fuzzyEmail:!0,fuzzyIP:!1},vs={"http:":{validate:function(t,e,n){const i=t.slice(e);return n.re.http||(n.re.http=new RegExp("^\\/\\/"+n.re.src_auth+n.re.src_host_port_strict+n.re.src_path,"i")),n.re.http.test(i)?i.match(n.re.http)[0].length:0}},"https:":"http:","ftp:":"http:","//":{validate:function(t,e,n){const i=t.slice(e);return n.re.no_http||(n.re.no_http=new RegExp("^"+n.re.src_auth+"(?:localhost|(?:(?:"+n.re.src_domain+")\\.)+"+n.re.src_domain_root+")"+n.re.src_port+n.re.src_host_terminator+n.re.src_path,"i")),n.re.no_http.test(i)?e>=3&&":"===t[e-3]||e>=3&&"/"===t[e-3]?0:i.match(n.re.no_http)[0].length:0}},"mailto:":{validate:function(t,e,n){const i=t.slice(e);return n.re.mailto||(n.re.mailto=new RegExp("^"+n.re.src_email_name+"@"+n.re.src_host_strict,"i")),n.re.mailto.test(i)?i.match(n.re.mailto)[0].length:0}}},ys="biz|com|edu|gov|net|org|pro|web|xxx|aero|asia|coop|info|museum|name|shop|".split("|");function xs(t){const e=t.re=function(t){const e={};t=t||{},e.src_Any=us.source,e.src_Cc=ds.source,e.src_Z=hs.source,e.src_P=ps.source,e.src_ZPCc=[e.src_Z,e.src_P,e.src_Cc].join("|"),e.src_ZCc=[e.src_Z,e.src_Cc].join("|");return e.src_pseudo_letter="(?:(?![><]|"+e.src_ZPCc+")"+e.src_Any+")",e.src_ip4="(?:(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)",e.src_auth="(?:(?:(?!"+e.src_ZCc+"|[@/\\[\\]()]).)+@)?",e.src_port="(?::(?:6(?:[0-4]\\d{3}|5(?:[0-4]\\d{2}|5(?:[0-2]\\d|3[0-5])))|[1-5]?\\d{1,4}))?",e.src_host_terminator="(?=$|[><]|"+e.src_ZPCc+")(?!"+(t["---"]?"-(?!--)|":"-|")+"_|:\\d|\\.-|\\.(?!$|"+e.src_ZPCc+"))",e.src_path="(?:[/?#](?:(?!"+e.src_ZCc+"|[><]|[()[\\]{}.,\"'?!\\-;]).|\\[(?:(?!"+e.src_ZCc+"|\\]).)*\\]|\\((?:(?!"+e.src_ZCc+"|[)]).)*\\)|\\{(?:(?!"+e.src_ZCc+'|[}]).)*\\}|\\"(?:(?!'+e.src_ZCc+'|["]).)+\\"|\\\'(?:(?!'+e.src_ZCc+"|[']).)+\\'|\\'(?="+e.src_pseudo_letter+"|[-])|\\.{2,}[a-zA-Z0-9%/&]|\\.(?!"+e.src_ZCc+"|[.]|$)|"+(t["---"]?"\\-(?!--(?:[^-]|$))(?:-*)|":"\\-+|")+",(?!"+e.src_ZCc+"|$)|;(?!"+e.src_ZCc+"|$)|\\!+(?!"+e.src_ZCc+"|[!]|$)|\\?(?!"+e.src_ZCc+"|[?]|$))+|\\/)?",e.src_email_name='[\\-;:&=\\+\\$,\\.a-zA-Z0-9_][\\-;:&=\\+\\$,\\"\\.a-zA-Z0-9_]*',e.src_xn="xn--[a-z0-9\\-]{1,59}",e.src_domain_root="(?:"+e.src_xn+"|"+e.src_pseudo_letter+"{1,63})",e.src_domain="(?:"+e.src_xn+"|(?:"+e.src_pseudo_letter+")|(?:"+e.src_pseudo_letter+"(?:-|"+e.src_pseudo_letter+"){0,61}"+e.src_pseudo_letter+"))",e.src_host="(?:(?:(?:(?:"+e.src_domain+")\\.)*"+e.src_domain+"))",e.tpl_host_fuzzy="(?:"+e.src_ip4+"|(?:(?:(?:"+e.src_domain+")\\.)+(?:%TLDS%)))",e.tpl_host_no_ip_fuzzy="(?:(?:(?:"+e.src_domain+")\\.)+(?:%TLDS%))",e.src_host_strict=e.src_host+e.src_host_terminator,e.tpl_host_fuzzy_strict=e.tpl_host_fuzzy+e.src_host_terminator,e.src_host_port_strict=e.src_host+e.src_port+e.src_host_terminator,e.tpl_host_port_fuzzy_strict=e.tpl_host_fuzzy+e.src_port+e.src_host_terminator,e.tpl_host_port_no_ip_fuzzy_strict=e.tpl_host_no_ip_fuzzy+e.src_port+e.src_host_terminator,e.tpl_host_fuzzy_test="localhost|www\\.|\\.\\d{1,3}\\.|(?:\\.(?:%TLDS%)(?:"+e.src_ZPCc+"|>|$))",e.tpl_email_fuzzy='(^|[><]|"|\\(|'+e.src_ZCc+")("+e.src_email_name+"@"+e.tpl_host_fuzzy_strict+")",e.tpl_link_fuzzy="(^|(?![.:/\\-_@])(?:[$+<=>^`|]|"+e.src_ZPCc+"))((?![$+<=>^`|])"+e.tpl_host_port_fuzzy_strict+e.src_path+")",e.tpl_link_no_ip_fuzzy="(^|(?![.:/\\-_@])(?:[$+<=>^`|]|"+e.src_ZPCc+"))((?![$+<=>^`|])"+e.tpl_host_port_no_ip_fuzzy_strict+e.src_path+")",e}(t.__opts__),n=t.__tlds__.slice();function i(t){return t.replace("%TLDS%",e.src_tlds)}t.onCompile(),t.__tlds_replaced__||n.push("a[cdefgilmnoqrstuwxz]|b[abdefghijmnorstvwyz]|c[acdfghiklmnoruvwxyz]|d[ejkmoz]|e[cegrstu]|f[ijkmor]|g[abdefghilmnpqrstuwy]|h[kmnrtu]|i[delmnoqrst]|j[emop]|k[eghimnprwyz]|l[abcikrstuvy]|m[acdeghklmnopqrstuvwxyz]|n[acefgilopruz]|om|p[aefghklmnrstwy]|qa|r[eosuw]|s[abcdeghijklmnortuvxyz]|t[cdfghjklmnortvwz]|u[agksyz]|v[aceginu]|w[fs]|y[et]|z[amw]"),n.push(e.src_xn),e.src_tlds=n.join("|"),e.email_fuzzy=RegExp(i(e.tpl_email_fuzzy),"i"),e.link_fuzzy=RegExp(i(e.tpl_link_fuzzy),"i"),e.link_no_ip_fuzzy=RegExp(i(e.tpl_link_no_ip_fuzzy),"i"),e.host_fuzzy_test=RegExp(i(e.tpl_host_fuzzy_test),"i");const s=[];function a(t,e){throw new Error('(LinkifyIt) Invalid schema "'+t+'": '+e)}t.__compiled__={},Object.keys(t.__schemas__).forEach(function(e){const n=t.__schemas__[e];if(null===n)return;const i={validate:null,link:null};if(t.__compiled__[e]=i,"[object Object]"===ms(n))return"[object RegExp]"!==ms(n.validate)?gs(n.validate)?i.validate=n.validate:a(e,n):i.validate=function(t){return function(e,n){const i=e.slice(n);return t.test(i)?i.match(t)[0].length:0}}(n.validate),void(gs(n.normalize)?i.normalize=n.normalize:n.normalize?a(e,n):i.normalize=function(t,e){e.normalize(t)});!function(t){return"[object String]"===ms(t)}(n)?a(e,n):s.push(e)}),s.forEach(function(e){t.__compiled__[t.__schemas__[e]]&&(t.__compiled__[e].validate=t.__compiled__[t.__schemas__[e]].validate,t.__compiled__[e].normalize=t.__compiled__[t.__schemas__[e]].normalize)}),t.__compiled__[""]={validate:null,normalize:function(t,e){e.normalize(t)}};const r=Object.keys(t.__compiled__).filter(function(e){return e.length>0&&t.__compiled__[e]}).map(bs).join("|");t.re.schema_test=RegExp("(^|(?!_)(?:[><]|"+e.src_ZPCc+"))("+r+")","i"),t.re.schema_search=RegExp("(^|(?!_)(?:[><]|"+e.src_ZPCc+"))("+r+")","ig"),t.re.schema_at_start=RegExp("^"+t.re.schema_search.source,"i"),t.re.pretest=RegExp("("+t.re.schema_test.source+")|("+t.re.host_fuzzy_test.source+")|@","i"),function(t){t.__index__=-1,t.__text_cache__=""}(t)}function ws(t,e){const n=t.__index__,i=t.__last_index__,s=t.__text_cache__.slice(n,i);this.schema=t.__schema__.toLowerCase(),this.index=n+e,this.lastIndex=i+e,this.raw=s,this.text=s,this.url=s}function ks(t,e){const n=new ws(t,e);return t.__compiled__[n.schema].normalize(n,t),n}function Cs(t,e){if(!(this instanceof Cs))return new Cs(t,e);var n;e||(n=t,Object.keys(n||{}).reduce(function(t,e){return t||_s.hasOwnProperty(e)},!1)&&(e=t,t={})),this.__opts__=fs({},_s,e),this.__index__=-1,this.__last_index__=-1,this.__schema__="",this.__text_cache__="",this.__schemas__=fs({},vs,t),this.__compiled__={},this.__tlds__=ys,this.__tlds_replaced__=!1,this.re={},xs(this)}Cs.prototype.add=function(t,e){return this.__schemas__[t]=e,xs(this),this},Cs.prototype.set=function(t){return this.__opts__=fs(this.__opts__,t),this},Cs.prototype.test=function(t){if(this.__text_cache__=t,this.__index__=-1,!t.length)return!1;let e,n,i,s,a,r,o,l,c;if(this.re.schema_test.test(t))for(o=this.re.schema_search,o.lastIndex=0;null!==(e=o.exec(t));)if(s=this.testSchemaAt(t,e[2],o.lastIndex),s){this.__schema__=e[2],this.__index__=e.index+e[1].length,this.__last_index__=e.index+e[0].length+s;break}return this.__opts__.fuzzyLink&&this.__compiled__["http:"]&&(l=t.search(this.re.host_fuzzy_test),l>=0&&(this.__index__<0||l<this.__index__)&&null!==(n=t.match(this.__opts__.fuzzyIP?this.re.link_fuzzy:this.re.link_no_ip_fuzzy))&&(a=n.index+n[1].length,(this.__index__<0||a<this.__index__)&&(this.__schema__="",this.__index__=a,this.__last_index__=n.index+n[0].length))),this.__opts__.fuzzyEmail&&this.__compiled__["mailto:"]&&(c=t.indexOf("@"),c>=0&&null!==(i=t.match(this.re.email_fuzzy))&&(a=i.index+i[1].length,r=i.index+i[0].length,(this.__index__<0||a<this.__index__||a===this.__index__&&r>this.__last_index__)&&(this.__schema__="mailto:",this.__index__=a,this.__last_index__=r))),this.__index__>=0},Cs.prototype.pretest=function(t){return this.re.pretest.test(t)},Cs.prototype.testSchemaAt=function(t,e,n){return this.__compiled__[e.toLowerCase()]?this.__compiled__[e.toLowerCase()].validate(t,n,this):0},Cs.prototype.match=function(t){const e=[];let n=0;this.__index__>=0&&this.__text_cache__===t&&(e.push(ks(this,n)),n=this.__last_index__);let i=n?t.slice(n):t;for(;this.test(i);)e.push(ks(this,n)),i=i.slice(this.__last_index__),n+=this.__last_index__;return e.length?e:null},Cs.prototype.matchAtStart=function(t){if(this.__text_cache__=t,this.__index__=-1,!t.length)return null;const e=this.re.schema_at_start.exec(t);if(!e)return null;const n=this.testSchemaAt(t,e[2],e[0].length);return n?(this.__schema__=e[2],this.__index__=e.index+e[1].length,this.__last_index__=e.index+e[0].length+n,ks(this,0)):null},Cs.prototype.tlds=function(t,e){return t=Array.isArray(t)?t:[t],e?(this.__tlds__=this.__tlds__.concat(t).sort().filter(function(t,e,n){return t!==n[e-1]}).reverse(),xs(this),this):(this.__tlds__=t.slice(),this.__tlds_replaced__=!0,xs(this),this)},Cs.prototype.normalize=function(t){t.schema||(t.url="http://"+t.url),"mailto:"!==t.schema||/^mailto:/i.test(t.url)||(t.url="mailto:"+t.url)},Cs.prototype.onCompile=function(){};const As=Cs;function Es(t){return document.getElementById(t)}window.markdownit.linkify=As(),window.markdownit.linkify.set({fuzzyEmail:!1,"---":!0}),$.fn.extend({geometry:function(t){var e,n;if(this[0]==window)e={left:this.scrollLeft(),top:this.scrollTop()};else{if(1==this.length&&this[0].getBoundingClientRect)return e=$.extend({},this[0].getBoundingClientRect()),(n=window.pageXOffset)&&(e.left+=n,e.right+=n),(n=window.pageYOffset)&&(e.top+=n,e.bottom+=n),"width"in e||(e.width=e.right-e.left,e.height=e.bottom-e.top),e;e=this.offset()}return e&&(e.width=t?this.outerWidth():this.width(),e.height=t?this.outerHeight():this.height(),e.right=e.left+e.width,e.bottom=e.top+e.height),e},scrollIntoView:function(t){t=t||{};for(let e=0;e!==this.length;++e){let n=$(this[e]).geometry(),i=this[e].parentNode;for(;i&&i.tagName&&"visible"===$(i).css("overflow-y");)i=i.parentNode;i=i&&i.tagName?i:window;let s=$(i).geometry();if(n.top<s.top+(t.marginTop||0)||t.atTop){let e=Math.max(n.top-(t.marginTop||0),0);i===window?i.scrollTo(i.scrollX,e):i.scrollTop=e}else if(n.bottom>s.bottom-(t.marginBottom||0)){let e=Math.max(n.bottom+(t.marginBottom||0)-s.height,0);i===window?i.scrollTo(i.scrollX,e):i.scrollTop=e}}return this},serializeWith:function(t){var e=this.serialize();if(null!=e&&t){let n=e.length&&"&"!=e[e.length-1]?"&":"";for(let i in t)null!=t[i]&&(e+=n+encodeURIComponent(i)+"="+encodeURIComponent(t[i]),n="&")}return e}});var $s=function(){var t,e=!1;function n(n,i){var s,a;n&&"string"==typeof n&&(n=Es(n)),n&&e&&(s=new Date(1e3*i),a=r(t?"%A %#e %b %Y %#R your time":"%A %#e %b %Y %#r your time",s),"SPAN"==n.tagName?(n.textContent=" ("+a+")",n.style.display="inline"):(n.textContent=a,n.style.display="block"))}return n.initialize=function(n,i){t=i,e=Math.abs((new Date).getTimezoneOffset()-n)>=60},n}(),Ss=[];function Ns(t){if(t)"string"==typeof t?Ss.push(Ns[t]):Ss.push(t);else for(var e=0;e<Ss.length;++e)Ss[e]()}Ns.time=function(t,e){$s.initialize(t,e)};var Ds={},Fs=1;function Ms(t,e,n){var i,s,a,r,o,l;if(t instanceof Array)for(i=0;i<t.length;i++)Ms(t[i],e,n);else if("string"==typeof t)o=n,null!=Ds[t]&&null!=Ds[t][n]&&(o=Ds[t][n]),l=o||"",Ms(Es("fold"+t)||Es(t),e,o),(s=Es("foldsession."+t+l))?s.src=s.src.replace(/val=.*/,"val="+(e?1:0)+"&u="+Fs++):(s=Es("foldsession."+t))&&(s.src=s.src.replace(/val=.*/,"val="+(e?1:0)+"&sub="+(n||l)+"&u="+Fs++)),!e&&(s=Es("fold"+t+l+"_d"))&&(s.setSelectionRange&&null==s.hotcrp_ever_focused&&(s.setSelectionRange(s.value.length,s.value.length),s.hotcrp_ever_focused=!0),s.focus());else if(t&&(a="fold"+(l=n||"")+"o",r="fold"+l+"c",null==e&&t.className.indexOf(a)>=0&&(e=!0),t.className=e?t.className.replace(a,r):t.className.replace(r,a),document.recalc))try{t.innerHTML=t.innerHTML+""}catch{}return!1}v.on("js-foldup",function(t,e){let n,i,s=this;if("number"==typeof e?e={n:e}:e||(e={}),"DIV"!==this.tagName||!t||!t.target.closest("a")||e.required){!("n"in e)&&s.hasAttribute("data-fold-target")&&(i=s.getAttribute("data-fold-target").match(/^((?![#\d]|[couU]$)[^#]*)#?(\d*)([couU]?)$/))&&(""!==i[1]&&(s=document.getElementById(i[1])),e.n=parseInt(i[2])||0,"open"in e||""===i[3]||("INPUT"===this.tagName&&w(this)&&(this.checked?"u"===i[3]:"U"===i[3])&&(i[3]="c"),e.open="c"!==i[3]));for(var a="fold"+(e.n||"");s&&(!d(s,"has-fold")&&(!s.id||!s.id.startsWith("fold"))||null!=e.n&&!d(s,a+"c")&&!d(s,a+"o"));)s=s.parentNode;if(!s)return!0;if(null==e.n)for(const t of m(s))t.startsWith("fold")&&(i=t.match(/^fold(\d*)[oc]$/))&&(null==e.n||+i[1]<e.n)&&(e.n=+i[1],a="fold"+(e.n||""));if(!("open"in e)&&("INPUT"===this.tagName||"SELECT"===this.tagName||"TEXTAREA"===this.tagName)){let t=null;if("checkbox"===this.type)e.open=this.checked;else if("radio"===this.type){if(!this.checked)return!0;t=this.value}else"select-one"===this.type?t=this.selectedIndex<0?"":this.options[this.selectedIndex].value:"text"!==this.type&&"textarea"!==this.type||(e.open=""!==this.value);if(null!==t){const n=s.getAttribute("data-"+a+"-values")||"",i=""===$.trim(n)?[]:n.split(/\s+/);e.open=i.indexOf(t)>=0}}n=d(s,a+"c"),"open"in e&&!!e.open!==n||(e.open=n,Ms(s,!n,e.n||0),$(s).trigger($.Event("foldtoggle",{which:e}))),this.hasAttribute("aria-expanded")&&this.setAttribute("aria-expanded",n?"true":"false"),t&&"object"==typeof t&&"click"===t.type&&!d(t.target,"uic")&&(v.stopPropagation(t),t.preventDefault())}}),v.on("js-hide-error",function(){h(this,"hidden")}),v.on("js-pset-upload-grades",function(){$("#upload").removeClass("hidden")}),v.on("pa-signin-radio",function(){let t;"login"===this.value?(Ms("logingroup",!1),Ms("logingroup",!1,2),t="Sign in"):"forgot"===this.value?(Ms("logingroup",!0),Ms("logingroup",!1,2),t="Reset password"):"new"===this.value&&(Ms("logingroup",!0),Ms("logingroup",!0,2),t="Create account"),document.getElementById("signin").value=t});let Ts=[],Ls=!1;function js(t,e){e>0&&!d(t,"pa-dirty")&&setTimeout(zs,e),h(t,"pa-dirty");const n=t.closest(".pa-psetinfo");Ts.indexOf(n)<0&&Ts.push(n),0===e&&(Os(t),zs())}function Os(t){let e=t.querySelector(".pa-save-message");e||t.appendChild(e=S("span","pa-save-message compact")),e.className="pa-save-message compact",e.replaceChildren(S("span","spinner"))}function zs(){Ts.length>0&&!Ls&&(Ls=!0,Q.then(Bs))}function Bs(){Ls=!1;const t=Ts[0];if(!t)return void Q.done();if(d(t,"pa-outstanding"))return void Q.retry(Bs);Ts.shift();const e={},n={},i=We.closest(t),s=[];if($(t).find(".pa-dirty .pa-gradevalue").each(function(){if("INPUT"!==this.tagName&&"TEXTAREA"!==this.tagName&&"SELECT"!==this.tagName)return;const t=i.xentry(this.name),a=t?t.value_in(i):null;let r;"checkbox"!==this.type&&"radio"!==this.type||this.checked?r=this.value:"checkbox"===this.type&&(r=0),null==r||null!=a&&r==a||(n[this.name]=a,e[this.name]=r,s.indexOf(this.form)<0&&s.push(this.form))}),$(t).find(".pa-dirty .pa-save-message.compact").remove(),$(t).find(".pa-dirty").removeClass("pa-dirty"),0===s.length)Q.done();else{h(t,"pa-outstanding");for(const t of s)Os(t);$.ajax(I("=api/grade",{psetinfo:t}),{data:{grades:e,oldgrades:n},method:"POST",cache:!1,dataType:"json",success:function(e){for(const t of s)Is(t,e);p(t,"pa-outstanding"),e.ok&&We.store(t,e),Q.done()}})}zs()}function Is(t,e){const n=t.querySelector(".pa-save-message");let i;e.ok?e.answer_timeout&&(i=t.closest(".pa-grade"))&&d(i,"pa-ans")?(p(n,"compact"),n.replaceChildren(S("strong","err","Your exam period has closed.")," Your change was saved anyway, but the version used for grading will be selected from within the exam window.")):d(t,"pa-dirty")?n.remove():(h(n,"compact"),h(n,"fadeout"),n.replaceChildren(S("span","savesuccess"))):(p(n,"compact"),n.replaceChildren(Gt.render_xhr_error_onto(S("strong","err"),e)))}function qs(){p(this,"need-pa-grade");const t=Pe.closest(this),e=We.closest(this);if(t&&e){const n=t.render(e);if(this.parentElement.replaceChild(this,n),e.update_at(n),t.landmark_range&&this.closest(".pa-gradebox")&&t.landmark_grade(this.firstChild),this.hasAttribute("data-pa-landmark-buttons")){const t=JSON.parse(this.getAttribute("data-pa-landmark-buttons"));for(const e of t)"string"==typeof e?$(n).find(".pa-pv").append(e):e.className&&$(n).find(".pa-pv").append(S("button",{type:"button",class:"uic uikd pa-grade-button","data-pa-grade-button":e.className},e.title))}}}function Rs(t){return t.getBoundingClientRect().top-window.scrollY}function Ps(t,e){queueMicrotask(()=>{const n=t.getBoundingClientRect().top-e;window.scrollBy(0,n-window.scrollY)})}function Hs(t,e){const n=document.createElement("button");return n.className="btn-t ui small need-tooltip "+t,n.setAttribute("aria-label",e),n.append(document.createElement("span")),n.firstChild.className="filter-gray",n}function Ws(t,e){const n=t.entries[e.getAttribute("data-pa-grade")];let i=null;t.user&&d(document.body,"pa-multiuser")&&(i=document.createElement("span"),i.className="pa-fileref-context",i.textContent=t.user+" / ");const s=[];if(t.scores_editable&&t.section_has(n,t=>t.description)){const t=Hs("pa-grade-toggle-description","Toggle description");f(t.firstChild,"filter-gray",d(e,"pa-hide-description")),t.firstChild.textContent="",s.push(t)}if(t.scores_editable&&t.section_has(n,t=>t.answer&&"section"!==t.type)){const t=Hs("pa-grade-toggle-answer","Toggle answer editing");t.firstChild.textContent="",s.push(t)}if(!t.answers_editable&&t.section_has(n,t=>"markdown"===t.type)){const t=Hs("pa-grade-toggle-markdown","Toggle Markdown");t.firstChild.className="icon-markdown filter-gray",s.push(t)}let a=e;for(;!a.firstChild||!d(a.firstChild,"pa-p");)a=d(a,"pa-dg")?a.firstChild:a.nextSibling;let r=a.firstChild;if(!d(r,"pa-p-section")){if(!i&&!s.length)return;r=document.createElement("div"),r.className="pa-p pa-p-section";const t=document.createElement("label");t.className="pa-pt",t.textContent="",r.appendChild(t),a.insertBefore(r,a.firstChild)}if(i&&r.firstChild.insertBefore(i,r.firstChild.firstChild),s.length){const t=document.createElement("div");t.className="btnbox ml-3",t.append(...s),r.firstChild.append(t)}h(a,"pa-with-sticky"),h(r,"pa-sticky");const o=r.firstChild.nextSibling;o&&d(o,"pa-pdesc")&&(h(o,"pa-ptop"),d(r,"pa-p-hidden")&&h(o,"pa-p-hidden"),a.insertBefore(o,r.nextSibling))}function Us(t,e){for(;e;){const t=e.nextSibling;e.remove(),e=t}for(;!t.firstChild;){const e=t.parentElement;t.remove(),t=e}}function Zs(){p(this,"need-pa-gradelist"),h(this,"pa-gradelist");const t=this.closest(".pa-psetinfo"),e=We.closest(t);if(!e)return;const n=function(t){const e={};let n=t.firstChild;for(;n;)if(d(n,"pa-grade")&&(e[n.getAttribute("data-pa-grade")]=n),d(n,"pa-dg"))n=n.firstChild;else{for(;!n.nextSibling&&d(n.parentElement,"pa-dg");)n=n.parentElement;n=n.nextSibling}return e}(this),i=e.has(t=>t.description||t.answer||"section"===t.type||"markdown"===t.type&&!1===e.answers_editable),s=i?function(t,e){const n="pa-dg pa-gsection".concat(e.scores_editable?" pa-hide-description":"",d(t,"is-main")?" is-main":""),i=[];let s=t.firstChild,a=null;for(const r of e.value_order){const o=e.entries[r];if(!(o.concealed&&!e.scores_editable||null!==a&&"section"!==o.type)){for(;s&&!d(s,"pa-dg")&&!d(s,"pa-grade");)s=s.nextSibling;if(!s||!d(s,"pa-gsection")||s.getAttribute("data-pa-grade")!==r){const e=document.createElement("div");e.className=n,e.setAttribute("data-pa-grade",r),t.insertBefore(e,s),s=e,i.push(s)}if(e.section_wants_sidebar(o)&&!d(s,"pa-with-sidebar")){h(s,"pa-with-sidebar");const t=document.createElement("div");t.className="pa-sidebar";const e=document.createElement("div");e.className="pa-dg is-mainsb",s.append(t,e)}a=s,s=s.nextSibling}}return i}(this,e):[];let a=this,r=a.firstChild,o=null,l=null;for(let t=0;t!==e.value_order.length;++t){const s=e.value_order[t],c=e.entries[s];if(!e.scores_editable&&c.concealed)continue;if(i&&a!==this&&"section"===c.type){for(;a!==this;)r=a.nextSibling,a=a.parentElement;o&&(Us(o,l),o=l=null)}for(;r&&!d(r,"pa-grade");)d(r,"pa-dg")?(a=r,r=r.firstChild):(d(r,"pa-sidebar")&&(o=r),r=r.nextSibling);let u=n[s];if(u&&u===r||(u?c.unmount_at(u):u=c.render(e),a.insertBefore(u,r),e.update_at(u),r=u),delete n[s],o&&!c.answer){if("pa-sidebar"===o.className){if(null===o.firstChild){const t=document.createElement("div");t.className="pa-gradebox pa-ps",o.appendChild(t)}o=o.firstChild,l=o.firstChild}if(l&&l.getAttribute("data-pa-grade")===s)l=l.nextSibling;else{const t=c.render(e);o.insertBefore(t,l),e.update_at(t,{sidebar:!0})}}r=r.nextSibling}o&&Us(o,l);for(const t in n){const i=n[t];e.entries[i.getAttribute("data-pa-grade")].unmount_at(i)}for(const t of s)Ws(e,t);if(this.classList.contains("want-psetinfo-links")){this.classList.remove("want-psetinfo-links");const t=document.createElement("div");t.className="pa-psetinfo-links btnbox mt-2 mb-2 hidden",this.append(t);for(const e of[!0,!1]){const n=Ks(this,e);n&&(Ys(t,e),Ys(n.querySelector(".pa-psetinfo-links"),!e))}}$(".pinnable").each(fi)}function Ks(t,e){const n=e?"previousSibling":"nextSibling",i=t.closest(".pa-psetinfo");let s=i;for(;s&&(s===i||1!==s.nodeType||!s.classList.contains("pa-psetinfo"));)s=s[n];return s}function Ys(t,e){if(t&&!t.querySelector(e?".prev":".next")){t.classList.remove("hidden");const n=document.createElement("button");n.textContent=e?"":"",n.className="ui pa-psetinfo-link "+(e?"prev":"next"),n.type="button",t[e?"prepend":"append"](n)}}v.on("input.pa-gradevalue",function(){const t=this.form;t&&d(t,"pa-pv")&&!d(t,"pa-dirty")&&js(t,8e3)}),v.on("change.pa-gradevalue",function(){const t=this.form;let e;t&&d(t,"pa-pv")?js(t,0):"hidden"===this.type&&(e=Pe.closest(this))&&queueMicrotask(()=>{e.gc.update_edit.call(e,this,+this.value,{})})}),v.on("click.pa-gradevalue",function(){"checkbox"!==this.type&&"radio"!==this.type||queueMicrotask(()=>{$(this).trigger("change")})}),v.on("pa-pv",function(t){t.preventDefault(),js(this,0)}),v.on("pa-grade-button",function(t){if("keydown"===t.type){var e,n=L(t);if(t.ctrlKey&&("n"===n||"N"===n||"p"===n||"P"===n||"A"===n)&&(e=this.closest(".pa-grade"))){var i=e.getAttribute("data-pa-grade"),s=$(".pa-grade[data-pa-grade="+i+"] .pa-grade-button[data-pa-grade-button="+this.getAttribute("data-pa-grade-button")+"]").filter(":visible"),a=s.toArray().indexOf(this);if(a>=0){if("n"===n||"N"===n||"p"===n||"P"===n){var r=s[(a+("n"===n||"N"===n?1:s.length-1))%s.length],o=r.closest(".pa-dg");o&&$(o).scrollIntoView({marginTop:24,atTop:!0}),r.focus(),$(r).scrollIntoView()}else s.click();t.preventDefault()}}}else"click"===t.type&&v.trigger.call(this,this.getAttribute("data-pa-grade-button"),t)}),v.on("pa-grade-toggle-description",function(t){const e=this.closest(".pa-gsection"),n=t.metaKey?$(".pa-gsection"):$(e),i=d(e,"pa-hide-description"),s=Rs(this);At.close(),n.each(function(){f(this,"pa-hide-description",!i),$(this).find(".pa-grade-toggle-description > span").toggleClass("filter-gray",!i)}),Ps(this,s)}),v.on("pa-grade-toggle-markdown",function(t){const e=this.closest(".pa-gsection"),n=t.metaKey?$(".pa-gsection"):$(e),i=d(this.firstChild,"filter-gray"),s=Rs(this);At.close(),n.each(function(){const t=We.closest(this);$(this).find(".pa-grade").each(function(){"markdown"===t.entries[this.getAttribute("data-pa-grade")].type&&d(this,"pa-markdown")!==i&&(f(this,"pa-markdown",i),d(this,"e")||(t.remount_at(this,0),t.update_at(this)))}),$(this).find(".pa-grade-toggle-markdown > span").toggleClass("filter-gray",!i)}),Ps(this,s)}),v.on("pa-grade-toggle-answer",function(t){const e=this.closest(".pa-gsection"),n=t.metaKey?$(".pa-gsection"):$(e),i=d(this.firstChild,"filter-gray")?2:0,s=Rs(this);At.close(),n.each(function(){const t=We.closest(this);$(this).find(".pa-grade").each(function(){t.entries[this.getAttribute("data-pa-grade")].answer&&(t.remount_at(this,i),t.update_at(this,{reset:!0}))}),$(this).find(".pa-grade-toggle-answer > span").toggleClass("filter-gray",0===i),$(this).find(".pa-grade-toggle-markdown").toggleClass("hidden",0!==i)}),Ps(this,s)}),$(function(){$(".need-pa-grade").each(qs),$(".need-pa-gradelist").each(Zs)}),v.on("pa-psetinfo-link",function(){const t=Ks(this,this.classList.contains("prev"));t&&t.id&&(location.hash="#"+t.id)}),v.on("pa-notes-grade",function(t){if("keydown"===t.type){var e,n=L(t);if(t.ctrlKey&&("n"===n||"N"===n||"p"===n||"P"===n||"A"===n)&&(e=this.closest(".pa-grade"))){var i=e.getAttribute("data-pa-grade"),s=$(".pa-grade[data-pa-grade="+i+"] .pa-notes-grade").filter(":visible"),a=s.toArray().indexOf(this);if(a>=0){if("n"===n||"N"===n||"p"===n||"P"===n){var r=s[(a+("n"===n||"N"===n?1:s.length-1))%s.length],o=r.closest(".pa-dg");o&&$(o).scrollIntoView({marginTop:24,atTop:!0}),r.focus(),$(r).scrollIntoView()}else s.click();t.preventDefault()}}}else if("click"===t.type){const e=this.closest(".pa-grade").querySelector(".pa-gradevalue");e&&e.value!=e.getAttribute("data-pa-notes-grade")&&$(e).val(e.getAttribute("data-pa-notes-grade")).change(),t.preventDefault()}}),v.on("js-runmany-download",function(){const t=document.getElementById("pa-runmany-form");if(t.elements.jobs&&t.elements.jobs.value){const e=document.createElement("input");e.type="hidden",e.name="download",e.value="1",t.elements.jobs.disabled=!1,t.append(e),t.submit(),t.elements.jobs.disabled=!0,t.removeChild(e)}}),$(function(){document.body.setAttribute("data-time-skew",Math.floor((new Date).getTime()/1e3)-+document.body.getAttribute("data-now"))}),$(".pa-download-timed").each(function(){var t=this,e=setInterval(n,15e3);function n(){const n=+t.getAttribute("data-pa-download-at"),i=+t.getAttribute("data-pa-commit-at"),s=+t.getAttribute("data-pa-download-expiry"),a=(new Date).getTime()/1e3+ +document.body.getAttribute("data-time-skew");let o;o=a>s?r("%Y/%m/%d %H:%M",n):Math.round((a-n)/60)+" min",i>n&&(o+="  "+Math.round((i-n)/60)+" min before commit"),$(t).find(".pa-download-timer").text(o),a>s&&clearInterval(e)}n()}),v.on("submit.pa-setrepo",function(t){let e=this;this.classList.remove("has-error","has-warning"),d(this.firstChild,"feedback-list")&&this.removeChild(this.firstChild),this.querySelector("button[type=submit]").disabled=!0,$.ajax(I("=api/repo",{pset:this.getAttribute("data-pa-pset"),u:siteinfo.uservalue}),{type:"POST",cache:!1,data:$(this).serialize(),success:function(t){e.querySelector("button[type=submit]").disabled=!1,t.message_list?e.insertBefore(Gt.render_list(t.message_list),e.firstChild):location.reload()}}),t.preventDefault()}),v.on("submit.pa-setbranch",function(t){let e=this;this.classList.remove("has-error","has-warning"),d(this.firstChild,"feedback-list")&&this.removeChild(this.firstChild),this.querySelector("button[type=submit]").disabled=!0,$.ajax(I("=api/branch",{pset:this.getAttribute("data-pa-pset"),u:siteinfo.uservalue}),{type:"POST",cache:!1,data:$(this).serialize(),success:function(t){e.querySelector("button[type=submit]").disabled=!1,t.message_list?e.insertBefore(Gt.render_list(t.message_list),e.firstChild):location.reload()}}),t.preventDefault()}),v.on("focusin.pa-branch-datalist",function(){p(this,"ui-focusin"),!this.hasAttribute("list")&&this.hasAttribute("data-pa-repoid")&&function(t){let e=document.getElementById("branchlist-"+t);return e?Promise.resolve(e):(e=document.createElement("datalist"),e.id="branchlist-"+t,document.body.appendChild(e),new Promise(function(n,i){$.ajax(I("api/branches",{repoid:t}),{type:"GET",cache:!1,success:function(t){if(t.ok){for(const n of t.branches){const t=document.createElement("option");t.value=n,e.appendChild(t)}n(e)}else i(t)}})}))}(this.getAttribute("data-pa-repoid")).then(t=>{this.setAttribute("list",t.id)}).catch(t=>console.log(t))}),v.on("pa-anonymized-link",function(t){var e=this.getAttribute("data-pa-link");t&&t.metaKey?window.open(e):window.location=e}),v.on("js-multiresolveflag",function(){const t=this.closest("form"),e=t.pa__ptconf,n=[];$(t).find(".papsel:checked").each(function(){const t=e.smap[this.closest("tr").getAttribute("data-pa-spos")];n.push({pset:t.pset,uid:t.uid,hash:t.commit,flagid:t.flagid})}),0!==n.length?$.ajax(I("=api/multiresolveflag"),{type:"POST",cache:!1,data:{flags:JSON.stringify(n)}}):window.alert("No flags selected.")}),window.$pa={beforeunload:function(t){if(document.querySelector(".pa-dirty, .pa-outstanding"))t.preventDefault();else for(const e of document.querySelectorAll(".pa-gw textarea")){const n=e.closest(".pa-dl"),i=Se.at(n);if(!c(e.value,i.text)&&!d(n,"pa-save-failed"))return void t.preventDefault()}},checklatest:function(t){var e,n=(new Date).getTime();function i(t){t&&t.commits&&$(".pa-commitcontainer").each(function(){var n=this.getAttribute("data-pa-pset"),i=this.getAttribute("data-pa-checkhash");for(var s of t.commits)if(s.pset==n&&s.hash&&s.hash!==i&&s.snaphash!==i){$(this).find(".pa-pv").append('<div class="pa-inf-error"><span class="pa-inf-alert">Newer commits are available.</span> <a href="'+I("pset",{u:siteinfo.uservalue,pset:n,commit:s.hash})+'">Load them</a></div>'),clearTimeout(e);break}})}setTimeout(function s(){var a=(new Date).getTime(),r=$(".pa-commitcontainer[data-pa-checkhash]").length>0;e=a-n<=6e4?setTimeout(s,r?1e4:2e3):a-n<=6e5?setTimeout(s,r?2e4:1e4):a-n<=36e5?setTimeout(s,1.25*(a-n)):null,$.ajax(I("=api/latestcommit",{u:siteinfo.uservalue,pset:t}),{type:"GET",cache:!1,dataType:"json",success:i})},2e3)},decorate_diff_page:pe.decorate_page,fold:Ms,gradeentry_closest:Pe.closest,gradesheet_store:We.store,grgraph:function(){const t=this,e={};t.hasAttribute("data-pa-pset")&&(e.pset=t.getAttribute("data-pa-pset")),t.hasAttribute("data-pa-grade")&&(e.grade=t.getAttribute("data-pa-grade")),$.ajax(I("=api/gradestatistics",e),{type:"GET",cache:!0,dataType:"json",success:function(e){e.series&&e.series.all&&(t.pa__gradedata=new Ln(e),function(t){const e=t.pa__gradedata;if(!e)return void t.removeAttribute("data-pa-gg-types");const n=t.closest(".pa-psetinfo"),i=!n||n.hasAttribute("data-pa-user-extension"),s=[];e.series.extension&&n&&i&&s.push("cdf-extension","pdf-extension"),s.push("cdf","pdf"),e.series.extension&&!n&&s.push("cdf-extension","pdf-extension"),e.series.noextra&&s.push("cdf-noextra","pdf-noextra"),s.push("all"),t.setAttribute("data-pa-gg-types",s.join(" "))}(t),jn.call(t))}})},hoturl:I,loadgrades:function(){if(!d(this,"pa-psetinfo"))throw new Error("bad pa_loadgrades");const t=We.closest(this);if(!t||!t.value_order)return;$(this).find(".need-pa-grade").each(function(){qs.call(this,!0)}),$(this).find(".pa-gradelist").each(function(){Zs.call(this,!0)}),$(this).find(".pa-grade").each(function(){t.update_at(this,{reset:!0})});const e="hidden"===t.total_type?[null,null]:[t.grade_total(),t.grade_maxtotal()],n=null===e[0]?"":""+e[0];null!==e[0]&&$(this).find(".pa-gradelist:not(.pa-gradebox)").each(function(){$(this).find(".pa-total").length||$(this).prepend(function(t,e){let n=0,i=0;for(const e in t.entries){const s=t.entries[e];s.in_total&&(++n,s.student_visible(t)&&++i)}const s=S("div","pa-pv",S("span","pa-gradevalue pa-gradewidth"));return null!=e[1]&&s.append(" ",S("span","pa-gradedesc","of "+e[1])),S("div","pa-total pa-p"+(n<=1?" hidden":"")+(i<n?" pa-p-hidden":""),S("div","pa-pt","subset"===t.total_type?"subtotal":"total"),s)}(t,e))});let i=!1;$(this).find(".pa-total").each(function(){f(this,"hidden",""===n);const t=$(this).find(".pa-gradevalue");t.text()!==n&&(t.text(n),i=!0)}),i&&$(this).find(".pa-grgraph").trigger("redrawgraph")},load_runsettings:function(t){var e,n,i=$("#pa-runsettings"),s=i.find(".n");for(n in s.attr("data-outstanding","1"),t){for(e=0;e!=s.length&&$.trim($(s[0]).val())!=n;++e);e==s.length?vn(n,t[n]):$.trim(i.find("[name=v"+e+"]").val())!=t[n]&&(i.find("[name=v"+e+"]").val(t[n]),$(s[e]).removeAttr("data-outstanding"))}for(e=0;e!=s.length;++e)$(s[e]).attr("data-outstanding")&&$("[data-runsetting-num="+$(s[e]).attr("name").substr(1)+"]").remove()},note_near:Se.near,on:v.on,onload:Ns,pset_actions:function(){var t=$(this);function e(){var e=t.find("select[name='state']").val();t.find(".pa-if-enabled").toggleClass("hidden","disabled"===e),t.find(".pa-if-visible").toggleClass("hidden","disabled"===e||"invisible"===e)}e(),t.find("select[name='state']").on("change",e),t.find("input, select").on("change",function(){t.find("[type='submit']").addClass("alert")}),t.removeClass("need-pa-pset-actions")},pset_table:function(t,e,n){const i=new zi(e,n||[]);t.pa__ptconf=i;const s=t.querySelector("table.gtable");s&&Qi.call(s,i)},register_psets:function(t){siteinfo.psets=siteinfo.psets||{};for(const e of t)siteinfo.psets[e.psetid]=siteinfo.psets[e.pset]=e},render_text_page:Zt.on_page,runmany:function(t){const n=document.getElementById("pa-runmany-form"),i=[];let s,a=0;if(n&&!n.hasAttribute("data-pa-runmany-unload")){$(window).on("beforeunload",function(){const t=document.getElementById("pa-runmany-progress");if(t&&t.max<t.value)return"Several server requests are outstanding."}),n.setAttribute("data-pa-runmany-unload","");const t=document.getElementById("run-"+n.elements.run.value);h(t,"has-hotlist"),t.addEventListener("pa-hotlist",function(t){const e=[];for(const t of i){let n=`~${t.u}/pset/${t.pset}`;t.commit&&(n+=`/${t.commit}`),e.push(n)}const s=n.elements.u.value;if(s){let t=`~${s}/pset/${n.elements.pset.value}`;n.elements.commit.value&&(t+=`/${n.elements.commit.value}`),e.push(t)}t.detail.hotlist={items:e}})}function r(){const e=n.elements.run,c=e.getAttribute("data-pa-run-category")||e.value,u=document.getElementById("pa-run-"+c);s&&clearTimeout(s),s=null,u&&d(u,"pa-run-active")?s=setTimeout(r,2e3):(n.elements.jobs&&c&&u&&u.hasAttribute("data-pa-timestamp")&&(function(t,e){i.push({u:n.elements.u.value,pset:n.elements.pset.value,commit:n.elements.commit.value,run:t,timestamp:e}),n.elements.jobs.value=JSON.stringify(i),n.elements.u.value="",1===i.length&&o().lastChild.append(S("button",{type:"button",class:"ui js-runmany-download"},"Download"))}(c,+u.getAttribute("data-pa-timestamp")),u.removeAttribute("data-pa-timestamp")),$.ajax(I("=api/runchainhead",{chain:t,cursor:a}),{type:"POST",cache:!1,dataType:"json",timeout:3e4,success:l}))}function o(){let t=document.getElementById("pa-runmany-statusui");if(!t){t=document.createElement("div"),t.id="pa-runmany-statusui",t.className="d-flex justify-content-between";const e=document.createElement("div"),i=document.createElement("div");e.className="flex-grow-1",t.append(e,i),$("#run-"+n.elements.run.value).after(t)}return t}function l(t){if(s&&clearTimeout(s),s=null,t&&t.active&&t.active.length){const e=t.active[0];n.elements.u.value=e.u,n.elements.pset.value=e.pset,n.elements.commit.value=e.hash||"";let i=`${siteinfo.site_relative}~${encodeURIComponent(e.u)}/pset/${e.pset}`;e.hash&&(i+=`/${e.hash}`),_n(n.elements.run,{clear:!1,queueid:e.queueid,timestamp:e.timestamp,headline:`]8;;${i}${e.u}]8;;`,done_function:r,timed:!1}),a=e.cursor,s=setTimeout(r,3e4)}else t&&0===t.nleft||(s=setTimeout(r,4e3));t&&null!=t.njobs&&function(t,n){let i=document.getElementById("pa-runmany-progress");i||(i=document.createElement("progress"),i.id="pa-runmany-progress",i.className="ml-3 mr-3",o().firstChild.append("Progress: ",i)),i.max=Math.max(n,t+1),i.value=i.max-t,i.textContent=e("%d%%",i.value/i.max);const s=i.nextElementSibling&&d(i.nextElementSibling,"pa-runmany-done");0!==t||s?0!==t&&s&&i.nextElementSibling.remove():i.after(S("span","pa-runmany-done","Done!"))}(t.nleft||0,t.njobs)}r()},text_eq:c,tooltip:At,string_utf8_index:u,SearchParser:Ni,SearchExpr:Ei}})()})();
//# sourceMappingURL=pa.min.js.map